#include "conf.h"  //Import MAX_CAM_CH Definition
#include "hddvr_code.h"

#include "bsp/decoder_drv.h"

#include <unistd.h>
#include <stdio.h>
#include <string.h>
#include <pthread.h>

static pthread_mutex_t gI2C_Locker;
#define I2C_InLock() pthread_mutex_lock(&gI2C_Locker)
#define I2C_UnLock() pthread_mutex_unlock(&gI2C_Locker)

#define AD_AHD_NVP6114  (0x83)
#define AD_AHD_NVP6124  (0x84)
#define AD_AHD_NVP6114A (0x85)
#define AD_AHD_NVP6124B (0x86)

int NVP6114A_REMAPPING_TBL[MAX_CAM_CH][2] = {
#if (MAX_CAM_CH == 4)
	{0, 1}, {0, 2}, {0, 0}, {0, 3},
#endif

#if (MAX_CAM_CH == 8)
	{0, 2}, {0, 3}, {0, 0}, {0, 1},
	{1, 2}, {1, 3}, {1, 0}, {1, 1},
#endif
};

int HDAHD_CHN_TBL[MAX_CAM_CH][2] = { //The Real Video&Audio Channel Order
#if (MAX_CAM_CH == 4)
#if defined(_EXT_HDDVR_LITE)
	{0, 2}, {0, 3}, {0, 0}, {0, 1},
#else
	{0, 2},  {0, 3},{0, 0}, {0, 1},
#endif
#endif

#if (MAX_CAM_CH == 8)
	{0, 2}, {0, 3}, {0, 0}, {0, 1},
#if defined(_EXT_HDDVR_LITE)
	{1, 1}, {1, 0}, {1, 2}, {1, 3},
#else
	{1, 2}, {1, 3}, {1, 0}, {1, 1},
#endif
#endif
#if (MAX_CAM_CH == 16)
	{0, 2}, {0, 3}, {0, 0}, {0, 1},
	{1, 2}, {1, 3}, {1, 0}, {1, 1},
	{2, 2}, {2, 3}, {2, 0}, {2, 1},
	{3, 2}, {3, 3}, {3, 0}, {3, 1},
#endif
};
static unsigned char HDAHD_VIDEOMODE[4] = {	0x00, 0x00, 0x00, 0x00 }; //The Real Video Mode

#define NVP1108_PAL  (0)
#define NVP1108_NTSC (1)
static int gHDAHD_WorkStandard = NVP1108_PAL;

#define HDAHD_CHIP_SIZE (4)
#define HDAHD_ADDR0 (0x60)
#define HDAHD_ADDR1 (0x62)
#define HDAHD_ADDR2 (0x64)
#define HDAHD_ADDR3 (0x66)
unsigned char HDAHD_ADDR[4] = { HDAHD_ADDR0, HDAHD_ADDR1, HDAHD_ADDR2, HDAHD_ADDR3 };
unsigned char HDAHD_SYID[4] = { 0, 0, 0, 0 };
int HDAHD_297M[4] = { 0, 0, 0, 0 };
unsigned char rev_id[4] = { 0, 0, 0, 0 };
unsigned char ACP_RX_D0 = 0x78;

#define ACP_CLR         0x3A
#define AHD2_FHD_D0		0x10
#define AHD2_FHD_OUT	0x09
#define AHD2_FHD_BAUD   0x00
#define AHD2_FHD_LINE   0x03
#define AHD2_FHD_LINES  0x05
#define AHD2_FHD_BYTE   0x0A
#define AHD2_FHD_MODE   0x0B
#define AHD2_PEL_D0		0x20
#define AHD2_PEL_OUT	0x0C
#define AHD2_PEL_EVEN   0x2F
#define AHD2_PEL_BAUD	0x02
#define AHD2_PEL_LINE	0x07
#define AHD2_PEL_SYNC	0x0D
#define AHD2_PEL_EVEN	0x2F

enum {
	NVP6124_VI_SD = 0,
	NVP6124_VI_720P_2530,
	NVP6124_VI_720P_5060,
	NVP6124_VI_1080P_2530,
	NVP6124_VI_1920H,			//1920x576i(480)
	NVP6124_VI_720H,			//720x576i(480)
	NVP6124_VI_1280H,			//1280x576i(480)
	NVP6124_VI_1440H,			//1440x576i(480)
	NVP6124_VI_960H2EX,   		//3840x576i(480)
	NVP6124_VI_HDEX,			//2560x720@25p(30)
	NVP6124_VI_BUTT
};

typedef enum _nvp6124_outmode_sel {
	NVP6124_OUTMODE_1MUX_SD = 0,
	NVP6124_OUTMODE_1MUX_HD,
	NVP6124_OUTMODE_1MUX_HD5060,
	NVP6124_OUTMODE_1MUX_FHD,
	NVP6124_OUTMODE_2MUX_SD,
	NVP6124_OUTMODE_2MUX_HD_X,
	NVP6124_OUTMODE_2MUX_HD,
	NVP6124_OUTMODE_2MUX_FHD_X,
	NVP6124_OUTMODE_4MUX_SD,
	NVP6124_OUTMODE_4MUX_HD_X,
	NVP6124_OUTMODE_4MUX_HD,
	NVP6124_OUTMODE_2MUX_FHD,
	NVP6124_OUTMODE_1MUX_HD_X,   //nvp6124b
	NVP6124_OUTMODE_1MUX_FHD_X,
	NVP6124_OUTMODE_4MUX_FHD_X,
	NVP6124_OUTMODE_4MUX_MIX,
	NVP6124_OUTMODE_BUTT,
}NVP6124_OUTMODE_SEL;

int HDAHD_ChipGetMap(int Chnl, int *RealChip, int *RealChnl, int *RealAddr)
{
	int tmpRealChip;
	int tmpRealChnl;
	int tmpRealAddr;

	if(!CHECK_SIZE(Chnl, HDAHD_CHN_TBL)) {
		return -1;
	}

	tmpRealChip = HDAHD_CHN_TBL[Chnl][0];
	tmpRealChnl = HDAHD_CHN_TBL[Chnl][1];
	tmpRealAddr = HDAHD_ADDR[tmpRealChip];

	if(RealChip) {
		*RealChip = tmpRealChip;
	}
	if(RealChnl) {
		*RealChnl = tmpRealChnl%4;
	}
	if(RealAddr) {
		*RealAddr = tmpRealAddr;
	}

	return 0;
}

int HDAHD_ChipGetByAddr(int addr, int *RealChip)
{
	int tmpRealChip;
	int tmpRealChnl;
	int tmpRealAddr;

	int ii;
	for(ii = 0; ii < ARRAY_SIZE(HDAHD_CHN_TBL); ii ++) {
		tmpRealChip = HDAHD_CHN_TBL[ii][0];
		tmpRealAddr = HDAHD_ADDR[tmpRealChip];
		if(addr == tmpRealAddr) {
			if(RealChip) {
				*RealChip = tmpRealChip;
			}
			return 0;
		}
	}

	return -1;
}

const unsigned char NVP6114_NTSC_Buf[][254] = {
	{
		 // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*0*/   0x00,0x00,0x20,0x03,0x00,0x00,0xaf,0x00,0x60,0x60,0x60,0x60,0x08,0x08,0x08,0x08,
	/*1*/   0x88,0x88,0x88,0x88,0x90,0x90,0x90,0x90,0x00,0x00,0x00,0x00,0x04,0x04,0x04,0x04,
	/*2*/   0x00,0x00,0x00,0x00,0x2f,0x92,0x0b,0x43,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*3*/   0x17,0x17,0x17,0x17,0x2f,0x92,0x0b,0x43,0x0a,0x0a,0x0a,0x0a,0x84,0x84,0x84,0x84,
	/*4*/   0xFD,0xFD,0xFD,0xFD,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x04,0x04,0x04,0x04,
	/*5*/   0x04,0x04,0x04,0x04,0xf1,0x10,0x10,0x00,0xa0,0xa0,0xa0,0xa0,0x9e,0x9e,0x9e,0x9e,
	/*6*/   0x00,0x00,0x00,0x00,0x8d,0x8d,0x8d,0x8d,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*7*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x88,0x88,0x11,0x11,0x00,0x00,0x00,0x00,
	/*8*/   0x00,0x00,0x02,0x80,0x04,0x04,0x08,0x04,0x0c,0x00,0x08,0x0e,0x80,0x20,0x0a,0x08,
	/*9*/   0x30,0x42,0x80,0x0a,0x7a,0x88,0x6c,0x5e,0x18,0x1f,0x8e,0x94,0xc7,0xa3,0xa0,0x0a,
	/*A*/   0x00,0x00,0x02,0x80,0x04,0x04,0x08,0x04,0x0c,0x00,0x08,0x0e,0x80,0x20,0x0a,0x08,
	/*B*/   0x30,0x42,0x80,0x0a,0x7a,0x88,0x6c,0x5e,0x18,0x1f,0x8e,0x94,0xc7,0xa3,0xa0,0x0a,
	/*C*/   0x01,0x01,0x01,0x01,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x00,0x00,0x00,0x00,
	/*D*/   0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*E*/   0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*F*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	},
	{
		 // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*0*/   0x02,0x0f,0x0f,0x0f,0x0f,0x0f,0x1b,0x80,0x03,0x00,0x10,0x32,0x54,0x76,0x00,0x98,
	/*1*/   0xba,0xdc,0xfe,0x00,0x00,0x00,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,
	/*2*/   0x88,0x88,0x03,0x19,0x18,0x16,0x00,0x00,0x00,0x88,0xff,0x40,0xaa,0xaa,0xaa,0xaa,
	/*3*/   0xaa,0x82,0x00,0x00,0x00,0x8C,0xA0,0x00,0x18,0x01,0x80,0x30,0x00,0x00,0x80,0x00,
	/*4*/   0x0f,0x0f,0x0f,0x0f,0x22,0xCC,0x81,0x55,0x60,0x00,0x03,0x10,0x00,0x00,0x00,0x00,
	/*5*/   0xDD,0x00,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*6*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*7*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*8*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*9*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*A*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*B*/   0xff,0xff,0xff,0xff,0x40,0x30,0x40,0x30,0x40,0x30,0x40,0x30,0x00,0x00,0x00,0x00,
	/*C*/   0x32,0x32,0x10,0x10,0x10,0x32,0x54,0x76,0x22,0x88,0x03,0x00,0x66,0x66,0x70,0x70,
	/*D*/   0x00,0x00,0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x0f,0x0f,0xff,0x00,0x02,0x00,
	/*E*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x90,0x00,0x00,0x00,0x0f,0x0f,0x0f,0xff,
	/*F*/   0xff,0xaa,0x66,0x00,0x83,0x70,0x00,0x1a,0x00,0x00,0x00,0x00,0xff,0xff,
	},
	{
		 // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*0*/   0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,
	/*1*/   0x00,0x00,0x00,0x00,0xc0,0x00,0x55,0x55,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*2*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*3*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*4*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*5*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*6*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*7*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*8*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*9*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*A*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*B*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*C*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*D*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*E*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*F*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x74,0x00,0x74,0x00,0xff,0xff,
	},
	{
		 // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*0*/   0xe0,0x0f,0x0c,0x1f,0x00,0x24,0x60,0x80,0x60,0x38,0x0f,0x00,0x04,0x10,0x30,0x00,
	/*1*/   0x06,0x06,0x00,0x80,0x37,0x80,0x49,0x37,0xef,0xdf,0xdf,0x08,0x50,0x0c,0xff,0x88,
	/*2*/   0x84,0x20,0x23,0x00,0x2a,0xdd,0xf0,0x57,0x90,0x70,0x52,0x78,0x04,0x68,0x00,0x07,
	/*3*/   0xe0,0x43,0xa2,0x00,0x00,0x15,0x25,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,
	/*4*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x44,0xaa,0x00,0x00,0x00,0x00,0x00,
	/*5*/   0x04,0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x60,0x00,0x00,0x30,
	/*6*/   0x53,0x53,0x20,0x00,0x22,0x22,0x22,0x22,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,
	/*7*/   0xc0,0x01,0x06,0x06,0x11,0x00,0x0f,0x8f,0x0f,0x0f,0x0f,0x8f,0x0f,0x0f,0x00,0x00,
	/*8*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*9*/   0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x48,0x84,0x00,0x80,0x00,0x00,0x00,0x00,
	/*A*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*B*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*C*/   0x10,0x30,0x0c,0x50,0x10,0x34,0x70,0x5C,0x20,0x20,0x30,0x40,0x20,0x20,0x14,0x20,
	/*D*/   0x40,0x50,0x0e,0x00,0x80,0x80,0x00,0x00,0x39,0xb2,0x05,0x00,0xc0,0x00,0x00,0x00,
	/*E*/   0xa0,0x00,0x01,0x01,0x02,0xa0,0x02,0x05,0x04,0x0b,0xa0,0x06,0x17,0x08,0x30,0x00,
	/*F*/   0x09,0xa0,0xf8,0x00,0x00,0x00,0x00,0x00,0x01,0x05,0x87,0x0b,0x8e,0x11,
	},
	{
		 // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*0*/   0x02,0x04,0x06,0x08,0x0c,0x10,0x14,0x18,0x1c,0x20,0x28,0x30,0x38,0x40,0x48,0x50,
	/*1*/   0x58,0x60,0x68,0x70,0x78,0x7f,0x87,0x8f,0x97,0x9f,0xaf,0xbf,0xcf,0xdf,0xef,0xff,
	/*2*/   0x01,0x03,0x05,0x07,0x0b,0x0f,0x13,0x17,0x1b,0x1f,0x27,0x2f,0x37,0x3f,0x47,0x4f,
	/*3*/   0x57,0x5f,0x67,0x6f,0x77,0x7f,0x87,0x8f,0x97,0x9f,0xaf,0xbf,0xcf,0xdf,0xef,0xff,
	/*4*/   0x00,0x0f,0x06,0x00,0xf5,0x28,0x5c,0x51,0xf5,0x28,0x5c,0x51,0x00,0x00,0x00,0x00,
	/*5*/   0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x00,0x00,0xff,0x00,0x00,0x00,
	/*6*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x11,0x11,0x00,0x00,0x00,0x00,0x00,0x00,
	/*7*/   0xff,0x77,0x77,0x00,0x00,0x00,0x00,0x00,0x03,0x03,0x03,0x03,0x00,0x00,0x00,0x00,
	/*8*/   0x37,0x37,0x1b,0x05,0x00,0x07,0x00,0x09,0x00,0x00,0x08,0x06,0x00,0x46,0x00,0x00,
	/*9*/   0xaa,0x1c,0x18,0xff,0xaa,0x3c,0xff,0xff,0xaa,0x1b,0x00,0x00,0xaa,0x3b,0x00,0x00,
	/*A*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01,
	/*B*/   0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x32,0x00,0x00,0x00,0x00,0x00,0x00,
	/*C*/   0x37,0x37,0x1b,0x05,0x00,0x07,0x00,0x09,0x00,0x00,0x08,0x06,0x00,0x46,0x00,0x00,
	/*D*/   0xaa,0x1c,0x18,0xff,0xaa,0x3c,0xff,0xff,0xaa,0x1b,0x00,0x00,0xaa,0x3b,0x00,0x00,
	/*E*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01,
	/*F*/   0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x32,0x00,0x00,0x00,0x00,
	},
	{
		 // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*0*/   0xe0,0x0f,0x0c,0x1f,0x00,0x24,0x60,0x80,0x50,0x38,0x0f,0x00,0x04,0x10,0x30,0x00,
	/*1*/   0x06,0x06,0x00,0x80,0x37,0x80,0x49,0x37,0xef,0xdf,0xdf,0x08,0x50,0x0c,0xff,0x88,
	/*2*/   0x84,0x20,0x23,0x00,0x2a,0xdd,0xf0,0x57,0x90,0x70,0x52,0x78,0x00,0x68,0x00,0x07,
	/*3*/   0xe0,0x43,0xa2,0x00,0x00,0x15,0x25,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,
	/*4*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x44,0xaa,0x00,0x00,0x00,0x00,0x00,
	/*5*/   0x04,0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x60,0x00,0x00,0x30,
	/*6*/   0x53,0x53,0x20,0x00,0x22,0x22,0x22,0x22,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,
	/*7*/   0xc0,0x01,0x06,0x06,0x11,0x00,0x0f,0x8f,0x0f,0x0f,0x0f,0x8f,0x0f,0x0f,0x00,0x00,
	/*8*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*9*/   0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x48,0x84,0x00,0x80,0x00,0x00,0x00,0x00,
	/*A*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*B*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*C*/   0x10,0x30,0x0c,0x50,0x10,0x34,0x70,0x5C,0x20,0x20,0x30,0x40,0x20,0x20,0x14,0x20,
	/*D*/   0x40,0x50,0x0e,0x00,0x80,0x80,0x00,0x00,0x39,0xb2,0x05,0x00,0xc0,0x00,0x00,0x00,
	/*E*/   0xa0,0x00,0x01,0x01,0x02,0xa0,0x02,0x05,0x04,0x0b,0xa0,0x06,0x17,0x08,0x30,0x00,
	/*F*/   0x09,0xa0,0xf8,0x00,0x00,0x00,0x00,0x00,0x01,0x05,0x87,0x0b,0x8e,0x11,
	},
};

const unsigned char NVP6114_PAL_Buf[][254] = {
	{
		 // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*0*/   0x00,0x00,0x20,0x03,0x00,0x00,0xaf,0x00,0x60,0x60,0x60,0x60,0x08,0x08,0x08,0x08,
	/*1*/   0x88,0x88,0x88,0x88,0x90,0x90,0x90,0x90,0x00,0x00,0x00,0x00,0x02,0x02,0x02,0x02,
	/*2*/   0x00,0x00,0x00,0x00,0x2f,0x92,0x0b,0x43,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*3*/   0x17,0x17,0x17,0x17,0x2f,0x92,0x0b,0x43,0x0a,0x0a,0x0a,0x0a,0x84,0x84,0x84,0x84,
	/*4*/   0x00,0x00,0x00,0x00,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x04,0x04,0x04,0x04,
	/*5*/   0x04,0x04,0x04,0x04,0x01,0x10,0x10,0x00,0x64,0x64,0x64,0x64,0x9e,0x9e,0x9e,0x9e,
	/*6*/   0x00,0x00,0x00,0x00,0x8d,0x8d,0x8d,0x8d,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*7*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x88,0x88,0x11,0x11,0x00,0x00,0x00,0x00,
	/*8*/   0x00,0x00,0x02,0x80,0x04,0x04,0x08,0x04,0x0c,0x00,0x08,0x0e,0x80,0x20,0x0a,0x08,
	/*9*/   0x30,0x42,0x80,0x0a,0x7a,0x88,0x6c,0x5e,0x18,0x1f,0x8e,0x94,0xc7,0xa3,0xa0,0x0a,
	/*A*/   0x00,0x00,0x02,0x80,0x04,0x04,0x08,0x04,0x0c,0x00,0x08,0x0e,0x80,0x20,0x0a,0x08,
	/*B*/   0x30,0x42,0x80,0x0a,0x7a,0x88,0x6c,0x5e,0x18,0x1f,0x8e,0x94,0xc7,0xa3,0xa0,0x0a,
	/*C*/   0x01,0x01,0x01,0x01,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x00,0x00,0x00,0x00,
	/*D*/   0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*E*/   0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*F*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	},
	{
		 // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*0*/   0x02,0x0f,0x0f,0x0f,0x0f,0x0f,0x1b,0x80,0x03,0x00,0x10,0x32,0x54,0x76,0x00,0x98,
	/*1*/   0xba,0xdc,0xfe,0x00,0x00,0x00,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,
	/*2*/   0x88,0x88,0x03,0x19,0x18,0x16,0x00,0x00,0x00,0x88,0xff,0x40,0xaa,0xaa,0xaa,0xaa,
	/*3*/   0xaa,0x82,0x00,0x00,0x00,0x8C,0xA0,0x00,0x18,0x01,0x80,0x30,0x00,0x00,0x80,0x00,
	/*4*/   0x0f,0x0f,0x0f,0x0f,0x22,0xcc,0x81,0x55,0x60,0x00,0x03,0x10,0x00,0x00,0x00,0x00,
	/*5*/   0xDD,0x00,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*6*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*7*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*8*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*9*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*A*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*B*/   0xff,0xff,0xff,0xff,0x40,0x30,0x40,0x30,0x40,0x30,0x40,0x30,0x00,0x00,0x00,0x00,
	/*C*/   0x32,0x32,0x10,0x10,0x10,0x32,0x54,0x76,0x22,0x88,0x03,0x00,0x66,0x66,0x70,0x70,
	/*D*/   0x00,0x00,0x00,0xff,0x00,0x00,0x00,0x00,0x0e,0x01,0x00,0x01,0x00,0x00,0x00,0x00,
	/*E*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x90,0x00,0x00,0x00,0x01,0x0f,0x01,0xff,
	/*F*/   0xab,0x00,0x77,0x0e,0x83,0x70,0xff,0x1a,0x00,0x0e,0x00,0x0e,0xff,0xff,
	},
	{
		 // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*0*/   0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,
	/*1*/   0x00,0x00,0x00,0x00,0xc0,0x00,0x55,0x55,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*2*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*3*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*4*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*5*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*6*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*7*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*8*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*9*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*A*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*B*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*C*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*D*/   0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*E*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x90,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*F*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3c,0x00,0x3c,0x00,0xff,0xff,
	},
	{
		 // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*0*/   0xe0,0x0f,0x0c,0x1f,0x00,0x24,0x60,0x80,0x60,0x38,0x0f,0x00,0x04,0x10,0x30,0x00,
	/*1*/   0x06,0x06,0x00,0x80,0x37,0x80,0x49,0x37,0xef,0xdf,0xdf,0x08,0x50,0x0c,0x00,0x88,
	/*2*/   0x84,0x20,0x23,0x00,0x2a,0xdd,0xf0,0x57,0x90,0x70,0x52,0x78,0x00,0x68,0x00,0x07,
	/*3*/   0xe0,0x43,0xa2,0x00,0x00,0x17,0x25,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,
	/*4*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x44,0xaa,0x00,0x00,0x00,0x00,0x00,
	/*5*/   0x04,0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x70,0x00,0x00,0x30,
	/*6*/   0x53,0x53,0x20,0x00,0x22,0x22,0x22,0x22,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,
	/*7*/   0xc0,0x01,0x06,0x06,0x11,0x00,0x0f,0x8f,0x0f,0x0f,0x00,0x00,0x00,0x00,0x00,0x00,
	/*8*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*9*/   0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x48,0x84,0x00,0x80,0x00,0x00,0x00,0x00,
	/*A*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*B*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*C*/   0x10,0x10,0x0e,0x70,0x10,0x34,0x70,0x5c,0x40,0x20,0x30,0x40,0x10,0x08,0x04,0x20,
	/*D*/   0x40,0x50,0x0e,0x00,0x80,0x80,0x00,0x00,0x39,0xb2,0x05,0x00,0xc0,0x00,0x00,0x00,
	/*E*/   0xa0,0x00,0x01,0x01,0x02,0xa0,0x02,0x05,0x04,0x0b,0xa0,0x06,0x17,0x08,0x30,0x00,
	/*F*/   0x09,0xa0,0xf8,0x00,0x00,0x00,0x00,0x00,0x01,0x05,0x87,0x0b,0x8e,0x11,
	},
	{
		 // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*0*/   0x02,0x04,0x06,0x08,0x0c,0x10,0x14,0x18,0x1c,0x20,0x28,0x30,0x38,0x40,0x48,0x50,
	/*1*/   0x58,0x60,0x68,0x70,0x78,0x7f,0x87,0x8f,0x97,0x9f,0xaf,0xbf,0xcf,0xdf,0xef,0xff,
	/*2*/   0x01,0x03,0x05,0x07,0x0b,0x0f,0x13,0x17,0x1b,0x1f,0x27,0x2f,0x37,0x3f,0x47,0x4f,
	/*3*/   0x57,0x5f,0x67,0x6f,0x77,0x7f,0x87,0x8f,0x97,0x9f,0xaf,0xbf,0xcf,0xdf,0xef,0xff,
	/*4*/   0x00,0x0f,0x06,0x00,0x88,0x88,0x88,0x51,0x88,0x88,0x88,0x51,0x00,0x00,0x00,0x00,
	/*5*/   0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x00,0x00,0xff,0x00,0x00,0x00,
	/*6*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x11,0x11,0x00,0x00,0x00,0x00,0x00,0x00,
	/*7*/   0xff,0xaa,0xaa,0x00,0x00,0x00,0x00,0x00,0x03,0x03,0x03,0x03,0x00,0x00,0x00,0x00,
	/*8*/   0x37,0x37,0x1b,0x05,0x00,0x07,0x00,0x09,0x00,0x00,0x08,0x06,0x00,0x46,0x00,0x00,
	/*9*/   0xaa,0x1c,0x18,0xff,0xaa,0x3c,0xff,0xff,0xaa,0x1b,0x00,0x00,0xaa,0x3b,0x00,0x00,
	/*A*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01,
	/*B*/   0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x32,0x00,0x00,0x00,0x00,0x00,0x00,
	/*C*/   0x37,0x37,0x1b,0x05,0x00,0x07,0x00,0x09,0x00,0x00,0x08,0x06,0x00,0x46,0x00,0x00,
	/*D*/   0xaa,0x1c,0x18,0xff,0xaa,0x3c,0xff,0xff,0xaa,0x1b,0x00,0x00,0xaa,0x3b,0x00,0x00,
	/*E*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01,
	/*F*/   0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x32,0x00,0x00,0x00,0x00,
	},
	{
		 // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*0*/   0xe0,0x0f,0x0c,0x1f,0x00,0x24,0x60,0x80,0x50,0x38,0x0f,0x00,0x04,0x10,0x30,0x00,
	/*1*/   0x06,0x06,0x00,0x80,0x37,0x80,0x49,0x37,0xef,0xdf,0xdf,0x08,0x50,0x0c,0x00,0x88,
	/*2*/   0x84,0x20,0x23,0x00,0x2a,0xdd,0xf0,0x57,0x90,0x70,0x52,0x78,0x00,0x68,0x00,0x07,
	/*3*/   0xe0,0x43,0xa2,0x00,0x00,0x17,0x25,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,
	/*4*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x44,0xaa,0x00,0x00,0x00,0x00,0x00,
	/*5*/   0x04,0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x70,0x00,0x00,0x30,
	/*6*/   0x53,0x53,0x20,0x00,0x22,0x22,0x22,0x22,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,
	/*7*/   0xc0,0x01,0x06,0x06,0x11,0x00,0x0f,0x8f,0x0f,0x0f,0x00,0x00,0x00,0x00,0x00,0x00,
	/*8*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*9*/   0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x48,0x84,0x00,0x80,0x00,0x00,0x00,0x00,
	/*A*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*B*/   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*C*/   0x10,0x10,0x0e,0x70,0x10,0x34,0x70,0x5c,0x40,0x20,0x30,0x40,0x10,0x08,0x04,0x20,
	/*D*/   0x40,0x50,0x0e,0x00,0x80,0x80,0x00,0x00,0x39,0xb2,0x05,0x00,0xc0,0x00,0x00,0x00,
	/*E*/   0xa0,0x00,0x01,0x01,0x02,0xa0,0x02,0x05,0x04,0x0b,0xa0,0x06,0x17,0x08,0x30,0x00,
	/*F*/   0x09,0xa0,0xf8,0x00,0x00,0x00,0x00,0x00,0x01,0x05,0x87,0x0b,0x8e,0x11,
	},
};

unsigned char NVP6124_Buf[][254] = {
	{
		  // 0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F
	/*0x00*/ 0x00,0x00,0x20,0x03,0x00,0x00,0x00,0x00,0x60,0x60,0x60,0x60,0x08,0x08,0x08,0x08,
	/*0x10*/ 0x80,0x80,0x80,0x80,0x90,0x90,0x90,0x90,0x00,0x00,0x00,0x00,0xaf,0xaf,0xaf,0xaf,
	/*0x20*/ 0x2f,0x92,0x0b,0x43,0x2f,0x92,0x0b,0x43,0x2f,0x92,0x0b,0x43,0x2f,0x92,0x0b,0x43,
	/*0x30*/ 0x17,0x17,0x17,0x17,0x04,0x04,0x04,0x04,0x0a,0x0a,0x0a,0x0a,0x80,0x80,0x80,0x80,
	/*0x40*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x50*/ 0x00,0x00,0x00,0x00,0xf1,0x10,0x10,0x00,0xa0,0xa0,0xa0,0xa0,0x9e,0x9e,0x9e,0x9e,
	/*0x60*/ 0x00,0x00,0x00,0x00,0x8d,0x8d,0x8d,0x8d,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x70*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x88,0x88,0x11,0x11,0x00,0x00,0x00,0x00,
	/*0x80*/ 0x0F,0x66,0x66,0x33,0x33,0x00,0x00,0x00,0x00,0x00,0x00,0x11,0x11,0x77,0x77,0x00,
	/*0x90*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x16,0x16,0x16,0x16,0x00,0x00,0x00,0x00,
	/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x11,0x11,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xb0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xc0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xd0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x90,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	},//BANK0
	{
		  // 0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F
	/*0x00*/ 0x02,0x0f,0x0f,0x0f,0x0f,0x0f,0x1b,0xc8,0x03,0x00,0x10,0x32,0x54,0x76,0x00,0x98,
	/*0x10*/ 0xba,0xdc,0xfe,0x08,0x00,0x00,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,
	/*0x20*/ 0x88,0x88,0x03,0x19,0x18,0x16,0x00,0x00,0x00,0x88,0xff,0x40,0xaa,0xaa,0xaa,0xaa,
	/*0x30*/ 0xaa,0x82,0x00,0x00,0x00,0x8C,0xA0,0x00,0x18,0x01,0x80,0x30,0x00,0x00,0x80,0x00,
	/*0x40*/ 0x0f,0x0f,0x0f,0x0f,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x50*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x60*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x70*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x80*/ 0x60,0x00,0x14,0x2C,0x00,0x00,0x00,0x00,0x44,0x44,0xdd,0xdd,0x11,0x11,0x55,0x55,
	/*0x90*/ 0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xb0*/ 0x00,0x00,0x00,0x00,0x40,0x30,0x40,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xc0*/ 0x22,0x22,0x33,0x33,0x00,0x00,0x11,0x11,0x00,0x00,0xff,0x00,0x30,0x30,0x30,0x30,
	/*0xd0*/ 0x00,0x00,0x00,0xf0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	},//BANK1
	{
		   // 0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F
	/*0x00*/ 0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,
	/*0x10*/ 0x00,0x00,0x0F,0x00,0xc0,0x00,0x55,0x55,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*0x20*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*0x30*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*0x40*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*0x50*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*0x60*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*0x70*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	/*0x80*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x90*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xb0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xc0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xd0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	},//BANK2
	{
		  // 0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F
	/*0x00*/ 0x37,0x37,0x1b,0x05,0x00,0x07,0x00,0x09,0x00,0x00,0x08,0x06,0x00,0x46,0x00,0x00,
	/*0x10*/ 0xaa,0x1c,0x18,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x20*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01,
	/*0x30*/ 0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x32,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x40*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x50*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x60*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x70*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x80*/ 0x37,0x37,0x1b,0x05,0x00,0x07,0x00,0x09,0x00,0x00,0x08,0x06,0x00,0x46,0x00,0x00,
	/*0x90*/ 0xaa,0x1c,0x18,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01,
	/*0xb0*/ 0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x32,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xc0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xd0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	},//BANK3
	{
		  // 0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F
	/*0x00*/ 0x37,0x37,0x1b,0x05,0x00,0x07,0x00,0x09,0x00,0x00,0x08,0x06,0x00,0x46,0x00,0x00,
	/*0x10*/ 0xaa,0x1c,0x18,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x20*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01,
	/*0x30*/ 0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x32,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x40*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x50*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x60*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x70*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x80*/ 0x37,0x37,0x1b,0x05,0x00,0x07,0x00,0x09,0x00,0x00,0x08,0x06,0x00,0x46,0x00,0x00,
	/*0x90*/ 0xaa,0x1c,0x18,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01,
	/*0xb0*/ 0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x32,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xc0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xd0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	},//BANK4
	{
		  // 0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F
	/*0x00*/ 0xC0,0x0c,0x0c,0x1f,0x00,0x24,0x40,0x80,0x50,0x38,0x0f,0x00,0x04,0x10,0x30,0x00,
	/*0x10*/ 0x06,0x06,0x00,0x80,0x37,0x80,0x49,0x37,0xef,0xdf,0xdf,0x08,0x50,0x0c,0x01,0x88,
	/*0x20*/ 0x84,0x20,0x23,0x00,0x2a,0xdc,0xf0,0x57,0x90,0x70,0x52,0x78,0x00,0x68,0x00,0x07,
	/*0x30*/ 0xe0,0x43,0xa2,0x00,0x00,0x15,0x25,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,
	/*0x40*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x44,0xaa,0x00,0x00,0x00,0x00,0x00,
	/*0x50*/ 0x84,0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x03,0x01,0x00,0x00,0x00,0x00,0x00,0x30,
	/*0x60*/ 0x53,0x53,0x20,0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x70*/ 0xc0,0x01,0x06,0x06,0x11,0x00,0x01,0x81,0x01,0x01,0x01,0x81,0x01,0x01,0x00,0x00,
	/*0x80*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x90*/ 0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x48,0x84,0x00,0x80,0x00,0x00,0x00,0x00,
	/*0xa0*/ 0x10,0x30,0x0c,0x50,0x10,0x34,0x70,0x5C,0x20,0x20,0x30,0x40,0x20,0x20,0x14,0xA0,
	/*0xb0*/ 0x40,0x50,0x0e,0x00,0x00,0x80,0x00,0x00,0x38,0xb2,0x05,0x00,0xa0,0x00,0x00,0x00,
	/*0xc0*/ 0x17,0x14,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xd0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	},//BANK5
	{
		  // 0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F
	/*0x00*/ 0xC0,0x0c,0x0c,0x1f,0x00,0x24,0x40,0x80,0x50,0x38,0x0f,0x00,0x04,0x10,0x30,0x00,
	/*0x10*/ 0x06,0x06,0x00,0x80,0x37,0x80,0x49,0x37,0xef,0xdf,0xdf,0x08,0x50,0x0c,0x01,0x88,
	/*0x20*/ 0x84,0x20,0x23,0x00,0x2a,0xdc,0xf0,0x57,0x90,0x70,0x52,0x78,0x00,0x68,0x00,0x07,
	/*0x30*/ 0xe0,0x43,0xa2,0x00,0x00,0x15,0x25,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,
	/*0x40*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x44,0xaa,0x00,0x00,0x00,0x00,0x00,
	/*0x50*/ 0x84,0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x03,0x01,0x00,0x00,0x00,0x00,0x00,0x30,
	/*0x60*/ 0x53,0x53,0x20,0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x70*/ 0xc0,0x01,0x06,0x06,0x11,0x00,0x01,0x81,0x01,0x01,0x01,0x81,0x01,0x01,0x00,0x00,
	/*0x80*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x90*/ 0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x48,0x84,0x00,0x80,0x00,0x00,0x00,0x00,
	/*0xa0*/ 0x10,0x30,0x0c,0x50,0x10,0x34,0x70,0x5C,0x20,0x20,0x30,0x40,0x20,0x20,0x14,0xA0,
	/*0xb0*/ 0x40,0x50,0x0e,0x00,0x00,0x80,0x00,0x00,0x38,0xb2,0x05,0x00,0xa0,0x00,0x00,0x00,
	/*0xc0*/ 0x17,0x14,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xd0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	},//BANK6
	{
		  // 0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F
	/*0x00*/ 0xC0,0x0c,0x0c,0x1f,0x00,0x24,0x40,0x80,0x50,0x38,0x0f,0x00,0x04,0x10,0x30,0x00,
	/*0x10*/ 0x06,0x06,0x00,0x80,0x37,0x80,0x49,0x37,0xef,0xdf,0xdf,0x08,0x50,0x0c,0x01,0x88,
	/*0x20*/ 0x84,0x20,0x23,0x00,0x2a,0xdc,0xf0,0x57,0x90,0x70,0x52,0x78,0x00,0x68,0x00,0x07,
	/*0x30*/ 0xe0,0x43,0xa2,0x00,0x00,0x15,0x25,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,
	/*0x40*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x44,0xaa,0x00,0x00,0x00,0x00,0x00,
	/*0x50*/ 0x84,0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x03,0x01,0x00,0x00,0x00,0x00,0x00,0x30,
	/*0x60*/ 0x53,0x53,0x20,0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x70*/ 0xc0,0x01,0x06,0x06,0x11,0x00,0x01,0x81,0x01,0x01,0x01,0x81,0x01,0x01,0x00,0x00,
	/*0x80*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x90*/ 0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x48,0x84,0x00,0x80,0x00,0x00,0x00,0x00,
	/*0xa0*/ 0x10,0x30,0x0c,0x50,0x10,0x34,0x70,0x5C,0x20,0x20,0x30,0x40,0x20,0x20,0x14,0xA0,
	/*0xb0*/ 0x40,0x50,0x0e,0x00,0x00,0x80,0x00,0x00,0x38,0xb2,0x05,0x00,0xa0,0x00,0x00,0x00,
	/*0xc0*/ 0x17,0x14,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xd0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	},//BANK7
	{
		  // 0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F
	/*0x00*/ 0xC0,0x0c,0x0c,0x1f,0x00,0x24,0x40,0x80,0x50,0x38,0x0f,0x00,0x04,0x10,0x30,0x00,
	/*0x10*/ 0x06,0x06,0x00,0x80,0x37,0x80,0x49,0x37,0xef,0xdf,0xdf,0x08,0x50,0x0c,0x01,0x88,
	/*0x20*/ 0x84,0x20,0x23,0x00,0x2a,0xdc,0xf0,0x57,0x90,0x70,0x52,0x78,0x00,0x68,0x00,0x07,
	/*0x30*/ 0xe0,0x43,0xa2,0x00,0x00,0x15,0x25,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,
	/*0x40*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x44,0xaa,0x00,0x00,0x00,0x00,0x00,
	/*0x50*/ 0x84,0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x03,0x01,0x00,0x00,0x00,0x00,0x00,0x30,
	/*0x60*/ 0x53,0x53,0x20,0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x70*/ 0xc0,0x01,0x06,0x06,0x11,0x00,0x01,0x81,0x01,0x01,0x01,0x81,0x01,0x01,0x00,0x00,
	/*0x80*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x90*/ 0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x48,0x84,0x00,0x80,0x00,0x00,0x00,0x00,
	/*0xa0*/ 0x10,0x30,0x0c,0x50,0x10,0x34,0x70,0x5C,0x20,0x20,0x30,0x40,0x20,0x20,0x14,0xA0,
	/*0xb0*/ 0x40,0x50,0x0e,0x00,0x00,0x80,0x00,0x00,0x38,0xb2,0x05,0x00,0xa0,0x00,0x00,0x00,
	/*0xc0*/ 0x17,0x14,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xd0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	},//BANK8
	{
		   //0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F
	/*0x00*/ 0x02,0x04,0x06,0x08,0x0c,0x10,0x14,0x18,0x1c,0x20,0x28,0x30,0x38,0x40,0x48,0x50,
	/*0x10*/ 0x58,0x60,0x68,0x70,0x78,0x7f,0x87,0x8f,0x97,0x9f,0xaf,0xbf,0xcf,0xdf,0xef,0xff,
	/*0x20*/ 0x01,0x03,0x05,0x07,0x0b,0x0f,0x13,0x17,0x1b,0x1f,0x27,0x2f,0x37,0x3f,0x47,0x4f,
	/*0x30*/ 0x57,0x5f,0x67,0x6f,0x77,0x7f,0x87,0x8f,0x97,0x9f,0xaf,0xbf,0xcf,0xdf,0xef,0xff,
	/*0x40*/ 0x00,0x00,0x00,0x00,0x0f,0x00,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x50*/ 0xee,0x00,0xe5,0x4e,0xee,0x00,0xe5,0x4e,0xee,0x00,0xe5,0x4e,0xee,0x00,0xe5,0x4e,
	/*0x60*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x70*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x80*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x90*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xb0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xc0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xd0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	},//BANK9
	{
		  // 0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F
	/*0x00*/ 0x00,0x00,0x02,0x80,0x04,0x04,0x08,0x04,0x0C,0x00,0x08,0x0E,0x80,0x20,0x0A,0x08,
	/*0x10*/ 0x30,0x42,0x80,0x0A,0x7A,0x88,0x6C,0x5E,0x18,0x1F,0x8E,0x94,0xC7,0xA3,0xA0,0x0A,
	/*0x20*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x01,0x00,0x01,0x03,0xA0,0x04,0x03,
	/*0x30*/ 0x03,0x0B,0x0A,0x11,0x0D,0x06,0x27,0x00,0x4E,0x6D,0x74,0x00,0x00,0x00,0x00,0x00,
	/*0x40*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x50*/ 0x01,0x05,0x87,0x0B,0x01,0x05,0x87,0x0B,0x8E,0x11,0x64,0x00,0x00,0x00,0x00,0x00,
	/*0x60*/ 0x02,0x01,0x00,0x01,0x03,0xA0,0x04,0x03,0x03,0x0B,0x0A,0x11,0x0D,0x06,0x27,0x00,
	/*0x70*/ 0x4E,0x6D,0x74,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x80*/ 0x00,0x00,0x02,0x80,0x04,0x04,0x08,0x04,0x0C,0x00,0x08,0x0E,0x80,0x20,0x0A,0x08,
	/*0x90*/ 0x30,0x42,0x80,0x0A,0x7A,0x88,0x6C,0x5E,0x18,0x1F,0x8E,0x94,0xC7,0xA3,0xA0,0x0A,
	/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x01,0x00,0x01,0x03,0xA0,0x04,0x03,
	/*0xb0*/ 0x03,0x0B,0x0A,0x11,0x0D,0x06,0x27,0x00,0x4E,0x6D,0x74,0x00,0x00,0x00,0x00,0x00,
	/*0xc0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xd0*/ 0x01,0x05,0x87,0x0B,0x01,0x05,0x87,0x0B,0x8E,0x11,0x64,0x00,0x00,0x00,0x00,0x00,
	/*0xe0*/ 0x02,0x01,0x00,0x01,0x03,0xA0,0x04,0x03,0x03,0x0B,0x0A,0x11,0x0D,0x06,0x27,0x00,
	/*0xf0*/ 0x4E,0x6D,0x74,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	},//BANKA
	{
		  // 0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F
	/*0x00*/ 0x00,0x00,0x02,0x80,0x04,0x04,0x08,0x04,0x0C,0x00,0x08,0x0E,0x80,0x20,0x0A,0x08,
	/*0x10*/ 0x30,0x42,0x80,0x0A,0x7A,0x88,0x6C,0x5E,0x18,0x1F,0x8E,0x94,0xC7,0xA3,0xA0,0x0A,
	/*0x20*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x01,0x00,0x01,0x03,0xA0,0x04,0x03,
	/*0x30*/ 0x03,0x0B,0x0A,0x11,0x0D,0x06,0x27,0x00,0x4E,0x6D,0x74,0x00,0x00,0x00,0x00,0x00,
	/*0x40*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x50*/ 0x01,0x05,0x87,0x0B,0x01,0x05,0x87,0x0B,0x8E,0x11,0x64,0x00,0x00,0x00,0x00,0x00,
	/*0x60*/ 0x02,0x01,0x00,0x01,0x03,0xA0,0x04,0x03,0x03,0x0B,0x0A,0x11,0x0D,0x06,0x27,0x00,
	/*0x70*/ 0x4E,0x6D,0x74,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x80*/ 0x00,0x00,0x02,0x80,0x04,0x04,0x08,0x04,0x0C,0x00,0x08,0x0E,0x80,0x20,0x0A,0x08,
	/*0x90*/ 0x30,0x42,0x80,0x0A,0x7A,0x88,0x6C,0x5E,0x18,0x1F,0x8E,0x94,0xC7,0xA3,0xA0,0x0A,
	/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x01,0x00,0x01,0x03,0xA0,0x04,0x03,
	/*0xb0*/ 0x03,0x0B,0x0A,0x11,0x0D,0x06,0x27,0x00,0x4E,0x6D,0x74,0x00,0x00,0x00,0x00,0x00,
	/*0xc0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xd0*/ 0x01,0x05,0x87,0x0B,0x01,0x05,0x87,0x0B,0x8E,0x11,0x64,0x00,0x00,0x00,0x00,0x00,
	/*0xe0*/ 0x02,0x01,0x00,0x01,0x03,0xA0,0x04,0x03,0x03,0x0B,0x0A,0x11,0x0D,0x06,0x27,0x00,
	/*0xf0*/ 0x4E,0x6D,0x74,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	},//BANKB
};

unsigned char NVP6124_B5678_SD_Buf[] = {
		  // 0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F
	/*0x00*/ 0xC0,0x0E,0x0C,0x1F,0x00,0x20,0x40,0x80,0x50,0x38,0x0F,0x00,0x04,0x10,0x30,0x00,
	/*0x10*/ 0x06,0x04,0x00,0x80,0x37,0x80,0x49,0x37,0xEF,0xDF,0xDF,0x20,0x50,0x0C,0xFF,0x88,
	/*0x20*/ 0x90,0x20,0x23,0x00,0x2A,0xDC,0xF0,0x57,0x90,0x1f,0x52,0x78,0x04,0x68,0x00,0x07,
	/*0x30*/ 0xE0,0x43,0xA2,0x00,0x00,0x15,0x25,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,
	/*0x40*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x44,0xAA,0x00,0x00,0x00,0x00,0x00,
	/*0x50*/ 0x84,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x60*/ 0x53,0x53,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0x70*/ 0xC0,0x01,0x06,0x06,0x11,0x00,0x01,0x81,0x01,0x01,0x00,0x00,0x00,0x80,0x00,0x00,
	/*0x80*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x3f,0xff,0xff,0xff,0x00,0x00,0x00,
	/*0x90*/ 0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x48,0x84,0x00,0x80,0x00,0x00,0x00,0x00,
	/*0xa0*/ 0x10,0x30,0x0c,0x50,0x10,0x34,0x70,0x5c,0x20,0x20,0x30,0x40,0x20,0x20,0x14,0x20,
	/*0xb0*/ 0x40,0x50,0x0e,0x00,0x00,0x80,0x00,0x00,0x39,0xb2,0x05,0x00,0xa0,0x00,0x00,0x00,
	/*0xc0*/ 0x00,0x13,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xd0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};

#define NVP6124_CHNL_NUM_MAX (16)

//channel_mode:
//0x00 --> ALL channel 720P mode
//0x03 --> 1/2 channel 960H mode
//0x0c --> 3/4 channel 960H mode
//0x0F --> ALL channel 960H mode
void nvp6114_video_960H_setting(int addr, int video_mode, unsigned char channel_mode)
{
	unsigned char tmpAddr = addr;

	unsigned char ch12_960H = 0;
	unsigned char ch34_960H = 0;

	if(channel_mode & 0x03)
		ch12_960H = 1;
	if(channel_mode & 0x0C)
		ch34_960H = 1;

	I2C_InLock();

	if(ch12_960H == ch34_960H) {
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x04);  //bank4
		HDDVR_i2c_WriteByte(tmpAddr, 0x5F, 0x00);
	}
	else {
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x04);  //bank4
		HDDVR_i2c_WriteByte(tmpAddr, 0x5F, 0x01);  //each bank setting
	}

	/************bank 0 diff setting *************/
	HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x00);  //bank0
	HDDVR_i2c_WriteByte(tmpAddr, 0x54, video_mode==NVP1108_PAL?0x01:0xf1);
	if(1==ch12_960H) {
		HDDVR_i2c_WriteByte(tmpAddr, 0x08, video_mode==NVP1108_PAL?0xDD:0xA0);
		HDDVR_i2c_WriteByte(tmpAddr, 0x09, video_mode==NVP1108_PAL?0xDD:0xA0);
		HDDVR_i2c_WriteByte(tmpAddr, 0x14, 0x90);
		HDDVR_i2c_WriteByte(tmpAddr, 0x15, 0x90);
		HDDVR_i2c_WriteByte(tmpAddr, 0x18, 0x88);		
		HDDVR_i2c_WriteByte(tmpAddr, 0x1A, 0x22);
		HDDVR_i2c_WriteByte(tmpAddr, 0x1C, video_mode==NVP1108_PAL?0x02:0x04);
		HDDVR_i2c_WriteByte(tmpAddr, 0x1D, video_mode==NVP1108_PAL?0x02:0x04);
		HDDVR_i2c_WriteByte(tmpAddr, 0x25, video_mode==NVP1108_PAL?0x02:0x82);
		HDDVR_i2c_WriteByte(tmpAddr, 0x40, video_mode==NVP1108_PAL?0x00:0x01);
		HDDVR_i2c_WriteByte(tmpAddr, 0x41, video_mode==NVP1108_PAL?0x00:0x01);
		HDDVR_i2c_WriteByte(tmpAddr, 0x44, 0xF0);
		HDDVR_i2c_WriteByte(tmpAddr, 0x45, 0xF0);
		HDDVR_i2c_WriteByte(tmpAddr, 0x48, 0xF0);
		HDDVR_i2c_WriteByte(tmpAddr, 0x49, 0xF0);
		HDDVR_i2c_WriteByte(tmpAddr, 0x58, video_mode==NVP1108_PAL?0x54:0x48);
		HDDVR_i2c_WriteByte(tmpAddr, 0x59, video_mode==NVP1108_PAL?0x54:0x48);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5C, 0x1E);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5D, 0x1E);
		HDDVR_i2c_WriteByte(tmpAddr, 0x64, video_mode==NVP1108_PAL?0x0D:0x08);
		HDDVR_i2c_WriteByte(tmpAddr, 0x65, video_mode==NVP1108_PAL?0x0D:0x08);
	}
	else {
		HDDVR_i2c_WriteByte(tmpAddr, 0x08, 0x60);
		HDDVR_i2c_WriteByte(tmpAddr, 0x09, 0x60);
		HDDVR_i2c_WriteByte(tmpAddr, 0x14, 0x9f);
		HDDVR_i2c_WriteByte(tmpAddr, 0x15, 0x9f);
		HDDVR_i2c_WriteByte(tmpAddr, 0x18, 0x00);		
		HDDVR_i2c_WriteByte(tmpAddr, 0x1A, 0x11);  
		HDDVR_i2c_WriteByte(tmpAddr, 0x1C, video_mode==NVP1108_PAL?0x02:0x04);
		HDDVR_i2c_WriteByte(tmpAddr, 0x1D, video_mode==NVP1108_PAL?0x02:0x04);
		HDDVR_i2c_WriteByte(tmpAddr, 0x25, 0x92);
		HDDVR_i2c_WriteByte(tmpAddr, 0x40, video_mode==NVP1108_PAL?0x00:0xFD);
		HDDVR_i2c_WriteByte(tmpAddr, 0x41, video_mode==NVP1108_PAL?0x00:0xFD);
		HDDVR_i2c_WriteByte(tmpAddr, 0x44, 0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0x45, 0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0x48, 0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0x49, 0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0x58, video_mode==NVP1108_PAL?0x88:0xa0);
		HDDVR_i2c_WriteByte(tmpAddr, 0x59, video_mode==NVP1108_PAL?0x88:0xa0);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5C, 0x9E);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5D, 0x9E);
		HDDVR_i2c_WriteByte(tmpAddr, 0x64, 0xB2);
		HDDVR_i2c_WriteByte(tmpAddr, 0x65, 0xB2);
	}
	
	if(1==ch34_960H) {
		HDDVR_i2c_WriteByte(tmpAddr, 0x0A, video_mode==NVP1108_PAL?0xDD:0xA0);
		HDDVR_i2c_WriteByte(tmpAddr, 0x0B, video_mode==NVP1108_PAL?0xDD:0xA0);
		HDDVR_i2c_WriteByte(tmpAddr, 0x16, 0x90);
		HDDVR_i2c_WriteByte(tmpAddr, 0x17, 0x90);
		HDDVR_i2c_WriteByte(tmpAddr, 0x19, 0x88);
		HDDVR_i2c_WriteByte(tmpAddr, 0x1B, 0x22);
		HDDVR_i2c_WriteByte(tmpAddr, 0x1E, video_mode==NVP1108_PAL?0x02:0x04);
		HDDVR_i2c_WriteByte(tmpAddr, 0x1F, video_mode==NVP1108_PAL?0x02:0x04);
		HDDVR_i2c_WriteByte(tmpAddr, 0x35, video_mode==NVP1108_PAL?0x02:0x82);
		HDDVR_i2c_WriteByte(tmpAddr, 0x42, video_mode==NVP1108_PAL?0x00:0x01);
		HDDVR_i2c_WriteByte(tmpAddr, 0x43, video_mode==NVP1108_PAL?0x00:0x01);
		HDDVR_i2c_WriteByte(tmpAddr, 0x46, 0xF0);
		HDDVR_i2c_WriteByte(tmpAddr, 0x47, 0xF0);
		HDDVR_i2c_WriteByte(tmpAddr, 0x4A, 0xF0);
		HDDVR_i2c_WriteByte(tmpAddr, 0x4B, 0xF0);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5A, video_mode==NVP1108_PAL?0x54:0x48);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5B, video_mode==NVP1108_PAL?0x54:0x48);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5E, 0x1E);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5F, 0x1E);
		HDDVR_i2c_WriteByte(tmpAddr, 0x66, video_mode==NVP1108_PAL?0x0D:0x08);
		HDDVR_i2c_WriteByte(tmpAddr, 0x67, video_mode==NVP1108_PAL?0x0D:0x08);
	}
	else {
		HDDVR_i2c_WriteByte(tmpAddr, 0x0A, 0x60);
		HDDVR_i2c_WriteByte(tmpAddr, 0x0B, 0x60);
		HDDVR_i2c_WriteByte(tmpAddr, 0x16, 0x9f);
		HDDVR_i2c_WriteByte(tmpAddr, 0x17, 0x9f);
		HDDVR_i2c_WriteByte(tmpAddr, 0x19, 0x00);		
		HDDVR_i2c_WriteByte(tmpAddr, 0x1B, 0x11); 
		HDDVR_i2c_WriteByte(tmpAddr, 0x1E, video_mode==NVP1108_PAL?0x02:0x04);
		HDDVR_i2c_WriteByte(tmpAddr, 0x1F, video_mode==NVP1108_PAL?0x02:0x04);
		HDDVR_i2c_WriteByte(tmpAddr, 0x35, 0x92);
		HDDVR_i2c_WriteByte(tmpAddr, 0x42, video_mode==NVP1108_PAL?0x00:0xFD);
		HDDVR_i2c_WriteByte(tmpAddr, 0x43, video_mode==NVP1108_PAL?0x00:0xFD);
		HDDVR_i2c_WriteByte(tmpAddr, 0x46, 0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0x47, 0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0x4A, 0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0x4B, 0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5A, video_mode==NVP1108_PAL?0x88:0xa0);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5B, video_mode==NVP1108_PAL?0x88:0xa0);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5E, 0x9E);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5F, 0x9E);
		HDDVR_i2c_WriteByte(tmpAddr, 0x66, 0xB2);
		HDDVR_i2c_WriteByte(tmpAddr, 0x67, 0xB2);
	}

	/************bank 2 diff setting *************/
	HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x02);  		
	HDDVR_i2c_WriteByte(tmpAddr, 0x12, (ch34_960H?0x03:0x00)<<2|(ch12_960H?0x03:0x00));
	HDDVR_i2c_WriteByte(tmpAddr, 0x16, (ch12_960H?0x00:0x55));
	HDDVR_i2c_WriteByte(tmpAddr, 0x17, (ch34_960H?0x00:0x55));

	/************bank 4 diff setting *************/
	HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x04);   			
	HDDVR_i2c_WriteByte(tmpAddr, 0x5C, (ch34_960H?0x00:0x0F)<<4|(ch12_960H?0x00:0x0F));
	HDDVR_i2c_WriteByte(tmpAddr, 0x41, (ch34_960H?0x00:0x03)<<2|(ch12_960H?0x00:0x03));
	HDDVR_i2c_WriteByte(tmpAddr, 0x40, 0x00);
	HDDVR_i2c_WriteByte(tmpAddr, 0x56, 0x0F); //H Zoom On

	if(ch12_960H==1) {
		HDDVR_i2c_WriteByte(tmpAddr, 0x64, 0x11);
		HDDVR_i2c_WriteByte(tmpAddr, 0x68, 0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x71, 0x55);
		HDDVR_i2c_WriteByte(tmpAddr, 0x78, video_mode==NVP1108_PAL?0x06:0x03);
		HDDVR_i2c_WriteByte(tmpAddr, 0x79, video_mode==NVP1108_PAL?0x06:0x03);
	}
	else {
		HDDVR_i2c_WriteByte(tmpAddr, 0x64, 0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x68, 0x11);
		HDDVR_i2c_WriteByte(tmpAddr, 0x71, video_mode==NVP1108_PAL?0xAA:0x77);
		HDDVR_i2c_WriteByte(tmpAddr, 0x78, 0x01);
		HDDVR_i2c_WriteByte(tmpAddr, 0x79, 0x01);
	}

	if(ch34_960H==1) {
		HDDVR_i2c_WriteByte(tmpAddr, 0x65, 0x11);
		HDDVR_i2c_WriteByte(tmpAddr, 0x69, 0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x72, 0x55);	
		HDDVR_i2c_WriteByte(tmpAddr, 0x7A, video_mode==NVP1108_PAL?0x06:0x03);
		HDDVR_i2c_WriteByte(tmpAddr, 0x7B, video_mode==NVP1108_PAL?0x06:0x03);
	}
	else {
		HDDVR_i2c_WriteByte(tmpAddr, 0x65, 0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x69, 0x11);
		HDDVR_i2c_WriteByte(tmpAddr, 0x72, video_mode==NVP1108_PAL?0xAA:0x77);				
		HDDVR_i2c_WriteByte(tmpAddr, 0x7A, 0x01);
		HDDVR_i2c_WriteByte(tmpAddr, 0x7B, 0x01);
	}

	if(1==ch12_960H && 1==ch34_960H) {
		HDDVR_i2c_WriteByte(tmpAddr, 0x40, 0x60);
		//============== FSC_EXT_VAL ===================//
		HDDVR_i2c_WriteByte(tmpAddr, 0x44, 0x88);
		HDDVR_i2c_WriteByte(tmpAddr, 0x45, 0x88);
		HDDVR_i2c_WriteByte(tmpAddr, 0x46, 0x88);
		HDDVR_i2c_WriteByte(tmpAddr, 0x47, 0x51);
		HDDVR_i2c_WriteByte(tmpAddr, 0x48, 0x88);
		HDDVR_i2c_WriteByte(tmpAddr, 0x49, 0x88);
		HDDVR_i2c_WriteByte(tmpAddr, 0x4a, 0x88);
		HDDVR_i2c_WriteByte(tmpAddr, 0x4b, 0x51);
	}
	else if(0==ch12_960H && 0==ch34_960H) {
		if(video_mode == NVP1108_NTSC) {
			//============== FSC_EXT_VAL ===================//
			HDDVR_i2c_WriteByte(tmpAddr, 0x44, 0xf5);
			HDDVR_i2c_WriteByte(tmpAddr, 0x45, 0x28);
			HDDVR_i2c_WriteByte(tmpAddr, 0x46, 0x5c);
			HDDVR_i2c_WriteByte(tmpAddr, 0x47, 0x51);
			HDDVR_i2c_WriteByte(tmpAddr, 0x48, 0xf5);
			HDDVR_i2c_WriteByte(tmpAddr, 0x49, 0x28);
			HDDVR_i2c_WriteByte(tmpAddr, 0x4a, 0x5c);
			HDDVR_i2c_WriteByte(tmpAddr, 0x4b, 0x51);
		}
		else {
			//============== FSC_EXT_VAL ===================//
			HDDVR_i2c_WriteByte(tmpAddr, 0x44, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x45, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x46, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x47, 0x51);
			HDDVR_i2c_WriteByte(tmpAddr, 0x48, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x49, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x4a, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x4b, 0x51);			
		}
	}
	else if(1==ch12_960H) {
		if(video_mode == NVP1108_NTSC) {
			//============== FSC_EXT_VAL ===================//
			HDDVR_i2c_WriteByte(tmpAddr, 0x44, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x45, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x46, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x47, 0x51);
			HDDVR_i2c_WriteByte(tmpAddr, 0x48, 0xf5);
			HDDVR_i2c_WriteByte(tmpAddr, 0x49, 0x28);
			HDDVR_i2c_WriteByte(tmpAddr, 0x4a, 0x5c);
			HDDVR_i2c_WriteByte(tmpAddr, 0x4b, 0x51);
		}
		else {
			//============== FSC_EXT_VAL ===================//
			HDDVR_i2c_WriteByte(tmpAddr, 0x44, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x45, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x46, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x47, 0x51);
			HDDVR_i2c_WriteByte(tmpAddr, 0x48, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x49, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x4a, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x4b, 0x51);			
		}
	}
	else if(1 == ch34_960H) {
		if(video_mode == NVP1108_NTSC) {
			//============== FSC_EXT_VAL ===================//
			HDDVR_i2c_WriteByte(tmpAddr, 0x44, 0xf5);
			HDDVR_i2c_WriteByte(tmpAddr, 0x45, 0x28);
			HDDVR_i2c_WriteByte(tmpAddr, 0x46, 0x5c);
			HDDVR_i2c_WriteByte(tmpAddr, 0x47, 0x51);
			HDDVR_i2c_WriteByte(tmpAddr, 0x48, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x49, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x4a, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x4b, 0x51);		
		}
		else {
			//============== FSC_EXT_VAL ===================//
			HDDVR_i2c_WriteByte(tmpAddr, 0x44, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x45, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x46, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x47, 0x51);
			HDDVR_i2c_WriteByte(tmpAddr, 0x48, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x49, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x4a, 0x88);
			HDDVR_i2c_WriteByte(tmpAddr, 0x4b, 0x51);			
		}
	}

	/************bank 3 diff setting *************/
	HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x03);  		
	HDDVR_i2c_WriteByte(tmpAddr, 0x53, (ch34_960H?0x03:0x00)<<2|(ch12_960H?0x03:0x00));		
	HDDVR_i2c_WriteByte(tmpAddr, 0x2C, video_mode==NVP1108_PAL?0x00:0x04);	
	if(0==ch12_960H && 0==ch34_960H) {
		//================== Bank3 =====================//
		HDDVR_i2c_WriteByte(tmpAddr, 0xff, 0x03);
		//========= Mode Enable for Ch 1~2 =============//
		HDDVR_i2c_WriteByte(tmpAddr, 0x25, 0xDD);
		HDDVR_i2c_WriteByte(tmpAddr, 0x29, 0x70);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5c, video_mode==NVP1108_PAL?0x70:0x60);
		HDDVR_i2c_WriteByte(tmpAddr, 0x62, 0x20);
		HDDVR_i2c_WriteByte(tmpAddr, 0x05, 0x24);			
		HDDVR_i2c_WriteByte(tmpAddr, 0x1b, 0x08);	
		HDDVR_i2c_WriteByte(tmpAddr, 0x50, 0x04);			
		HDDVR_i2c_WriteByte(tmpAddr, 0x5f, 0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0xD4, 0x80);
		HDDVR_i2c_WriteByte(tmpAddr, 0xD5, 0x80);
		HDDVR_i2c_WriteByte(tmpAddr, 0xD8, 0x39);
		//================ Bank 5 =====================//
		HDDVR_i2c_WriteByte(tmpAddr, 0xff, 0x05);
		//========= Mode Enable for Ch 3~4 =============//
		HDDVR_i2c_WriteByte(tmpAddr, 0x29, 0x70);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5c, video_mode==NVP1108_PAL?0x70:0x60);
		HDDVR_i2c_WriteByte(tmpAddr, 0x62, 0x20);			
		HDDVR_i2c_WriteByte(tmpAddr, 0x05, 0x24);
		HDDVR_i2c_WriteByte(tmpAddr, 0x1b, 0x08);	
		HDDVR_i2c_WriteByte(tmpAddr, 0x50, 0x04);			
		HDDVR_i2c_WriteByte(tmpAddr, 0x5f, 0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0xD4, 0x80);
		HDDVR_i2c_WriteByte(tmpAddr, 0xD5, 0x80);	
		HDDVR_i2c_WriteByte(tmpAddr, 0xD8, 0x39);
	}
	else if(1==ch12_960H) {
		//================== Bank3 =====================//
		HDDVR_i2c_WriteByte(tmpAddr, 0xff, 0x03);
		//========= Mode Enable for Ch 1~2 =============//
		HDDVR_i2c_WriteByte(tmpAddr, 0x25, video_mode==NVP1108_PAL?0xCC:0xDC);
		HDDVR_i2c_WriteByte(tmpAddr, 0x29, 0x1F);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5c, 0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x62, 0x21);
		HDDVR_i2c_WriteByte(tmpAddr, 0x05, 0x20);
		HDDVR_i2c_WriteByte(tmpAddr, 0x1b, 0x20);	
		HDDVR_i2c_WriteByte(tmpAddr, 0x50, 0x84);			
		HDDVR_i2c_WriteByte(tmpAddr, 0x5f, 0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0xD4, 0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0xD5, 0x80);
		HDDVR_i2c_WriteByte(tmpAddr, 0xD8, 0xb9);
		//================ Bank 5 =====================//
		HDDVR_i2c_WriteByte(tmpAddr, 0xff, 0x05);
		//========= Mode Enable for Ch 3~4 =============//
		HDDVR_i2c_WriteByte(tmpAddr, 0x25, 0xDD);
		HDDVR_i2c_WriteByte(tmpAddr, 0x29, 0x70);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5c, video_mode==NVP1108_PAL?0x70:0x60);
		HDDVR_i2c_WriteByte(tmpAddr, 0x62, 0x20);			
		HDDVR_i2c_WriteByte(tmpAddr, 0x05, 0x24);
		HDDVR_i2c_WriteByte(tmpAddr, 0x1b, 0x08);	
		HDDVR_i2c_WriteByte(tmpAddr, 0x50, 0x04);			
		HDDVR_i2c_WriteByte(tmpAddr, 0x5f, 0x30);	
		HDDVR_i2c_WriteByte(tmpAddr, 0xD4, 0x80);
		HDDVR_i2c_WriteByte(tmpAddr, 0xD5, 0x80);
		HDDVR_i2c_WriteByte(tmpAddr, 0xD8, 0x39);
	}
	else if(1==ch34_960H) {
		//================== Bank3 =====================//
		HDDVR_i2c_WriteByte(tmpAddr, 0xff, 0x03);
		//========= Mode Enable for Ch 1~2 =============//
		HDDVR_i2c_WriteByte(tmpAddr, 0x25, 0xDD);
		HDDVR_i2c_WriteByte(tmpAddr, 0x29, 0x70);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5c, video_mode==NVP1108_PAL?0x70:0x60);
		HDDVR_i2c_WriteByte(tmpAddr, 0x62, 0x20);
		HDDVR_i2c_WriteByte(tmpAddr, 0x05, 0x24);
		HDDVR_i2c_WriteByte(tmpAddr, 0x1b, 0x08);	
		HDDVR_i2c_WriteByte(tmpAddr, 0x50, 0x04);			
		HDDVR_i2c_WriteByte(tmpAddr, 0x5f, 0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0xD4, 0x80);
		HDDVR_i2c_WriteByte(tmpAddr, 0xD5, 0x80);
		HDDVR_i2c_WriteByte(tmpAddr, 0xD8, 0x39);
		//================ Bank 5 =====================//
		HDDVR_i2c_WriteByte(tmpAddr, 0xff, 0x05);
		//========= Mode Enable for Ch 3~4 =============//
		HDDVR_i2c_WriteByte(tmpAddr, 0x25, video_mode==NVP1108_PAL?0xCC:0xDC);
		HDDVR_i2c_WriteByte(tmpAddr, 0x29, 0x1F);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5c, 0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x62, 0x21);
		HDDVR_i2c_WriteByte(tmpAddr, 0x05, 0x20);
		HDDVR_i2c_WriteByte(tmpAddr, 0x1b, 0x20);	
		HDDVR_i2c_WriteByte(tmpAddr, 0x50, 0x84);			
		HDDVR_i2c_WriteByte(tmpAddr, 0x5f, 0x00);	
		HDDVR_i2c_WriteByte(tmpAddr, 0xD4, 0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0xD5, 0x80);
		HDDVR_i2c_WriteByte(tmpAddr, 0xD8, 0xB9);
	}

	HDDVR_i2c_WriteByte(tmpAddr, 0xff, 0x03);
	HDDVR_i2c_WriteByte(tmpAddr, 0x35, video_mode==NVP1108_PAL?0x17:0x15);
	HDDVR_i2c_WriteByte(tmpAddr, 0xC1, video_mode==NVP1108_PAL?0x10:0x30);
	HDDVR_i2c_WriteByte(tmpAddr, 0xC2, video_mode==NVP1108_PAL?0x0E:0x0C);
	HDDVR_i2c_WriteByte(tmpAddr, 0xC3, video_mode==NVP1108_PAL?0x70:0x50);
	HDDVR_i2c_WriteByte(tmpAddr, 0xC8, video_mode==NVP1108_PAL?0x40:0x20);
	HDDVR_i2c_WriteByte(tmpAddr, 0xCC, video_mode==NVP1108_PAL?0x10:0x20);
	HDDVR_i2c_WriteByte(tmpAddr, 0xCD, video_mode==NVP1108_PAL?0x08:0x20);
	HDDVR_i2c_WriteByte(tmpAddr, 0xCE, video_mode==NVP1108_PAL?0x04:0x14);
	HDDVR_i2c_WriteByte(tmpAddr, 0xff, 0x05);
	HDDVR_i2c_WriteByte(tmpAddr, 0x35, video_mode==NVP1108_PAL?0x17:0x15);
	HDDVR_i2c_WriteByte(tmpAddr, 0xC1, video_mode==NVP1108_PAL?0x10:0x30);
	HDDVR_i2c_WriteByte(tmpAddr, 0xC2, video_mode==NVP1108_PAL?0x0E:0x0C);
	HDDVR_i2c_WriteByte(tmpAddr, 0xC3, video_mode==NVP1108_PAL?0x70:0x50);
	HDDVR_i2c_WriteByte(tmpAddr, 0xC8, video_mode==NVP1108_PAL?0x40:0x20);
	HDDVR_i2c_WriteByte(tmpAddr, 0xCC, video_mode==NVP1108_PAL?0x10:0x20);
	HDDVR_i2c_WriteByte(tmpAddr, 0xCD, video_mode==NVP1108_PAL?0x08:0x20);
	HDDVR_i2c_WriteByte(tmpAddr, 0xCE, video_mode==NVP1108_PAL?0x04:0x14);

	/************bank 1 diff setting *************/
	HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x01);  
	HDDVR_i2c_WriteByte(tmpAddr, 0x44, 0x11);
	HDDVR_i2c_WriteByte(tmpAddr, 0x45, (ch34_960H?0x01:0x0B)<<4|(ch12_960H?0x01:0x0B));
	HDDVR_i2c_WriteByte(tmpAddr, 0x47, (ch34_960H?0x02:0x05)<<4|(ch12_960H?0x02:0x05));
	HDDVR_i2c_WriteByte(tmpAddr, 0x50, (ch34_960H?0x07:0x0D)<<4|(ch12_960H?0x07:0x0D));
	HDDVR_i2c_WriteByte(tmpAddr, 0xD3, (ch34_960H?0x00:0x03)<<2|(ch12_960H?0x00:0x03));

	if(ch12_960H==0 && ch34_960H==0) {
		HDDVR_i2c_WriteByte(tmpAddr, 0xCC, 0x66);			
		HDDVR_i2c_WriteByte(tmpAddr, 0xCD, 0x66);
	}
	else if(ch12_960H==1 && ch34_960H==1) {
		HDDVR_i2c_WriteByte(tmpAddr, 0xCC, 0x46);			
		HDDVR_i2c_WriteByte(tmpAddr, 0xCD, 0x46);
	}
	else if(ch12_960H==1) {
		HDDVR_i2c_WriteByte(tmpAddr, 0xCC, 0x66);
		HDDVR_i2c_WriteByte(tmpAddr, 0xCD, 0x46);			
	}
	else if(ch34_960H==1) {
		HDDVR_i2c_WriteByte(tmpAddr, 0xCD, 0x66);
		HDDVR_i2c_WriteByte(tmpAddr, 0xCC, 0x46);
	}

	I2C_UnLock();

#if 0
	if(ch12_960H != ch34_960H) {//
		int j;
		unsigned char iscomet[4], temp;
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x04);
		HDDVR_i2c_WriteByte(tmpAddr, 0x40, 0x60);  //comet

		for(j = 0; j < 4; j ++) {
			msleep(100);
			HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x04);
			iscomet[0] = HDDVR_i2c_ReadByte(tmpAddr, 0x4c);
			printf("ch[0] iscomet[%x]\n\n", iscomet[0]);
			iscomet[1] = HDDVR_i2c_ReadByte(tmpAddr, 0x4d);
			printf("ch[1] iscomet[%x]\n\n", iscomet[1]);
			iscomet[2] = HDDVR_i2c_ReadByte(tmpAddr, 0x4e);
			printf("ch[2] iscomet[%x]\n\n", iscomet[2]);
			iscomet[3] = HDDVR_i2c_ReadByte(tmpAddr, 0x4f);
			printf("ch[3] iscomet[%x]\n\n", iscomet[3]);
		}

		{
			if((iscomet[0]==0x6a||iscomet[1]==0x6a) && ch12_960H==1) { //1,2SDcomet
				HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x00);
				if(iscomet[0]==0x6a)
					HDDVR_i2c_WriteByte(tmpAddr, 0x08, video_mode==NVP1108_PAL?0x9D:0x80);
				if(iscomet[1]==0x6a)
					HDDVR_i2c_WriteByte(tmpAddr, 0x09, video_mode==NVP1108_PAL?0x9D:0x80);
				HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x04);
				HDDVR_i2c_WriteByte(tmpAddr, 0x40, 0x00);
				temp = HDDVR_i2c_ReadByte(tmpAddr, 0x41);
				if(iscomet[0]==0x6a)
					temp |= 0x01;
				if(iscomet[1]==0x6a)
					temp |= 0x01<<1;
				HDDVR_i2c_WriteByte(tmpAddr, 0x41, temp);  //cvbsbit01
				HDDVR_i2c_WriteByte(tmpAddr, 0x44, video_mode==NVP1108_PAL?0x75:0x51);
				HDDVR_i2c_WriteByte(tmpAddr, 0x45, video_mode==NVP1108_PAL?0x35:0x0E);
				HDDVR_i2c_WriteByte(tmpAddr, 0x46, video_mode==NVP1108_PAL?0xB4:0x88);
				HDDVR_i2c_WriteByte(tmpAddr, 0x47, video_mode==NVP1108_PAL?0x6C:0x6C);
			}

			if((iscomet[2]==0x6a||iscomet[3]==0x6a) && ch34_960H==1) { //3,4SDcomet
				HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x00);
				if(iscomet[2]==0x6a)
					HDDVR_i2c_WriteByte(tmpAddr, 0x0A, video_mode==NVP1108_PAL?0x9D:0x80);
				if(iscomet[3]==0x6a)
					HDDVR_i2c_WriteByte(tmpAddr, 0x0B, video_mode==NVP1108_PAL?0x9D:0x80);
				HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x04);
				HDDVR_i2c_WriteByte(tmpAddr, 0x40, 0x00);
				temp = HDDVR_i2c_ReadByte(tmpAddr, 0x41);
				if(iscomet[2]==0x6a)
					temp |= (0x01<<2);
				if(iscomet[3]==0x6a)
					temp |= (0x01<<3);
				HDDVR_i2c_WriteByte(tmpAddr, 0x41, temp);
				HDDVR_i2c_WriteByte(tmpAddr, 0x48, video_mode==NVP1108_PAL?0x75:0x51);
				HDDVR_i2c_WriteByte(tmpAddr, 0x49, video_mode==NVP1108_PAL?0x35:0x0E);
				HDDVR_i2c_WriteByte(tmpAddr, 0x4A, video_mode==NVP1108_PAL?0xB4:0x88);
				HDDVR_i2c_WriteByte(tmpAddr, 0x4B, video_mode==NVP1108_PAL?0x6C:0x6C);
			}
		}

		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x04);
		HDDVR_i2c_WriteByte(tmpAddr, 0x40, 0x00);  //comet
	}
#endif
	printf("ch1/2 mode[%s],ch3/4 mode[%s]\n", ch12_960H?"960H":"720P", ch34_960H?"960H":"720P");
}

static void nvp6114_video_mode_init(int addr, int video_mode)
{
	unsigned char tmpAddr = addr;
	int  ii, jj;

	I2C_InLock();

	if(NVP1108_PAL == video_mode) {
		for(ii = 0; ii < ARRAY_SIZE(NVP6114_PAL_Buf); ii ++) {
			HDDVR_i2c_WriteByte(tmpAddr, 0xFF, ii);
			for(jj = 0; jj < ARRAY_SIZE(NVP6114_PAL_Buf[ii]); jj ++) {
				HDDVR_i2c_WriteByte(tmpAddr, jj, NVP6114_PAL_Buf[ii][jj]);
			}
		}
	}
	else {
		for(ii = 0; ii < ARRAY_SIZE(NVP6114_NTSC_Buf); ii ++) {
			HDDVR_i2c_WriteByte(tmpAddr, 0xFF, ii);
			for(jj = 0; jj < ARRAY_SIZE(NVP6114_NTSC_Buf[ii]); jj ++) {
				HDDVR_i2c_WriteByte(tmpAddr, jj, NVP6114_NTSC_Buf[ii][jj]);
			}
		}
	}

	I2C_UnLock();

	I2C_InLock();

	//bank1
	HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x01);
	HDDVR_i2c_WriteByte(tmpAddr, 0xCC, 0x43);
	HDDVR_i2c_WriteByte(tmpAddr, 0xCD, 0x43);

	if(NVP1108_PAL == video_mode) { //More PAL Mode Fixes;
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x00);
//		HDDVR_i2c_WriteByte(tmpAddr, 0x78, 0x10+0x44);
//		HDDVR_i2c_WriteByte(tmpAddr, 0x79, 0x32+0x44);
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x03);
		HDDVR_i2c_WriteByte(tmpAddr, 0x2C, 0x08);
	}

	//vdec_system_init_grainmedia	
	HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x01);
	HDDVR_i2c_WriteByte(tmpAddr, 0x48, 0x40);
	HDDVR_i2c_WriteByte(tmpAddr, 0x49, 0x02);

	if(1) { // (AHD or 960H or 36M_720H)
		HDDVR_i2c_WriteByte(tmpAddr, 0x4A, 0x03);
		HDDVR_i2c_WriteByte(tmpAddr, 0x4B, 0x10);
	}
	else { // 720H or 1280H or 1440H
		HDDVR_i2c_WriteByte(tmpAddr, 0x4A, 0x22);
		HDDVR_i2c_WriteByte(tmpAddr, 0x4B, 0x20);
	}

	HDDVR_i2c_WriteByte(tmpAddr, 0x48, 0x61);
	HDDVR_i2c_WriteByte(tmpAddr, 0x49, 0x00);

	I2C_UnLock();

	usleep(10*1000);

	I2C_InLock();

	HDDVR_i2c_WriteByte(tmpAddr, 0x48, 0x60);
	HDDVR_i2c_WriteByte(tmpAddr, 0x49, 0x00);

	if(1) { // (AHD or 960H or 36M_720H)
		HDDVR_i2c_WriteByte(tmpAddr, 0x3e, 0x80);
	}
	else {
		HDDVR_i2c_WriteByte(tmpAddr, 0x3e, 0x00);
	}

	HDDVR_i2c_WriteByte(tmpAddr, 0x38, 0x18);
	HDDVR_i2c_WriteByte(tmpAddr, 0x38, 0x08);

	I2C_UnLock();

	usleep(10*1000);

	I2C_InLock();

	//software_reset
	HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x01);
	HDDVR_i2c_WriteByte(tmpAddr, 0x48, 0x40);
	HDDVR_i2c_WriteByte(tmpAddr, 0x49, 0x02);
	HDDVR_i2c_WriteByte(tmpAddr, 0x48, 0x61);
	HDDVR_i2c_WriteByte(tmpAddr, 0x49, 0x00);

	I2C_UnLock();

	usleep(10*1000);

	I2C_InLock();

	HDDVR_i2c_WriteByte(tmpAddr, 0x48, 0x60);
	HDDVR_i2c_WriteByte(tmpAddr, 0x49, 0x00);

	I2C_UnLock();

	usleep(5*1000);
}

void nvp61xx_write_table(unsigned char chip_addr, unsigned char addr, unsigned char *tbl_ptr, unsigned char tbl_cnt)
{
	unsigned char i = 0;

	for(i = 0; i < tbl_cnt; i ++) {
		HDDVR_i2c_WriteByte(chip_addr, (addr + i), *(tbl_ptr + i));
	}
}

void nvp6124_acp_reg_rx_clear(int addr, int chn)
{
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x03+((chn%4)/2));
	HDDVR_i2c_WriteByte(addr, ACP_CLR+((chn%2)*0x80), 0x01);
	usleep(10*1000);
	HDDVR_i2c_WriteByte(addr, ACP_CLR+((chn%2)*0x80), 0x00);
	usleep(100*1000);
}

void nvp6124_acp_init(int addr, int chn)
{
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
	//Decoder TX Setting
	if(AD_AHD_NVP6124 == HDAHD_SYID[0]) {
		HDDVR_i2c_WriteByte(addr, 0xBD, 0xD0);
		HDDVR_i2c_WriteByte(addr, 0xBE, 0xDD);
		HDDVR_i2c_WriteByte(addr, 0xBF, 0x0D);
		ACP_RX_D0 = 0x78;
	}
	else if(AD_AHD_NVP6114A == HDAHD_SYID[0]) {
		HDDVR_i2c_WriteByte(addr, 0xBC, 0xDD);
		HDDVR_i2c_WriteByte(addr, 0xBD, 0xED);
		ACP_RX_D0 = 0x78;
	}
	else if(AD_AHD_NVP6124B == HDAHD_SYID[0]) {
		HDDVR_i2c_WriteByte(addr, 0xBC, 0xF7);
		HDDVR_i2c_WriteByte(addr, 0xBD, 0xF7);
		HDDVR_i2c_WriteByte(addr, 0xA8, 0xA5);
		ACP_RX_D0 = 0x50;
	}

	nvp6124_acp_reg_rx_clear(addr, chn);
}

void nvp6124_acp_each_setting(int addr, int chn, int video_mode, int channel_mode)
{
	nvp6124_acp_init(addr, chn);
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x03+((chn%4)/2));
	if((NVP6124_VI_720P_2530 == channel_mode)
	|| (NVP6124_VI_HDEX == channel_mode)) {
		HDDVR_i2c_WriteByte(addr, AHD2_FHD_BAUD+((chn%2)*0x80), 0x0E);
		HDDVR_i2c_WriteByte(addr, AHD2_FHD_LINE+((chn%2)*0x80), video_mode==NVP1108_PAL ?0x0D:0x0E);
	}
	else if(NVP6124_VI_1080P_2530 == channel_mode) {
		HDDVR_i2c_WriteByte(addr, AHD2_FHD_BAUD+((chn%2)*0x80), 0x0E);
		HDDVR_i2c_WriteByte(addr, AHD2_FHD_LINE+((chn%2)*0x80), 0x0E);
	}
	HDDVR_i2c_WriteByte(addr, AHD2_PEL_SYNC+((chn%2)*0x80), 0x14);
	HDDVR_i2c_WriteByte(addr, AHD2_PEL_SYNC+((chn%2)*0x80)+1, 0x00);
	HDDVR_i2c_WriteByte(addr, AHD2_FHD_LINES+((chn%2)*0x80), 0x07);
	HDDVR_i2c_WriteByte(addr, AHD2_FHD_BYTE+((chn%2)*0x80), 0x03);
	HDDVR_i2c_WriteByte(addr, AHD2_FHD_MODE+((chn%2)*0x80), 0x10);
	HDDVR_i2c_WriteByte(addr, AHD2_PEL_EVEN+((chn%2)*0x80), 0x00);

	//Decoder RX Setting
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x05+(chn%4));
	HDDVR_i2c_WriteByte(addr, 0x30, 0x00);
	HDDVR_i2c_WriteByte(addr, 0x31, 0x01);
	HDDVR_i2c_WriteByte(addr, 0x32, 0x64);
	HDDVR_i2c_WriteByte(addr, 0x7C, 0x11);
	if((NVP6124_VI_720P_2530 == channel_mode)
	|| (NVP6124_VI_HDEX == channel_mode)) {
		HDDVR_i2c_WriteByte(addr, 0x7D, 0x80);
	}
	else if(NVP6124_VI_1080P_2530 == channel_mode) {
		HDDVR_i2c_WriteByte(addr, 0x7D, 0x80);
	}
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x03+((chn%4)/2));

	if((NVP6124_VI_720P_2530 == channel_mode)
	|| (NVP6124_VI_HDEX == channel_mode)) {
		HDDVR_i2c_WriteByte(addr, 0x62+((chn%2)*0x80), video_mode==NVP1108_PAL ?0x05:0x06);	// Camera TX DATA Check
		HDDVR_i2c_WriteByte(addr, 0x68+((chn%2)*0x80), 0x40);	// RX size
	}
	else if(NVP6124_VI_1080P_2530 == channel_mode) {
		HDDVR_i2c_WriteByte(addr, 0x62+((chn%2)*0x80), 0x06);	// Camera TX DATA Check
		HDDVR_i2c_WriteByte(addr, 0x68+((chn%2)*0x80), 0x70);	// RX size
	}

	HDDVR_i2c_WriteByte(addr, 0x60+((chn%2)*0x80), 0x55);
	HDDVR_i2c_WriteByte(addr, 0x63+((chn%2)*0x80), 0x01);
	HDDVR_i2c_WriteByte(addr, 0x66+((chn%2)*0x80), 0x80);
	HDDVR_i2c_WriteByte(addr, 0x67+((chn%2)*0x80), 0x01);

	//printf("ACP DATA READ TEST!!!!CH%d  RESOL = %s\n\r",ch, ch_mode_status[ch]==NVP6124_VI_720P_2530?"720P":"1080P");
}

void nvp6124_set_fpc(int addr, int chn, int video_mode)
{
	unsigned char tmp;

	HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
	tmp = HDDVR_i2c_ReadByte(addr, 0x54);
	if(video_mode == NVP1108_PAL)
		tmp &= ~(0x10<<(chn%4));
	else
		tmp |= (0x10<<(chn%4));
	HDDVR_i2c_WriteByte(addr, 0x54, tmp);
}

void nvp6124b_syncchange(int addr, int chn, int video_mode, int channel_mode)
{
	if(NVP1108_NTSC == video_mode) {
		if(NVP6124_VI_1080P_2530 == channel_mode) {
			HDDVR_i2c_WriteByte(addr, 0xff, 0x00);
			HDDVR_i2c_WriteByte(addr, 0x23+chn*4, 0x43);
			HDDVR_i2c_WriteByte(addr, 0x58+chn, 0x4E);
			HDDVR_i2c_WriteByte(addr, chn+0x8E, 0x09);

			HDDVR_i2c_WriteByte(addr, 0xff, 0x05+chn);
			HDDVR_i2c_WriteByte(addr, 0x24, 0x1A);
			HDDVR_i2c_WriteByte(addr, 0x47, 0xEE);
			HDDVR_i2c_WriteByte(addr, 0x50, 0xC6);
			HDDVR_i2c_WriteByte(addr, 0xBB, 0x04);
		}
		else if(NVP6124_VI_720P_5060 == channel_mode) {
			HDDVR_i2c_WriteByte(addr, 0xff,0x00);
			HDDVR_i2c_WriteByte(addr, 0x23+chn*4, 0x43);
			HDDVR_i2c_WriteByte(addr, 0x58+chn, 0xa8);
			HDDVR_i2c_WriteByte(addr, chn+0x8E, 0x09);

			HDDVR_i2c_WriteByte(addr, 0xff, 0x05+chn);
			HDDVR_i2c_WriteByte(addr, 0x24, 0x2A);
			HDDVR_i2c_WriteByte(addr, 0x47, 0xEE);
			HDDVR_i2c_WriteByte(addr, 0x50, 0xC6);
			HDDVR_i2c_WriteByte(addr, 0xBB, 0x04);
		}
		else {
			HDDVR_i2c_WriteByte(addr, 0xff, 0x00);
			HDDVR_i2c_WriteByte(addr, 0x23+chn*4, 0x43);
			HDDVR_i2c_WriteByte(addr, 0xff, 0x05+chn);
			HDDVR_i2c_WriteByte(addr, 0x47, 0x04);
		}
	}
	else {
		HDDVR_i2c_WriteByte(addr, 0xff, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x23+chn*4, 0x43);
		HDDVR_i2c_WriteByte(addr, 0xff, 0x05+chn);
		HDDVR_i2c_WriteByte(addr, 0x47, 0x04);
	}
}

void nvp6124_each_mode_setting(int addr, int chnl, int video_mode, int channel_mode)
{
	unsigned char tmpAddr = addr;
	unsigned char tmpChnl = chnl%4;

	unsigned char pn_value_sd_nt_comet[4]  = {0x4D,0x0E,0x88,0x6C};
	unsigned char pn_value_720p_30[4]      = {0xEE,0x00,0xE5,0x4E};
	unsigned char pn_value_720p_60[4]      = {0x2C,0xF9,0xC5,0x52};
	unsigned char pn_value_fhd_nt[4]       = {0x2C,0xF0,0xCA,0x52};
	unsigned char pn_value_sd_pal_comet[4] = {0x75,0x35,0xB4,0x6C};
	unsigned char pn_value_720p_25[4]      = {0x46,0x08,0x10,0x4F};
	unsigned char pn_value_720p_50[4]      = {0x2C,0xE7,0xCF,0x52};
	unsigned char pn_value_fhd_pal[4]      = {0xC8,0x7D,0xC3,0x52};

	unsigned char tmpValue = 0x00;

	switch(channel_mode) {
	case NVP6124_VI_SD:
	case NVP6124_VI_1920H:
	case NVP6124_VI_720H:
	case NVP6124_VI_1280H:
	case NVP6124_VI_1440H:
	case NVP6124_VI_960H2EX:
		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x08+tmpChnl, (video_mode==NVP1108_PAL)?0xDD:0xA0);
		HDDVR_i2c_WriteByte(tmpAddr, 0x0c+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0xFF); //Bri Value
		HDDVR_i2c_WriteByte(tmpAddr, 0x10+tmpChnl, (video_mode==NVP1108_PAL)?0x90:0x92); //Con Value
		HDDVR_i2c_WriteByte(tmpAddr, 0x14+tmpChnl, (video_mode==NVP1108_PAL)?0x80:0x80);
		HDDVR_i2c_WriteByte(tmpAddr, 0x18+tmpChnl, (video_mode==NVP1108_PAL)?0x18:0x18);
		HDDVR_i2c_WriteByte(tmpAddr, 0x21+4*tmpChnl, (video_mode==NVP1108_PAL)?0x02:0x82);
		HDDVR_i2c_WriteByte(tmpAddr, 0x22+4*tmpChnl, 0x0B);
		HDDVR_i2c_WriteByte(tmpAddr, 0x23+4*tmpChnl, 0x43);
		HDDVR_i2c_WriteByte(tmpAddr, 0x30+tmpChnl, (video_mode==NVP1108_PAL)?0x12:0x11);
		HDDVR_i2c_WriteByte(tmpAddr, 0x3c+tmpChnl, (video_mode==NVP1108_PAL)?0x88:0x88); //Sat Value
		HDDVR_i2c_WriteByte(tmpAddr, 0x40+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x01); //Hue Value
		HDDVR_i2c_WriteByte(tmpAddr, 0x44+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x48+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x4c+tmpChnl, (video_mode==NVP1108_PAL)?0x04:0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x50+tmpChnl, (video_mode==NVP1108_PAL)?0x04:0x00);
		nvp6124_set_fpc(tmpAddr, tmpChnl, video_mode);
		if(NVP6124_VI_SD == channel_mode) {
			if(AD_AHD_NVP6124B == HDAHD_SYID[0])
				HDDVR_i2c_WriteByte(tmpAddr, 0x58+tmpChnl, (video_mode==NVP1108_PAL)?0x60:0xC0);
			else
				HDDVR_i2c_WriteByte(tmpAddr, 0x58+tmpChnl, (video_mode==NVP1108_PAL)?0x80:0x90);
		}
		else if(NVP6124_VI_960H2EX == channel_mode) {
			HDDVR_i2c_WriteByte(tmpAddr, 0x58+tmpChnl, (video_mode==NVP1108_PAL)?0x80:0x90);
		}
		else if(NVP6124_VI_720H == channel_mode) {
			if(AD_AHD_NVP6124B == HDAHD_SYID[0])
				HDDVR_i2c_WriteByte(tmpAddr, 0x58+tmpChnl, (video_mode==NVP1108_PAL)?0x70:0x70);
			else
				HDDVR_i2c_WriteByte(tmpAddr, 0x58+tmpChnl, (video_mode==NVP1108_PAL)?0xB0:0x40);
		}
		else if(NVP6124_VI_1280H == channel_mode) {
			if(AD_AHD_NVP6124B == HDAHD_SYID[0])
				HDDVR_i2c_WriteByte(tmpAddr, 0x58+tmpChnl, (video_mode==NVP1108_PAL)?0x50:0x50);
			else
				HDDVR_i2c_WriteByte(tmpAddr, 0x58+tmpChnl, (video_mode==NVP1108_PAL)?0x80:0x90);
		}
		else if(NVP6124_VI_1440H == channel_mode) {
			HDDVR_i2c_WriteByte(tmpAddr, 0x58+tmpChnl, (video_mode==NVP1108_PAL)?0x90:0xA0);
		}
		else {
			if(AD_AHD_NVP6124B == HDAHD_SYID[0])
				HDDVR_i2c_WriteByte(tmpAddr, 0x58+tmpChnl, (video_mode==NVP1108_PAL)?0x88:0x98);
			else
				HDDVR_i2c_WriteByte(tmpAddr, 0x58+tmpChnl, (video_mode==NVP1108_PAL)?0x3B:0x4B);
		}
		HDDVR_i2c_WriteByte(tmpAddr, 0x5c+tmpChnl, (video_mode==NVP1108_PAL)?0x1e:0x1e);
		HDDVR_i2c_WriteByte(tmpAddr, 0x64+tmpChnl, (video_mode==NVP1108_PAL)?0x0d:0x08);
		if(AD_AHD_NVP6124B == HDAHD_SYID[0]) {
			if((NVP6124_VI_SD == channel_mode) || (NVP6124_VI_720H == channel_mode)) {
				HDDVR_i2c_WriteByte(tmpAddr, 0x81+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
				HDDVR_i2c_WriteByte(tmpAddr, 0x85+tmpChnl, (video_mode==NVP1108_PAL)?0x11:0x11);
				if(NVP6124_VI_720H == channel_mode) {
					printf("tmpChnl %d setted to 720H %s\n", tmpChnl, (video_mode==NVP1108_PAL)?"PAL":"NTSC");
					HDDVR_i2c_WriteByte(tmpAddr, 0x89+tmpChnl, (video_mode==NVP1108_PAL)?0x11:0x11);
					HDDVR_i2c_WriteByte(tmpAddr, tmpChnl+0x8E, (video_mode==NVP1108_PAL)?0x00:0x00);
				}
				else {
					printf("tmpChnl %d setted to 960H %s\n", tmpChnl, (video_mode==NVP1108_PAL)?"PAL":"NTSC");
					HDDVR_i2c_WriteByte(tmpAddr, 0x89+tmpChnl, (video_mode==NVP1108_PAL)?0x10:0x00);
					HDDVR_i2c_WriteByte(tmpAddr, tmpChnl+0x8E, (video_mode==NVP1108_PAL)?0x08:0x07);
				}
			}
			else if(NVP6124_VI_1280H == channel_mode) {
				printf("tmpChnl %d setted to 1280H %s\n", tmpChnl, (video_mode==NVP1108_PAL)?"PAL":"NTSC");
				HDDVR_i2c_WriteByte(tmpAddr, 0x81+tmpChnl, (video_mode==NVP1108_PAL)?0x20:0x20);
				HDDVR_i2c_WriteByte(tmpAddr, 0x85+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
				HDDVR_i2c_WriteByte(tmpAddr, 0x89+tmpChnl, (video_mode==NVP1108_PAL)?0x10:0x10);
				HDDVR_i2c_WriteByte(tmpAddr, tmpChnl+0x8E, (video_mode==NVP1108_PAL)?0x20:0x20);
			}
			else if(NVP6124_VI_1440H == channel_mode) {
				printf("tmpChnl %d setted to 1440H %s\n", tmpChnl, (video_mode==NVP1108_PAL)?"PAL":"NTSC");
				HDDVR_i2c_WriteByte(tmpAddr, 0x81+tmpChnl, (video_mode==NVP1108_PAL)?0x30:0x30);
				HDDVR_i2c_WriteByte(tmpAddr, 0x85+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
				HDDVR_i2c_WriteByte(tmpAddr, 0x89+tmpChnl, (video_mode==NVP1108_PAL)?0x10:0x10);
				HDDVR_i2c_WriteByte(tmpAddr, tmpChnl+0x8E, (video_mode==NVP1108_PAL)?0x10:0x10);
			}
			else if(NVP6124_VI_960H2EX == channel_mode) {
				printf("tmpChnl %d setted to 3840H %s\n", tmpChnl, (video_mode==NVP1108_PAL)?"PAL":"NTSC");
				HDDVR_i2c_WriteByte(tmpAddr, 0x81+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
				HDDVR_i2c_WriteByte(tmpAddr, 0x85+tmpChnl, (video_mode==NVP1108_PAL)?0x11:0x11);
				HDDVR_i2c_WriteByte(tmpAddr, 0x89+tmpChnl, (video_mode==NVP1108_PAL)?0x10:0x10);
				HDDVR_i2c_WriteByte(tmpAddr, tmpChnl+0x8E, (video_mode==NVP1108_PAL)?0x22:0x22);
			}
			else {
				printf("tmpChnl %d setted to 1920H %s\n", tmpChnl, (video_mode==NVP1108_PAL)?"PAL":"NTSC");
				HDDVR_i2c_WriteByte(tmpAddr, 0x81+tmpChnl, (video_mode==NVP1108_PAL)?0x40:0x40);
				HDDVR_i2c_WriteByte(tmpAddr, 0x85+tmpChnl, (video_mode==NVP1108_PAL)?0x11:0x11);
				HDDVR_i2c_WriteByte(tmpAddr, 0x89+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
				HDDVR_i2c_WriteByte(tmpAddr, tmpChnl+0x8E, (video_mode==NVP1108_PAL)?0x10:0x10);
			}
		}
		else {
			if(NVP6124_VI_SD == channel_mode || NVP6124_VI_720H == channel_mode) {
				HDDVR_i2c_WriteByte(tmpAddr, 0x81+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
				HDDVR_i2c_WriteByte(tmpAddr, 0x85+tmpChnl, (video_mode==NVP1108_PAL)?0x11:0x11);
				if(NVP6124_VI_720H == channel_mode) {
					printf("tmpChnl %d setted to 720H %s\n", tmpChnl, (video_mode==NVP1108_PAL)?"PAL":"NTSC");
					HDDVR_i2c_WriteByte(tmpAddr, 0x89+tmpChnl, (video_mode==NVP1108_PAL)?0x11:0x11);
					HDDVR_i2c_WriteByte(tmpAddr, tmpChnl+0x8E, (video_mode==NVP1108_PAL)?0x20:0x00);
				}
				else {
					printf("tmpChnl %d setted to 960H %s\n", tmpChnl, (video_mode==NVP1108_PAL)?"PAL":"NTSC");
					HDDVR_i2c_WriteByte(tmpAddr, 0x89+tmpChnl, (video_mode==NVP1108_PAL)?0x10:0x00);
					HDDVR_i2c_WriteByte(tmpAddr, tmpChnl+0x8E, (video_mode==NVP1108_PAL)?0x08:0x07);
				}
			}
			else if(NVP6124_VI_1280H == channel_mode) {
				printf("tmpChnl %d setted to 1280H %s\n", tmpChnl, (video_mode==NVP1108_PAL)?"PAL":"NTSC");
				HDDVR_i2c_WriteByte(tmpAddr, 0x81+tmpChnl, (video_mode==NVP1108_PAL)?0x20:0x20);
				HDDVR_i2c_WriteByte(tmpAddr, 0x85+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
				HDDVR_i2c_WriteByte(tmpAddr, 0x89+tmpChnl, (video_mode==NVP1108_PAL)?0x10:0x10);
				HDDVR_i2c_WriteByte(tmpAddr, tmpChnl+0x8E, (video_mode==NVP1108_PAL)?0x17:0x17);
			}
			else if(NVP6124_VI_1440H == channel_mode) {
				printf("tmpChnl %d setted to 1440H %s\n", tmpChnl, (video_mode==NVP1108_PAL)?"PAL":"NTSC");
				HDDVR_i2c_WriteByte(tmpAddr, 0x81+tmpChnl, (video_mode==NVP1108_PAL)?0x30:0x30);
				HDDVR_i2c_WriteByte(tmpAddr, 0x85+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
				HDDVR_i2c_WriteByte(tmpAddr, 0x89+tmpChnl, (video_mode==NVP1108_PAL)?0x10:0x10);
				HDDVR_i2c_WriteByte(tmpAddr, tmpChnl+0x8E, (video_mode==NVP1108_PAL)?0x0B:0x0B);
			}
			else {
				printf("tmpChnl %d setted to 1920H %s\n", tmpChnl, (video_mode==NVP1108_PAL)?"PAL":"NTSC");
				HDDVR_i2c_WriteByte(tmpAddr, 0x81+tmpChnl, (video_mode==NVP1108_PAL)?0x40:0x40);
				HDDVR_i2c_WriteByte(tmpAddr, 0x85+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
				HDDVR_i2c_WriteByte(tmpAddr, 0x89+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
				HDDVR_i2c_WriteByte(tmpAddr, tmpChnl+0x8E, (video_mode==NVP1108_PAL)?0x10:0x10);
			}
		}
		HDDVR_i2c_WriteByte(tmpAddr, 0x93+tmpChnl, 0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x98+tmpChnl, (video_mode==NVP1108_PAL)?0x07:0x04);
		if(AD_AHD_NVP6124B == HDAHD_SYID[0]) {
			if(NVP6124_VI_960H2EX == channel_mode)
				HDDVR_i2c_WriteByte(tmpAddr, 0xa0+tmpChnl, (video_mode==NVP1108_PAL)?0x10:0x5);
			else
				HDDVR_i2c_WriteByte(tmpAddr, 0xa0+tmpChnl, (video_mode==NVP1108_PAL)?0x10:0x10);
			HDDVR_i2c_WriteByte(tmpAddr, 0xa4+tmpChnl, (video_mode==NVP1108_PAL)?0x05:0x07);
		}
		else {
			HDDVR_i2c_WriteByte(tmpAddr, 0xa0+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x10);
			HDDVR_i2c_WriteByte(tmpAddr, 0xa4+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x01);
		}
		I2C_UnLock();
		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x01);
		if(AD_AHD_NVP6124B == HDAHD_SYID[0]) {
			if((NVP6124_VI_SD == channel_mode) || (NVP6124_VI_720H == channel_mode)) {
				HDDVR_i2c_WriteByte(tmpAddr, 0x88+tmpChnl, (video_mode==NVP1108_PAL)?0x06:0x06);
				HDDVR_i2c_WriteByte(tmpAddr, 0x8c+tmpChnl, (video_mode==NVP1108_PAL)?0xa6:0xa6);
				//HDDVR_i2c_WriteByte(tmpAddr, 0x90+tmpChnl, 0x03);
				//HDDVR_i2c_WriteByte(tmpAddr, 0xA0+tmpChnl, 0x00);
				HDDVR_i2c_WriteByte(tmpAddr, 0xd7, HDDVR_i2c_ReadByte(tmpAddr, 0xd7)&(~(1<<tmpChnl)));
			}
			else if(NVP6124_VI_1280H == channel_mode) {
				HDDVR_i2c_WriteByte(tmpAddr, 0x88+tmpChnl, (video_mode==NVP1108_PAL)?0x06:0x06);
				HDDVR_i2c_WriteByte(tmpAddr, 0x8c+tmpChnl, (video_mode==NVP1108_PAL)?0x26:0x26);
				//HDDVR_i2c_WriteByte(tmpAddr, 0x90+tmpChnl, 0x00);
				//HDDVR_i2c_WriteByte(tmpAddr, 0xA0+tmpChnl, 0x00);
				HDDVR_i2c_WriteByte(tmpAddr, 0xd7,HDDVR_i2c_ReadByte(tmpAddr, 0xd7)|(1<<tmpChnl));
			}
			else if(NVP6124_VI_1440H == channel_mode) {
				HDDVR_i2c_WriteByte(tmpAddr, 0x88+tmpChnl, (video_mode==NVP1108_PAL)?0x06:0x06);
				HDDVR_i2c_WriteByte(tmpAddr, 0x8c+tmpChnl, (video_mode==NVP1108_PAL)?0x26:0x26);
				//HDDVR_i2c_WriteByte(tmpAddr, 0x90+tmpChnl, 0x00);
				//HDDVR_i2c_WriteByte(tmpAddr, 0xA0+tmpChnl, 0x00);
				HDDVR_i2c_WriteByte(tmpAddr, 0xd7,HDDVR_i2c_ReadByte(tmpAddr, 0xd7)|(1<<tmpChnl));
			}
			else if(NVP6124_VI_960H2EX == channel_mode) {
				HDDVR_i2c_WriteByte(tmpAddr, 0x88+tmpChnl, (video_mode==NVP1108_PAL)?0x06:0x06);
				HDDVR_i2c_WriteByte(tmpAddr, 0x8c+tmpChnl, (video_mode==NVP1108_PAL)?0x46:0x46);
				//HDDVR_i2c_WriteByte(tmpAddr, 0x90+tmpChnl, 0x01);
				//HDDVR_i2c_WriteByte(tmpAddr, 0xA0+tmpChnl, 0x01);
				HDDVR_i2c_WriteByte(tmpAddr, 0xd7,HDDVR_i2c_ReadByte(tmpAddr, 0xd7)|(1<<tmpChnl));
			}
			else {
				HDDVR_i2c_WriteByte(tmpAddr, 0x88+tmpChnl, (video_mode==NVP1108_PAL)?0x06:0x06);
				HDDVR_i2c_WriteByte(tmpAddr, 0x8c+tmpChnl, (video_mode==NVP1108_PAL)?0x06:0x06);
				//HDDVR_i2c_WriteByte(tmpAddr, 0x90+tmpChnl, 0x00);
				//HDDVR_i2c_WriteByte(tmpAddr, 0xA0+tmpChnl, 0x00);
				HDDVR_i2c_WriteByte(tmpAddr, 0xd7,HDDVR_i2c_ReadByte(tmpAddr, 0xd7)|(1<<tmpChnl));
			}
		}
		else {
			if((NVP6124_VI_SD == channel_mode) || (NVP6124_VI_720H == channel_mode)) {
				HDDVR_i2c_WriteByte(tmpAddr, 0x88+tmpChnl, (video_mode==NVP1108_PAL)?0x7e:0x7e);
				HDDVR_i2c_WriteByte(tmpAddr, 0x8c+tmpChnl, (video_mode==NVP1108_PAL)?0x26:0x26);
				HDDVR_i2c_WriteByte(tmpAddr, 0xd7, HDDVR_i2c_ReadByte(tmpAddr, 0xd7)&(~(1<<tmpChnl)));
			}
			else if(NVP6124_VI_1280H == channel_mode) {
				HDDVR_i2c_WriteByte(tmpAddr, 0x88+tmpChnl, (video_mode==NVP1108_PAL)?0x7e:0x7e);
				HDDVR_i2c_WriteByte(tmpAddr, 0x8c+tmpChnl, (video_mode==NVP1108_PAL)?0x56:0x56);
				HDDVR_i2c_WriteByte(tmpAddr, 0xd7,HDDVR_i2c_ReadByte(tmpAddr, 0xd7)|(1<<tmpChnl));
			}
			else if(NVP6124_VI_1440H == channel_mode) {
				HDDVR_i2c_WriteByte(tmpAddr, 0x88+tmpChnl, (video_mode==NVP1108_PAL)?0x7e:0x7e);
				HDDVR_i2c_WriteByte(tmpAddr, 0x8c+tmpChnl, (video_mode==NVP1108_PAL)?0x56:0x56);
				HDDVR_i2c_WriteByte(tmpAddr, 0xd7,HDDVR_i2c_ReadByte(tmpAddr, 0xd7)|(1<<tmpChnl));
			}
			else { //if(chmode[tmpChnl]==NVP6124_VI_1920H)
				HDDVR_i2c_WriteByte(tmpAddr, 0x88+tmpChnl, (video_mode==NVP1108_PAL)?0x46:0x46);
				HDDVR_i2c_WriteByte(tmpAddr, 0x8c+tmpChnl, (video_mode==NVP1108_PAL)?0x47:0x47);
				HDDVR_i2c_WriteByte(tmpAddr, 0xd7,HDDVR_i2c_ReadByte(tmpAddr, 0xd7)|(1<<tmpChnl));
			}
		}
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x02);
		tmpValue = HDDVR_i2c_ReadByte(tmpAddr, 0x16+tmpChnl/2);
		HDDVR_i2c_WriteByte(tmpAddr, 0x16+tmpChnl/2, (tmpValue&((tmpChnl%2)==0?0xF0:0x0F))|(0x00<<((tmpChnl%2)*4)));
		I2C_UnLock();
		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x05+tmpChnl);
		nvp61xx_write_table(tmpAddr, 0x00, NVP6124_B5678_SD_Buf, 254 );
		HDDVR_i2c_WriteByte(tmpAddr, 0x06, 0x40);
		HDDVR_i2c_WriteByte(tmpAddr, 0x0F, (video_mode==NVP1108_PAL)?0x13:0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x1B, 0x08);
		HDDVR_i2c_WriteByte(tmpAddr, 0x20, 0x88);
		HDDVR_i2c_WriteByte(tmpAddr, 0x1E, (video_mode==NVP1108_PAL)?0x00:0x01);
		HDDVR_i2c_WriteByte(tmpAddr, 0x2C, (video_mode==NVP1108_PAL)?0x00:0x04);
		HDDVR_i2c_WriteByte(tmpAddr, 0x35, (video_mode==NVP1108_PAL)?0x17:0x15);
		if(AD_AHD_NVP6124B == HDAHD_SYID[0])
			HDDVR_i2c_WriteByte(tmpAddr, 0x62,0x00);
		else
			HDDVR_i2c_WriteByte(tmpAddr, 0x62, (video_mode==NVP1108_PAL)?0x20:0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0xA1, (video_mode==NVP1108_PAL)?0x10:0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0xA2, (video_mode==NVP1108_PAL)?0x0E:0x0C);
		HDDVR_i2c_WriteByte(tmpAddr, 0xA3, (video_mode==NVP1108_PAL)?0x70:0x50);
		HDDVR_i2c_WriteByte(tmpAddr, 0xA8, (video_mode==NVP1108_PAL)?0x40:0x20);
		HDDVR_i2c_WriteByte(tmpAddr, 0xAC, (video_mode==NVP1108_PAL)?0x10:0x20);
		HDDVR_i2c_WriteByte(tmpAddr, 0xAD, (video_mode==NVP1108_PAL)?0x08:0x20);
		HDDVR_i2c_WriteByte(tmpAddr, 0xAE, (video_mode==NVP1108_PAL)?0x04:0x14);
		HDDVR_i2c_WriteByte(tmpAddr, 0xC0, (video_mode==NVP1108_PAL)?0x0D:0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x25, (video_mode==NVP1108_PAL)?0xCA:0xDA);
		if(NVP6124_VI_1280H == channel_mode || NVP6124_VI_1440H == channel_mode) {
			HDDVR_i2c_WriteByte(tmpAddr, 0x62, (video_mode==NVP1108_PAL)?0x20:0x20);
			HDDVR_i2c_WriteByte(tmpAddr, 0x64, (video_mode==NVP1108_PAL)?0x0D:0x0D);
		}
		else if(NVP6124_VI_960H2EX == channel_mode) {
			HDDVR_i2c_WriteByte(tmpAddr, 0x6B, 0x10);
		}
		I2C_UnLock();
		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x09);
		HDDVR_i2c_WriteByte(tmpAddr, 0x40+tmpChnl, 0x60);
		HDDVR_i2c_WriteByte(tmpAddr, 0x44, HDDVR_i2c_ReadByte(tmpAddr, 0x44)&(~(1<<tmpChnl)));
		HDDVR_i2c_WriteByte(tmpAddr, 0x50+4*tmpChnl, (video_mode==NVP1108_PAL)?pn_value_sd_pal_comet[0]:pn_value_sd_nt_comet[0]);	//tmpChnl%41 960H
		HDDVR_i2c_WriteByte(tmpAddr, 0x51+4*tmpChnl, (video_mode==NVP1108_PAL)?pn_value_sd_pal_comet[1]:pn_value_sd_nt_comet[1]);
		HDDVR_i2c_WriteByte(tmpAddr, 0x52+4*tmpChnl, (video_mode==NVP1108_PAL)?pn_value_sd_pal_comet[2]:pn_value_sd_nt_comet[2]);
		HDDVR_i2c_WriteByte(tmpAddr, 0x53+4*tmpChnl, (video_mode==NVP1108_PAL)?pn_value_sd_pal_comet[3]:pn_value_sd_nt_comet[3]);
		I2C_UnLock();
		printf("tmpChnl %d setted to SD %s\n", tmpChnl, (video_mode==NVP1108_PAL)?"PAL":"NTSC");
		break;
	case NVP6124_VI_720P_2530:
	case NVP6124_VI_HDEX:
		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x08+tmpChnl, (video_mode==NVP1108_PAL)?0x60:0x60);
		HDDVR_i2c_WriteByte(tmpAddr, 0x0c+tmpChnl, (video_mode==NVP1108_PAL)?0x08:0x08); //Bri Value
		HDDVR_i2c_WriteByte(tmpAddr, 0x10+tmpChnl, (video_mode==NVP1108_PAL)?0x88:0x88); //Con Value
		HDDVR_i2c_WriteByte(tmpAddr, 0x14+tmpChnl, (video_mode==NVP1108_PAL)?0x90:0x90);
		HDDVR_i2c_WriteByte(tmpAddr, 0x18+tmpChnl, (video_mode==NVP1108_PAL)?0x30:0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0x21+4*tmpChnl, 0x92);
		HDDVR_i2c_WriteByte(tmpAddr, 0x22+4*tmpChnl, 0x0A);
		HDDVR_i2c_WriteByte(tmpAddr, 0x23+4*tmpChnl, 0x43);
		HDDVR_i2c_WriteByte(tmpAddr, 0x30+tmpChnl, (video_mode==NVP1108_PAL)?0x12:0x12);
		HDDVR_i2c_WriteByte(tmpAddr, 0x3c+tmpChnl, (video_mode==NVP1108_PAL)?0x90:0x90); //Sat Value
		HDDVR_i2c_WriteByte(tmpAddr, 0x40+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0xFD); //Hue Value
		HDDVR_i2c_WriteByte(tmpAddr, 0x44+tmpChnl, (video_mode==NVP1108_PAL)?0x30:0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0x48+tmpChnl, (video_mode==NVP1108_PAL)?0x30:0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0x4c+tmpChnl, (video_mode==NVP1108_PAL)?0x04:0x04);
		HDDVR_i2c_WriteByte(tmpAddr, 0x50+tmpChnl, (video_mode==NVP1108_PAL)?0x04:0x04);
		nvp6124_set_fpc(tmpAddr, tmpChnl, video_mode);
		HDDVR_i2c_WriteByte(tmpAddr, 0x58+tmpChnl, (video_mode==NVP1108_PAL)?0x80:0x90);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5c+tmpChnl, (video_mode==NVP1108_PAL)?0x9e:0x9e);
		HDDVR_i2c_WriteByte(tmpAddr, 0x64+tmpChnl, (video_mode==NVP1108_PAL)?0xb1:0xb2);
		HDDVR_i2c_WriteByte(tmpAddr, 0x81+tmpChnl, (video_mode==NVP1108_PAL)?0x07:0x06);
		HDDVR_i2c_WriteByte(tmpAddr, 0x85+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x89+tmpChnl, (video_mode==NVP1108_PAL)?0x10:0x10);
		if(AD_AHD_NVP6124B == HDAHD_SYID[0]) {
			if(NVP6124_VI_HDEX == channel_mode)
				HDDVR_i2c_WriteByte(tmpAddr, tmpChnl+0x8E, 0x07);
			else
				HDDVR_i2c_WriteByte(tmpAddr, tmpChnl+0x8E, 0x0d);
		}
		else {
			HDDVR_i2c_WriteByte(tmpAddr, tmpChnl+0x8E, (video_mode==NVP1108_PAL)?0x0d:0x0d);
		}
		HDDVR_i2c_WriteByte(tmpAddr, 0x93+tmpChnl, 0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x98+tmpChnl, (video_mode==NVP1108_PAL)?0x07:0x04);
		HDDVR_i2c_WriteByte(tmpAddr, 0xa0+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0xa4+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x01);
		I2C_UnLock();
		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF,0x01);
		if(AD_AHD_NVP6124B == HDAHD_SYID[0]) {
			HDDVR_i2c_WriteByte(tmpAddr, 0x88+tmpChnl, (video_mode==NVP1108_PAL)?0x0A:0x0A);

			if(NVP6124_VI_HDEX == channel_mode) {
				printf("tmpChnl %d setted to HDEX(2560x720) %s\n", tmpChnl, (video_mode==NVP1108_PAL)?"PAL":"NTSC");
				HDDVR_i2c_WriteByte(tmpAddr, 0x8c+tmpChnl, (video_mode==NVP1108_PAL)?0x4A:0x5A);
				//HDDVR_i2c_WriteByte(tmpAddr, 0x90+tmpChnl, (video_mode==NVP1108_PAL)?0x01:0x01);
				//HDDVR_i2c_WriteByte(tmpAddr, 0xA0+tmpChnl, (video_mode==NVP1108_PAL)?0x01:0x01);
			}
			else {
				printf("tmpChnl %d setted to 720P %s\n", tmpChnl, (video_mode==NVP1108_PAL)?"PAL":"NTSC");
				HDDVR_i2c_WriteByte(tmpAddr, 0x8c+tmpChnl, (video_mode==NVP1108_PAL)?0x0A:0x0A);
				//HDDVR_i2c_WriteByte(tmpAddr, 0x90+tmpChnl/2, (video_mode==NVP1108_PAL)?0x00:0x00);
				//HDDVR_i2c_WriteByte(tmpAddr, 0x91+tmpChnl/2, (video_mode==NVP1108_PAL)?0x00:0x00);
				//HDDVR_i2c_WriteByte(tmpAddr, 0xA0+tmpChnl/2, (video_mode==NVP1108_PAL)?0x00:0x00);
				//HDDVR_i2c_WriteByte(tmpAddr, 0xA1+tmpChnl/2, (video_mode==NVP1108_PAL)?0x00:0x00);
			}

			HDDVR_i2c_WriteByte(tmpAddr, 0x9E, (video_mode==NVP1108_PAL)?0x55:0x55);

			if(AD_AHD_NVP6124 == HDAHD_SYID[0]) {
				HDDVR_i2c_WriteByte(tmpAddr, 0x97, 0x0f);
				HDDVR_i2c_WriteByte(tmpAddr, 0x97, 0x00);
				HDDVR_i2c_WriteByte(tmpAddr, 0x97, 0x0f);
			}
		}
		else {
			HDDVR_i2c_WriteByte(tmpAddr, 0x88+tmpChnl,(video_mode==NVP1108_PAL)?0x5C:0x5C);
			HDDVR_i2c_WriteByte(tmpAddr, 0x8c+tmpChnl,(video_mode==NVP1108_PAL)?0x40:0x40);
		}
		HDDVR_i2c_WriteByte(tmpAddr, 0xd7,HDDVR_i2c_ReadByte(tmpAddr, 0xd7)|(1<<tmpChnl));
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x02);
		tmpValue = HDDVR_i2c_ReadByte(tmpAddr, 0x16+tmpChnl/2);
		HDDVR_i2c_WriteByte(tmpAddr, 0x16+tmpChnl/2, (tmpValue&(tmpChnl%2==0?0xF0:0x0F))|(0x05<<((tmpChnl%2)*4)));
		I2C_UnLock();
		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x05+tmpChnl);
		nvp61xx_write_table(tmpAddr, 0x00, NVP6124_Buf[5],254 );
		HDDVR_i2c_WriteByte(tmpAddr, 0x01, 0x0D);
		HDDVR_i2c_WriteByte(tmpAddr, 0x06, 0x40);
		HDDVR_i2c_WriteByte(tmpAddr, 0x1E, (video_mode==NVP1108_PAL)?0x00:0x01);
		HDDVR_i2c_WriteByte(tmpAddr, 0x35, (video_mode==NVP1108_PAL)?0x17:0x15);
		HDDVR_i2c_WriteByte(tmpAddr, 0x7A, (video_mode==NVP1108_PAL)?0x00:0x01);
		HDDVR_i2c_WriteByte(tmpAddr, 0x7B, (video_mode==NVP1108_PAL)?0x00:0x81);
		HDDVR_i2c_WriteByte(tmpAddr, 0xA1, (video_mode==NVP1108_PAL)?0x10:0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0xA2, (video_mode==NVP1108_PAL)?0x0E:0x0C);
		HDDVR_i2c_WriteByte(tmpAddr, 0xA3, (video_mode==NVP1108_PAL)?0x70:0x50);
		HDDVR_i2c_WriteByte(tmpAddr, 0xA8, (video_mode==NVP1108_PAL)?0x40:0x20);
		HDDVR_i2c_WriteByte(tmpAddr, 0xAC, (video_mode==NVP1108_PAL)?0x10:0x20);
		HDDVR_i2c_WriteByte(tmpAddr, 0xAD, (video_mode==NVP1108_PAL)?0x08:0x20);
		HDDVR_i2c_WriteByte(tmpAddr, 0xAE, (video_mode==NVP1108_PAL)?0x04:0x14);
		HDDVR_i2c_WriteByte(tmpAddr, 0x25, 0xDB);
		HDDVR_i2c_WriteByte(tmpAddr, 0x2B, 0x78);
		HDDVR_i2c_WriteByte(tmpAddr, 0x59, 0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x58, 0x13);
		if(NVP6124_VI_HDEX == channel_mode) {
			HDDVR_i2c_WriteByte(tmpAddr, 0x54, 0x20);
			HDDVR_i2c_WriteByte(tmpAddr, 0x55, 0x11);
			HDDVR_i2c_WriteByte(tmpAddr, 0x6B, 0x01);
		}
		HDDVR_i2c_WriteByte(tmpAddr, 0xC0, 0x16);
		if(AD_AHD_NVP6124B == HDAHD_SYID[0]) {
			HDDVR_i2c_WriteByte(tmpAddr, 0xC1, 0x13);
			HDDVR_i2c_WriteByte(tmpAddr, 0xC8, 0x04);
		}
		else
			HDDVR_i2c_WriteByte(tmpAddr, 0xC1, 0x14);
		HDDVR_i2c_WriteByte(tmpAddr, 0xD8, 0x0C);
		HDDVR_i2c_WriteByte(tmpAddr, 0xD9, 0x0E);
		HDDVR_i2c_WriteByte(tmpAddr, 0xDA, 0x12);
		HDDVR_i2c_WriteByte(tmpAddr, 0xDB, 0x14);
		HDDVR_i2c_WriteByte(tmpAddr, 0xDC, 0x1C);
		HDDVR_i2c_WriteByte(tmpAddr, 0xDD, 0x2C);
		HDDVR_i2c_WriteByte(tmpAddr, 0xDE, 0x34);
		I2C_UnLock();
		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x09);
		HDDVR_i2c_WriteByte(tmpAddr, 0x40+tmpChnl, 0x00);
		if(AD_AHD_NVP6124B == HDAHD_SYID[0])
			HDDVR_i2c_WriteByte(tmpAddr, 0x44, 0x00);
		else
			HDDVR_i2c_WriteByte(tmpAddr, 0x44, HDDVR_i2c_ReadByte(tmpAddr, 0x44)|(1<<tmpChnl));
		HDDVR_i2c_WriteByte(tmpAddr, 0x50+4*tmpChnl, (video_mode==NVP1108_PAL)?pn_value_720p_25[0]:pn_value_720p_30[0]);	//tmpChnl%41 960H
		HDDVR_i2c_WriteByte(tmpAddr, 0x51+4*tmpChnl, (video_mode==NVP1108_PAL)?pn_value_720p_25[1]:pn_value_720p_30[1]);
		HDDVR_i2c_WriteByte(tmpAddr, 0x52+4*tmpChnl, (video_mode==NVP1108_PAL)?pn_value_720p_25[2]:pn_value_720p_30[2]);
		HDDVR_i2c_WriteByte(tmpAddr, 0x53+4*tmpChnl, (video_mode==NVP1108_PAL)?pn_value_720p_25[3]:pn_value_720p_30[3]);
		//printf("tmpChnl %d setted to 720P %s\n", tmpChnl, (video_mode==NVP1108_PAL)?"PAL":"NTSC");
		if(AD_AHD_NVP6124B == HDAHD_SYID[0]) {
			HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x0A + (tmpChnl/2));
			HDDVR_i2c_WriteByte(tmpAddr, 0x74 + ((tmpChnl%2)*0x80), 0x02); //filter
		}
		I2C_UnLock();
		printf("tmpChnl %d setted to 720P %s\n", tmpChnl, (video_mode==NVP1108_PAL) ?"PAL":"NTSC");
		break;
	case NVP6124_VI_720P_5060:
		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x08+tmpChnl, (video_mode==NVP1108_PAL)?0x60:0x60);
		HDDVR_i2c_WriteByte(tmpAddr, 0x0c+tmpChnl, (video_mode==NVP1108_PAL)?0x08:0x08); //Bri Value
		HDDVR_i2c_WriteByte(tmpAddr, 0x10+tmpChnl, (video_mode==NVP1108_PAL)?0x88:0x88); //Con Value
		HDDVR_i2c_WriteByte(tmpAddr, 0x14+tmpChnl, (video_mode==NVP1108_PAL)?0x90:0x90);
		HDDVR_i2c_WriteByte(tmpAddr, 0x18+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x21+4*tmpChnl, 0x92);
		HDDVR_i2c_WriteByte(tmpAddr, 0x22+4*tmpChnl, 0x0A);
		HDDVR_i2c_WriteByte(tmpAddr, 0x23+4*tmpChnl, (video_mode==NVP1108_PAL)?0x43:0x43);
		HDDVR_i2c_WriteByte(tmpAddr, 0x30+tmpChnl, (video_mode==NVP1108_PAL)?0x12:0x12);
		HDDVR_i2c_WriteByte(tmpAddr, 0x3c+tmpChnl, (video_mode==NVP1108_PAL)?0x90:0x90); //Sat Value
		HDDVR_i2c_WriteByte(tmpAddr, 0x40+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0xFD); //Hue Value
		HDDVR_i2c_WriteByte(tmpAddr, 0x44+tmpChnl, (video_mode==NVP1108_PAL)?0x30:0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0x48+tmpChnl, (video_mode==NVP1108_PAL)?0x30:0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0x4c+tmpChnl, (video_mode==NVP1108_PAL)?0x04:0x04);
		HDDVR_i2c_WriteByte(tmpAddr, 0x50+tmpChnl, (video_mode==NVP1108_PAL)?0x04:0x04);
		nvp6124_set_fpc(tmpAddr, tmpChnl, video_mode);
		HDDVR_i2c_WriteByte(tmpAddr, 0x58+tmpChnl, (video_mode==NVP1108_PAL)?0xc0:0xb0);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5c+tmpChnl, (video_mode==NVP1108_PAL)?0x9e:0x9e);
		HDDVR_i2c_WriteByte(tmpAddr, 0x64+tmpChnl, (video_mode==NVP1108_PAL)?0xb1:0xb2);
		HDDVR_i2c_WriteByte(tmpAddr, 0x81+tmpChnl, (video_mode==NVP1108_PAL)?0x05:0x04);
		HDDVR_i2c_WriteByte(tmpAddr, 0x85+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x89+tmpChnl, (video_mode==NVP1108_PAL)?0x10:0x10);
		HDDVR_i2c_WriteByte(tmpAddr, tmpChnl+0x8E, (video_mode==NVP1108_PAL)?0x0b:0x09);
		HDDVR_i2c_WriteByte(tmpAddr, 0x93+tmpChnl, 0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x98+tmpChnl, (video_mode==NVP1108_PAL)?0x07:0x04);
		HDDVR_i2c_WriteByte(tmpAddr, 0xa0+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0xa4+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x01);
		I2C_UnLock();
		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(tmpAddr, 0x88+tmpChnl, (video_mode==NVP1108_PAL)?0x4d:0x4d);
		HDDVR_i2c_WriteByte(tmpAddr, 0x8c+tmpChnl, (video_mode==NVP1108_PAL)?0x84:0x84);
		if(AD_AHD_NVP6124B == HDAHD_SYID[0]) {
			//HDDVR_i2c_WriteByte(tmpAddr, 0x90+tmpChnl, (video_mode==NVP1108_PAL)?0x01:0x01);						 
			//HDDVR_i2c_WriteByte(tmpAddr, 0xA0+tmpChnl, (video_mode==NVP1108_PAL)?0x01:0x01);							 
		}
		HDDVR_i2c_WriteByte(tmpAddr, 0xd7, HDDVR_i2c_ReadByte(tmpAddr, 0xd7)|(1<<tmpChnl));
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x02);
		tmpValue = HDDVR_i2c_ReadByte(tmpAddr, 0x16+tmpChnl/2);
		HDDVR_i2c_WriteByte(tmpAddr, 0x16+tmpChnl/2, (tmpValue&(tmpChnl%2==0?0xF0:0x0F))|(0x05<<((tmpChnl%2)*4)));
		I2C_UnLock();
		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x05+tmpChnl);
		nvp61xx_write_table(tmpAddr, 0x00, NVP6124_Buf[5],254 );
		HDDVR_i2c_WriteByte(tmpAddr, 0x01, 0x0C);
		HDDVR_i2c_WriteByte(tmpAddr, 0x06, 0x40);
		HDDVR_i2c_WriteByte(tmpAddr, 0x1E, (video_mode==NVP1108_PAL)?0x00:0x01);
		HDDVR_i2c_WriteByte(tmpAddr, 0x35, (video_mode==NVP1108_PAL)?0x17:0x15);
		HDDVR_i2c_WriteByte(tmpAddr, 0x7A, (video_mode==NVP1108_PAL)?0x00:0x01);
		HDDVR_i2c_WriteByte(tmpAddr, 0x7B, (video_mode==NVP1108_PAL)?0x00:0x81);
		HDDVR_i2c_WriteByte(tmpAddr, 0xA1, (video_mode==NVP1108_PAL)?0x10:0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0xA2, (video_mode==NVP1108_PAL)?0x0E:0x0C);
		HDDVR_i2c_WriteByte(tmpAddr, 0xA3, (video_mode==NVP1108_PAL)?0x70:0x50);
		HDDVR_i2c_WriteByte(tmpAddr, 0xA8, (video_mode==NVP1108_PAL)?0x40:0x20);
		HDDVR_i2c_WriteByte(tmpAddr, 0xAC, (video_mode==NVP1108_PAL)?0x10:0x20);
		HDDVR_i2c_WriteByte(tmpAddr, 0xAD, (video_mode==NVP1108_PAL)?0x08:0x20);
		HDDVR_i2c_WriteByte(tmpAddr, 0xAE, (video_mode==NVP1108_PAL)?0x04:0x14);
		HDDVR_i2c_WriteByte(tmpAddr, 0x2B, 0x78);
		HDDVR_i2c_WriteByte(tmpAddr, 0x59, 0x01);
		HDDVR_i2c_WriteByte(tmpAddr, 0x24, (video_mode==NVP1108_PAL)?0x2A:0x1A);
		HDDVR_i2c_WriteByte(tmpAddr, 0x50, (video_mode==NVP1108_PAL)?0x84:0x86);
		HDDVR_i2c_WriteByte(tmpAddr, 0xBB, (video_mode==NVP1108_PAL)?0x00:0xE4);
		I2C_UnLock();
		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x09);
		HDDVR_i2c_WriteByte(tmpAddr, 0x40+tmpChnl, 0x00);
		if(AD_AHD_NVP6124B == HDAHD_SYID[0])
			HDDVR_i2c_WriteByte(tmpAddr, 0x44, 0x00);
		else
			HDDVR_i2c_WriteByte(tmpAddr, 0x44, HDDVR_i2c_ReadByte(tmpAddr, 0x44)|(1<<tmpChnl));
		HDDVR_i2c_WriteByte(tmpAddr, 0x50+4*tmpChnl, (video_mode==NVP1108_PAL)?pn_value_720p_50[0]:pn_value_720p_60[0]);	//tmpChnl%41 960H
		HDDVR_i2c_WriteByte(tmpAddr, 0x51+4*tmpChnl, (video_mode==NVP1108_PAL)?pn_value_720p_50[1]:pn_value_720p_60[1]);
		HDDVR_i2c_WriteByte(tmpAddr, 0x52+4*tmpChnl, (video_mode==NVP1108_PAL)?pn_value_720p_50[2]:pn_value_720p_60[2]);
		HDDVR_i2c_WriteByte(tmpAddr, 0x53+4*tmpChnl, (video_mode==NVP1108_PAL)?pn_value_720p_50[3]:pn_value_720p_60[3]);
		I2C_UnLock();
		printf("tmpChnl %d setted to 720P@RT %s\n", tmpChnl, (video_mode==NVP1108_PAL)?"PAL":"NTSC");
		break;
	case NVP6124_VI_1080P_2530:
		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x08+tmpChnl, (video_mode==NVP1108_PAL)?0x60:0x60);
		HDDVR_i2c_WriteByte(tmpAddr, 0x0c+tmpChnl, (video_mode==NVP1108_PAL)?0xF4:0xF4); //Bri Value
		HDDVR_i2c_WriteByte(tmpAddr, 0x10+tmpChnl, (video_mode==NVP1108_PAL)?0x90:0x90); //Con Value
		HDDVR_i2c_WriteByte(tmpAddr, 0x14+tmpChnl, (video_mode==NVP1108_PAL)?0x90:0x90);
		HDDVR_i2c_WriteByte(tmpAddr, 0x18+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x21+4*tmpChnl, 0x92);
		if(AD_AHD_NVP6124B == HDAHD_SYID[0])
			HDDVR_i2c_WriteByte(tmpAddr, 0x22+4*tmpChnl, 0x0B);
		else
			HDDVR_i2c_WriteByte(tmpAddr, 0x22+4*tmpChnl, 0x0A);
		HDDVR_i2c_WriteByte(tmpAddr, 0x23+4*tmpChnl, (video_mode==NVP1108_PAL)?0x43:0x43);
		HDDVR_i2c_WriteByte(tmpAddr, 0x30+tmpChnl, (video_mode==NVP1108_PAL)?0x12:0x12);
		HDDVR_i2c_WriteByte(tmpAddr, 0x3c+tmpChnl, (video_mode==NVP1108_PAL)?0x80:0x80); //Sat Value
		HDDVR_i2c_WriteByte(tmpAddr, 0x40+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00); //Hue Value
		HDDVR_i2c_WriteByte(tmpAddr, 0x44+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x48+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x4c+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x50+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
		nvp6124_set_fpc(tmpAddr, tmpChnl, video_mode);
		HDDVR_i2c_WriteByte(tmpAddr, 0x58+tmpChnl, (video_mode==NVP1108_PAL)?0x6a:0x49);
		HDDVR_i2c_WriteByte(tmpAddr, 0x5c+tmpChnl, (video_mode==NVP1108_PAL)?0x9e:0x9e);
		HDDVR_i2c_WriteByte(tmpAddr, 0x64+tmpChnl, (video_mode==NVP1108_PAL)?0xbf:0x8d);
		HDDVR_i2c_WriteByte(tmpAddr, 0x81+tmpChnl, (video_mode==NVP1108_PAL)?0x03:0x02);
		HDDVR_i2c_WriteByte(tmpAddr, 0x85+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x89+tmpChnl, (video_mode==NVP1108_PAL)?0x10:0x10);
		HDDVR_i2c_WriteByte(tmpAddr, tmpChnl+0x8E, (video_mode==NVP1108_PAL)?0x0a:0x09);
		HDDVR_i2c_WriteByte(tmpAddr, 0x93+tmpChnl, 0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0x98+tmpChnl, (video_mode==NVP1108_PAL)?0x07:0x04);
		HDDVR_i2c_WriteByte(tmpAddr, 0xa0+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);
		HDDVR_i2c_WriteByte(tmpAddr, 0xa4+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x01);
		I2C_UnLock();
		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x01);
		if(AD_AHD_NVP6124B == HDAHD_SYID[0]) {
			HDDVR_i2c_WriteByte(tmpAddr, 0x88+tmpChnl, (video_mode==NVP1108_PAL)?0x00:0x00);//NVP6124A NYH
			HDDVR_i2c_WriteByte(tmpAddr, 0x8c+tmpChnl, (video_mode==NVP1108_PAL)?0x42:0x42);
			//HDDVR_i2c_WriteByte(tmpAddr, 0x90+tmpChnl, (video_mode==NVP1108_PAL)?0x01:0x01);							 
			//HDDVR_i2c_WriteByte(tmpAddr, 0xA0+tmpChnl, (video_mode==NVP1108_PAL)?0x01:0x01);
		}
		else {
			HDDVR_i2c_WriteByte(tmpAddr, 0x88+tmpChnl, (video_mode==NVP1108_PAL)?0x4c:0x4c);
			HDDVR_i2c_WriteByte(tmpAddr, 0x8c+tmpChnl, (video_mode==NVP1108_PAL)?0x84:0x84);							 
		}
		HDDVR_i2c_WriteByte(tmpAddr, 0xd7, HDDVR_i2c_ReadByte(tmpAddr, 0xd7)|(1<<tmpChnl));
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x02);
		tmpValue = HDDVR_i2c_ReadByte(tmpAddr, 0x16+tmpChnl/2);
		HDDVR_i2c_WriteByte(tmpAddr, 0x16+tmpChnl/2, (tmpValue&(tmpChnl%2==0?0xF0:0x0F))|(0x05<<((tmpChnl%2)*4)));
		I2C_UnLock();
		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x05+tmpChnl);
		nvp61xx_write_table(tmpAddr, 0x00, NVP6124_Buf[5], 254 );
		HDDVR_i2c_WriteByte(tmpAddr, 0x01, 0x0C);
		HDDVR_i2c_WriteByte(tmpAddr, 0x06, 0x40);
		HDDVR_i2c_WriteByte(tmpAddr, 0x1E, (video_mode==NVP1108_PAL)?0x00:0x01);
		HDDVR_i2c_WriteByte(tmpAddr, 0x35, (video_mode==NVP1108_PAL)?0x17:0x15);
		HDDVR_i2c_WriteByte(tmpAddr, 0x7A, (video_mode==NVP1108_PAL)?0x00:0x01);
		HDDVR_i2c_WriteByte(tmpAddr, 0x7B, (video_mode==NVP1108_PAL)?0x00:0x81);
		HDDVR_i2c_WriteByte(tmpAddr, 0xA1, (video_mode==NVP1108_PAL)?0x10:0x30);
		HDDVR_i2c_WriteByte(tmpAddr, 0xA2, (video_mode==NVP1108_PAL)?0x0E:0x0C);
		HDDVR_i2c_WriteByte(tmpAddr, 0xA3, (video_mode==NVP1108_PAL)?0x70:0x50);
		HDDVR_i2c_WriteByte(tmpAddr, 0xA8, (video_mode==NVP1108_PAL)?0x40:0x20);
		HDDVR_i2c_WriteByte(tmpAddr, 0xAC, (video_mode==NVP1108_PAL)?0x10:0x20);
		HDDVR_i2c_WriteByte(tmpAddr, 0xAD, (video_mode==NVP1108_PAL)?0x08:0x20);
		HDDVR_i2c_WriteByte(tmpAddr, 0xAE, (video_mode==NVP1108_PAL)?0x04:0x14);
		HDDVR_i2c_WriteByte(tmpAddr, 0x2A, 0x72);
		HDDVR_i2c_WriteByte(tmpAddr, 0x2B, 0xA8);
		HDDVR_i2c_WriteByte(tmpAddr, 0x58, 0x13);
		HDDVR_i2c_WriteByte(tmpAddr, 0x59, 0x01);
		if(AD_AHD_NVP6124B == HDAHD_SYID[0]) {
			HDDVR_i2c_WriteByte(tmpAddr, 0xC0, 0x16); // AHD1.0 720P EQ
			HDDVR_i2c_WriteByte(tmpAddr, 0xC1, 0x13);
			HDDVR_i2c_WriteByte(tmpAddr, 0xC8, 0x04); // y slope 2's complement off
			HDDVR_i2c_WriteByte(tmpAddr, 0x47, 0xEE);
			HDDVR_i2c_WriteByte(tmpAddr, 0x50, 0xC4);
		}
		else {
			HDDVR_i2c_WriteByte(tmpAddr, 0xC0, 0x17);
			HDDVR_i2c_WriteByte(tmpAddr, 0xC1, 0x14);
		}
		HDDVR_i2c_WriteByte(tmpAddr, 0xD8, 0x10);
		HDDVR_i2c_WriteByte(tmpAddr, 0xD9, 0x1F);
		HDDVR_i2c_WriteByte(tmpAddr, 0xDA, 0x2B);
		HDDVR_i2c_WriteByte(tmpAddr, 0xDB, 0x7F);
		HDDVR_i2c_WriteByte(tmpAddr, 0xDC, 0xFF);
		HDDVR_i2c_WriteByte(tmpAddr, 0xDD, 0xFF);
		HDDVR_i2c_WriteByte(tmpAddr, 0xDE, 0xFF);

		HDDVR_i2c_WriteByte(tmpAddr, 0x24, (video_mode==NVP1108_PAL)?0x2A:0x1A);
		HDDVR_i2c_WriteByte(tmpAddr, 0x50, (video_mode==NVP1108_PAL)?0x84:0x86);
		HDDVR_i2c_WriteByte(tmpAddr, 0xBB, (video_mode==NVP1108_PAL)?0x00:0xE4);
		I2C_UnLock();
		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x09);
		HDDVR_i2c_WriteByte(tmpAddr, 0x40+tmpChnl, 0x00);
		if(AD_AHD_NVP6124B == HDAHD_SYID[0])
			HDDVR_i2c_WriteByte(tmpAddr, 0x44, 0x00);
		else
			HDDVR_i2c_WriteByte(tmpAddr, 0x44, HDDVR_i2c_ReadByte(tmpAddr, 0x44)|(1<<tmpChnl));
		HDDVR_i2c_WriteByte(tmpAddr, 0x50+4*tmpChnl, (video_mode==NVP1108_PAL)?pn_value_fhd_pal[0]:pn_value_fhd_nt[0]);
		HDDVR_i2c_WriteByte(tmpAddr, 0x51+4*tmpChnl, (video_mode==NVP1108_PAL)?pn_value_fhd_pal[1]:pn_value_fhd_nt[1]);
		HDDVR_i2c_WriteByte(tmpAddr, 0x52+4*tmpChnl, (video_mode==NVP1108_PAL)?pn_value_fhd_pal[2]:pn_value_fhd_nt[2]);
		HDDVR_i2c_WriteByte(tmpAddr, 0x53+4*tmpChnl, (video_mode==NVP1108_PAL)?pn_value_fhd_pal[3]:pn_value_fhd_nt[3]);
		if(AD_AHD_NVP6124B == HDAHD_SYID[0]) {
			HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x0A + (tmpChnl/2));
			HDDVR_i2c_WriteByte(tmpAddr, 0x74 + ((tmpChnl%2)*0x80), 0x02); //filter
			HDDVR_i2c_WriteByte(tmpAddr, 0x24 + ((tmpChnl%2)*0x80), 0x01);
		}
		I2C_UnLock();
		printf("tmpChnl %d setted to 1080P %s\n", tmpChnl, (video_mode==NVP1108_PAL)?"PAL":"NTSC");
		break;

	default:
		printf("tmpChnl%d wrong mode detected!!!\n", tmpChnl);
		break;
	}

	if(AD_AHD_NVP6124B == HDAHD_SYID[0]) {
		nvp6124b_syncchange(tmpAddr, tmpChnl, video_mode, channel_mode);

		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x09);
		HDDVR_i2c_WriteByte(tmpAddr, 0x64, 0x18);
		HDDVR_i2c_WriteByte(tmpAddr, 0x65, 0xC2);
		HDDVR_i2c_WriteByte(tmpAddr, 0x66, 0x01);
		HDDVR_i2c_WriteByte(tmpAddr, 0x67, 0x1E);
		HDDVR_i2c_WriteByte(tmpAddr, 0x68, 0x02);
		HDDVR_i2c_WriteByte(tmpAddr, 0x69, 0x64);
		HDDVR_i2c_WriteByte(tmpAddr, 0x6A, 0x60);
		HDDVR_i2c_WriteByte(tmpAddr, 0x6B, 0x3C);
	}

	nvp6124_acp_each_setting(tmpAddr, tmpChnl, video_mode, channel_mode);
}

void nvp6124_set_clockmode(int addr, int is297MHz)
{
	int tmpRealChip = 0;

	if(0 != HDAHD_ChipGetByAddr(addr, &tmpRealChip)) {
		return;
	}

	if(is297MHz != HDAHD_297M[tmpRealChip]) {
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x80, 0x40);

		if(is297MHz == 1) {
			HDDVR_i2c_WriteByte(addr, 0x82, 0x12);
		}
		else {
			HDDVR_i2c_WriteByte(addr, 0x82, 0x14);
		}
		HDDVR_i2c_WriteByte(addr, 0x83, 0x2C);
		HDDVR_i2c_WriteByte(addr, 0x80, 0x61);
		HDDVR_i2c_WriteByte(addr, 0x80, 0x60);

		HDAHD_297M[tmpRealChip] = is297MHz;

		printf("chip %d nvp6124_set_clockmode %d\n", addr, is297MHz);
	}
}

/*
chip:chip select[0,1,2,3];
portsel: port select[0,1];
portmode: port mode select[1mux,2mux,4mux]
chid:  channel id, 1mux[0,1,2,3], 2mux[0,1], 4mux[0]
*/
void nvp6114a_set_portmode(int addr, unsigned char portsel, unsigned char portmode, unsigned char chid)
{
	if(NVP6124_OUTMODE_2MUX_FHD == portmode) {
		nvp6124_set_clockmode(addr, 1);
	}
	else {
		nvp6124_set_clockmode(addr, 0);
	}

	switch(portmode) {
		case NVP6124_OUTMODE_1MUX_SD:
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
			HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
			HDDVR_i2c_WriteByte(addr, 0xC2+portsel*2, (chid<<4)|chid);
			HDDVR_i2c_WriteByte(addr, 0xC3+portsel*2, (chid<<4)|chid);
			HDDVR_i2c_WriteByte(addr, 0xC6, HDDVR_i2c_ReadByte(addr, 0xC4));
			HDDVR_i2c_WriteByte(addr, 0xC7, HDDVR_i2c_ReadByte(addr, 0xC5));
			HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x00);
			HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x36);
		break;
		case NVP6124_OUTMODE_1MUX_HD:
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
			HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
			HDDVR_i2c_WriteByte(addr, 0xC2+portsel*2, (chid<<4)|chid);
			HDDVR_i2c_WriteByte(addr, 0xC3+portsel*2, (chid<<4)|chid);
			HDDVR_i2c_WriteByte(addr, 0xC6, HDDVR_i2c_ReadByte(addr, 0xC4));
			HDDVR_i2c_WriteByte(addr, 0xC7, HDDVR_i2c_ReadByte(addr, 0xC5));
			HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x00);
			HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x46);
		break;
		case NVP6124_OUTMODE_1MUX_HD5060:
		case NVP6124_OUTMODE_1MUX_FHD:
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
			HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
			HDDVR_i2c_WriteByte(addr, 0xC2+portsel*2, (chid<<4)|chid);
			HDDVR_i2c_WriteByte(addr, 0xC3+portsel*2, (chid<<4)|chid);
			HDDVR_i2c_WriteByte(addr, 0xC6, HDDVR_i2c_ReadByte(addr, 0xC4));
			HDDVR_i2c_WriteByte(addr, 0xC7, HDDVR_i2c_ReadByte(addr, 0xC5));
			HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x00);
			HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x66);
			break;
		case NVP6124_OUTMODE_2MUX_SD:
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
			HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
			HDDVR_i2c_WriteByte(addr, 0xC2+portsel*2, chid==0?0x10:0x32);
			HDDVR_i2c_WriteByte(addr, 0xC3+portsel*2, chid==0?0x10:0x32);
			HDDVR_i2c_WriteByte(addr, 0xC6, HDDVR_i2c_ReadByte(addr, 0xC4));
			HDDVR_i2c_WriteByte(addr, 0xC7, HDDVR_i2c_ReadByte(addr, 0xC5));
			HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x22);
			HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x46);
			break;
		case NVP6124_OUTMODE_2MUX_HD_X:
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
			HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
			HDDVR_i2c_WriteByte(addr, 0xC2+portsel*2, chid==0?0x10:0x32);
			HDDVR_i2c_WriteByte(addr, 0xC3+portsel*2, chid==0?0x10:0x32);
			HDDVR_i2c_WriteByte(addr, 0xC6, HDDVR_i2c_ReadByte(addr, 0xC4));
			HDDVR_i2c_WriteByte(addr, 0xC7, HDDVR_i2c_ReadByte(addr, 0xC5));
			HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x11);
			HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x46);
			break;
		case NVP6124_OUTMODE_2MUX_FHD_X:
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
			HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
			HDDVR_i2c_WriteByte(addr, 0xC2+portsel*2, chid==0?0x10:0x32);
			HDDVR_i2c_WriteByte(addr, 0xC3+portsel*2, chid==0?0x10:0x32);
			HDDVR_i2c_WriteByte(addr, 0xC6, HDDVR_i2c_ReadByte(addr, 0xC4));
			HDDVR_i2c_WriteByte(addr, 0xC7, HDDVR_i2c_ReadByte(addr, 0xC5));
			HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x11);
			HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x66);
			break;
		case NVP6124_OUTMODE_2MUX_HD:
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
			HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
			HDDVR_i2c_WriteByte(addr, 0xC2+portsel*2, chid==0?0x10:0x32);
			HDDVR_i2c_WriteByte(addr, 0xC3+portsel*2, chid==0?0x10:0x32);
			HDDVR_i2c_WriteByte(addr, 0xC6, HDDVR_i2c_ReadByte(addr, 0xC4));
			HDDVR_i2c_WriteByte(addr, 0xC7, HDDVR_i2c_ReadByte(addr, 0xC5));
			HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x22);
			HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x66);
			break;
		case NVP6124_OUTMODE_4MUX_SD:
		case NVP6124_OUTMODE_4MUX_HD:
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
			HDDVR_i2c_WriteByte(addr, 0x56, 0x32);
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
			HDDVR_i2c_WriteByte(addr, 0xC2+portsel*2, 0x10);
			HDDVR_i2c_WriteByte(addr, 0xC3+portsel*2, 0x32);
			HDDVR_i2c_WriteByte(addr, 0xC6, HDDVR_i2c_ReadByte(addr, 0xC4));
			HDDVR_i2c_WriteByte(addr, 0xC7, HDDVR_i2c_ReadByte(addr, 0xC5));
			HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x88);
			HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x66);
			break;
		case NVP6124_OUTMODE_4MUX_HD_X:
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
			HDDVR_i2c_WriteByte(addr, 0x56, 0x32);
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
			HDDVR_i2c_WriteByte(addr, 0xC2+portsel*2, 0x10);
			HDDVR_i2c_WriteByte(addr, 0xC3+portsel*2, 0x32);
			HDDVR_i2c_WriteByte(addr, 0xC6, HDDVR_i2c_ReadByte(addr, 0xC4));
			HDDVR_i2c_WriteByte(addr, 0xC7, HDDVR_i2c_ReadByte(addr, 0xC5));
			HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x33);
			HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x66);
			break;
		case NVP6124_OUTMODE_2MUX_FHD:
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
			HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
			HDDVR_i2c_WriteByte(addr, 0x88+chid*2, 0x88);
			HDDVR_i2c_WriteByte(addr, 0x89+chid*2, 0x88);
			HDDVR_i2c_WriteByte(addr, 0x8C+chid*2, 0x42);
			HDDVR_i2c_WriteByte(addr, 0x8D+chid*2, 0x42);
			HDDVR_i2c_WriteByte(addr, 0xC2+portsel*2, chid==0?0x10:0x32);
			HDDVR_i2c_WriteByte(addr, 0xC3+portsel*2, chid==0?0x10:0x32);
			HDDVR_i2c_WriteByte(addr, 0xC6, HDDVR_i2c_ReadByte(addr, 0xC4));
			HDDVR_i2c_WriteByte(addr, 0xC7, HDDVR_i2c_ReadByte(addr, 0xC5));
			HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x22);
			HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x46);
			break;
		default:
			printf("portmode %d not supported yet\n", portmode);
			break;
  	}

	printf("nvp6114a_set_portmode portsel %d portmode %d setting\n", portsel, portmode);
}

void nvp6124_set_portmode(int addr, unsigned char portsel, unsigned char portmode, unsigned char chid)
{
	unsigned char tmp = 0;

	if((NVP6124_OUTMODE_2MUX_FHD == portmode) || (NVP6124_OUTMODE_4MUX_HD == portmode)) {
		nvp6124_set_clockmode(addr, 1);
	}
	else {
		nvp6124_set_clockmode(addr, 0);
	}

	switch(portmode) {
	case NVP6124_OUTMODE_1MUX_SD:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xC0+portsel*2, (chid<<4)|chid);
		HDDVR_i2c_WriteByte(addr, 0xC1+portsel*2, (chid<<4)|chid);
		tmp = HDDVR_i2c_ReadByte(addr, 0xC8+portsel/2) & (portsel%2?0x0F:0xF0);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel/2, tmp);
		tmp = HDDVR_i2c_ReadByte(addr, 0xCA);
		tmp |= ((0x01<<(portsel+4)) | (0x01<<(portsel)));
		HDDVR_i2c_WriteByte(addr, 0xCA, tmp);    //[3:0][7:4],
		HDDVR_i2c_WriteByte(addr, 0xCC+portsel, 0x36);    //
	break;
	case NVP6124_OUTMODE_1MUX_HD:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xC0+portsel*2, (chid<<4)|chid);
		HDDVR_i2c_WriteByte(addr, 0xC1+portsel*2, (chid<<4)|chid);
		tmp = HDDVR_i2c_ReadByte(addr, 0xC8+portsel/2) & (portsel%2?0x0F:0xF0);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel/2, tmp);
		tmp = HDDVR_i2c_ReadByte(addr, 0xCA);
		tmp |= ((0x01<<(portsel+4)) | (0x01<<(portsel)));
		HDDVR_i2c_WriteByte(addr, 0xCA, tmp);
		HDDVR_i2c_WriteByte(addr, 0xCC+portsel, 0x46);
	break;
	case NVP6124_OUTMODE_1MUX_HD5060:
	case NVP6124_OUTMODE_1MUX_FHD:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xC0+portsel*2, (chid<<4)|chid);
		HDDVR_i2c_WriteByte(addr, 0xC1+portsel*2, (chid<<4)|chid);
		tmp = HDDVR_i2c_ReadByte(addr, 0xC8+portsel/2) & (portsel%2?0x0F:0xF0);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel/2, tmp);
		tmp = HDDVR_i2c_ReadByte(addr, 0xCA);
		tmp |= ((0x01<<(portsel+4)) | (0x01<<(portsel)));
		HDDVR_i2c_WriteByte(addr, 0xCA, tmp);
		HDDVR_i2c_WriteByte(addr, 0xCC+portsel, 0x66);
		break;
	case NVP6124_OUTMODE_2MUX_SD:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xC0+portsel*2, chid==0?0x10:0x32);
		HDDVR_i2c_WriteByte(addr, 0xC1+portsel*2, chid==0?0x10:0x32);
		tmp = HDDVR_i2c_ReadByte(addr, 0xC8+portsel/2) & (portsel%2?0x0F:0xF0);
		tmp |= (portsel%2?0x20:0x02);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel/2, tmp);
		tmp = HDDVR_i2c_ReadByte(addr, 0xCA);
		tmp |= ((0x01<<(portsel+4)) | (0x01<<(portsel)));
		HDDVR_i2c_WriteByte(addr, 0xCA, tmp);
		HDDVR_i2c_WriteByte(addr, 0xCC+portsel, 0x46);
		break;
	case NVP6124_OUTMODE_2MUX_HD_X:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xC0+portsel*2, chid==0?0x10:0x32);
		HDDVR_i2c_WriteByte(addr, 0xC1+portsel*2, chid==0?0x10:0x32);
		tmp = HDDVR_i2c_ReadByte(addr, 0xC8+portsel/2) & (portsel%2?0x0F:0xF0);
		tmp |= (portsel%2?0x10:0x01);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel/2, tmp);
		tmp = HDDVR_i2c_ReadByte(addr, 0xCA);
		tmp |= ((0x01<<(portsel+4)) | (0x01<<(portsel)));
		HDDVR_i2c_WriteByte(addr, 0xCA, tmp);
		HDDVR_i2c_WriteByte(addr, 0xCC+portsel, 0x46);
		break;
	case NVP6124_OUTMODE_2MUX_HD:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xC0+portsel*2, chid==0?0x10:0x32);
		HDDVR_i2c_WriteByte(addr, 0xC1+portsel*2, chid==0?0x10:0x32);
		tmp = HDDVR_i2c_ReadByte(addr, 0xC8+portsel/2) & (portsel%2?0x0F:0xF0);
		tmp |= (portsel%2?0x20:0x02);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel/2, tmp);
		tmp = HDDVR_i2c_ReadByte(addr, 0xCA);
		tmp |= ((0x01<<(portsel+4)) | (0x01<<(portsel)));
		HDDVR_i2c_WriteByte(addr, 0xCA, tmp);
		HDDVR_i2c_WriteByte(addr, 0xCC+portsel, 0x66);
		break;
	case NVP6124_OUTMODE_2MUX_FHD_X:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xC0+portsel*2, chid==0?0x10:0x32);
		HDDVR_i2c_WriteByte(addr, 0xC1+portsel*2, chid==0?0x10:0x32);
		tmp = HDDVR_i2c_ReadByte(addr, 0xC8+portsel/2) & (portsel%2?0x0F:0xF0);
		tmp |= (portsel%2?0x10:0x01);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel/2, tmp);
		tmp = HDDVR_i2c_ReadByte(addr, 0xCA);
		tmp |= ((0x01<<(portsel+4)) | (0x01<<(portsel)));
		HDDVR_i2c_WriteByte(addr, 0xCA, tmp);
		HDDVR_i2c_WriteByte(addr, 0xCC+portsel, 0x66);
		break;
	case NVP6124_OUTMODE_4MUX_SD:
	case NVP6124_OUTMODE_4MUX_HD:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x32);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xC0+portsel*2, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xC1+portsel*2, 0x32);
		tmp = HDDVR_i2c_ReadByte(addr, 0xC8+portsel/2) & (portsel%2?0x0F:0xF0);
		tmp |= (portsel%2?0x80:0x08);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel/2, tmp);
		tmp = HDDVR_i2c_ReadByte(addr, 0xCA);
		tmp |= ((0x01<<(portsel+4)) | (0x01<<(portsel)));
		HDDVR_i2c_WriteByte(addr, 0xCA, tmp);
		HDDVR_i2c_WriteByte(addr, 0xCC+portsel, 0x66);
		break;
	case NVP6124_OUTMODE_4MUX_HD_X:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x32);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xC0+portsel*2, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xC1+portsel*2, 0x32);
		tmp = HDDVR_i2c_ReadByte(addr, 0xC8+portsel/2) & (portsel%2?0x0F:0xF0);
		tmp |= (portsel%2?0x30:0x03);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel/2, tmp);
		tmp = HDDVR_i2c_ReadByte(addr, 0xCA);
		tmp |= ((0x01<<(portsel+4)) | (0x01<<(portsel)));
		HDDVR_i2c_WriteByte(addr, 0xCA, tmp);
		HDDVR_i2c_WriteByte(addr, 0xCC+portsel, 0x66);
		break;
	case NVP6124_OUTMODE_2MUX_FHD:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x88+chid*2, 0x88);
		HDDVR_i2c_WriteByte(addr, 0x89+chid*2, 0x88);
		HDDVR_i2c_WriteByte(addr, 0x8C+chid*2, 0x42);
		HDDVR_i2c_WriteByte(addr, 0x8D+chid*2, 0x42);
		HDDVR_i2c_WriteByte(addr, 0xC0+portsel*2, chid==0?0x10:0x32);
		HDDVR_i2c_WriteByte(addr, 0xC1+portsel*2, chid==0?0x10:0x32);
		tmp = HDDVR_i2c_ReadByte(addr, 0xC8+portsel/2) & (portsel%2?0x0F:0xF0);
		tmp |= (portsel%2?0x20:0x02);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel/2, tmp);
		tmp = HDDVR_i2c_ReadByte(addr, 0xCA);
		tmp |= ((0x01<<(portsel+4)) | (0x01<<(portsel)));
		HDDVR_i2c_WriteByte(addr, 0xCA, tmp);
		HDDVR_i2c_WriteByte(addr, 0xCC+portsel, 0x46);
		break;
	default:
		printf("portmode %d not supported yet\n", portmode);
		break;
  	}

	printf("nvp6124_set_portmode portsel %d portmode %d setting\n", portsel, portmode);
}

/*
chip:chip select[0,1,2,3];
portsel: port select[0,1];
portmode: port mode select[1mux,2mux,4mux]
chid:  channel id, 1mux[0,1,2,3], 2mux[0,1], 4mux[0]
*/
void nvp6124b_set_portmode(int addr, unsigned char portsel, unsigned char portmode, unsigned char chid)
{
	unsigned char tmp=0, reg1=0, reg2=0;

	if(portsel>1)
		printf("nvp6124b_set_portmode portsel[%d] error!!!\n", portsel);

	switch(portmode) {
	case NVP6124_OUTMODE_1MUX_SD:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x90+portsel*2, 0x03);
		HDDVR_i2c_WriteByte(addr, 0x91+portsel*2, 0x03);
		HDDVR_i2c_WriteByte(addr, 0xA0+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xA1+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xC2-portsel*2, (chid<<4)|chid);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x86);
	break;
	case NVP6124_OUTMODE_1MUX_HD:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x90+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x91+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xA0+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xA1+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xC2-portsel*2, (chid<<4)|chid);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x10);
	break;
	case NVP6124_OUTMODE_1MUX_HD5060:
	case NVP6124_OUTMODE_1MUX_FHD:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x90+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x91+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xA0+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xA1+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xC2-portsel*2, (chid<<4)|chid);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x43);
		break;
	case NVP6124_OUTMODE_2MUX_SD:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x90+portsel*2, 0x03);
		HDDVR_i2c_WriteByte(addr, 0x91+portsel*2, 0x03);
		HDDVR_i2c_WriteByte(addr, 0xA0+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xA1+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xC2-portsel*2, chid==0?0x10:0x32);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x22);
		HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x10);
		break;
	case NVP6124_OUTMODE_2MUX_HD_X:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x90+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x91+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xA0+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xA1+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xC2-portsel*2, chid==0?0x10:0x32);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x11);
		HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x43);
		break;
	case NVP6124_OUTMODE_2MUX_FHD_X:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x90+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x91+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xA0+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xA1+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xC2-portsel*2, chid==0?0x10:0x32);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x11);
		HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x43);
		break;
	case NVP6124_OUTMODE_2MUX_HD:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x90+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x91+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xA0+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xA1+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xC2-portsel*2, chid==0?0x10:0x32);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x22);
		HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x43);
		break;
	case NVP6124_OUTMODE_4MUX_SD:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x32);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x90+portsel*2, 0x03);
		HDDVR_i2c_WriteByte(addr, 0x91+portsel*2, 0x03);
		HDDVR_i2c_WriteByte(addr, 0xA0+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xA1+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xC2-portsel*2, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xC3-portsel*2, 0x32);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x88);
		HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x43);
		break;
	case NVP6124_OUTMODE_4MUX_HD:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x32);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x90+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x91+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xA0+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xA1+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xC2-portsel*2, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xC3-portsel*2, 0x32);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x88);
		HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x43);
		break;
	case NVP6124_OUTMODE_4MUX_HD_X:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x32);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x90+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x91+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xA0+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xA1+portsel*2, 0x00);
		HDDVR_i2c_WriteByte(addr, 0xC2-portsel*2, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xC3-portsel*2, 0x32);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x33);
		HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x43);
		break;
	case NVP6124_OUTMODE_2MUX_FHD:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x90+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x91+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xA0+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xA1+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xC2-portsel*2, chid==0?0x10:0x32);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x22);
		HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x43);
		break;
	case NVP6124_OUTMODE_1MUX_HD_X:   //nvp6124b
	case NVP6124_OUTMODE_1MUX_FHD_X:
		break;
	case NVP6124_OUTMODE_4MUX_FHD_X:
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x32);
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x90+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x91+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xA0+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xA1+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xC2-portsel*2, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xC3-portsel*2, 0x32);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x33);
		HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x43);
		break;
	case NVP6124_OUTMODE_4MUX_MIX:  //HD,1920H,FHD-X 
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x32);
		tmp = HDDVR_i2c_ReadByte(addr, 0xFD);
		if(((tmp&0x0F) == 0x02) || ((tmp&0x0F) == 0x03))
			reg1 |= 0x08;
		else
			reg1 &= 0xF0;
		if((((tmp>>4)&0x0F) == 0x02) || (((tmp>>4)&0x0F) == 0x03))
			reg1 |= 0x80;
		else
			reg1 &= 0x0F;
		tmp = HDDVR_i2c_ReadByte(addr, 0xFE);
		if(((tmp&0x0F) == 0x02) || ((tmp&0x0F) == 0x03))
			reg2 |= 0x08;
		else
			reg2 &= 0xF0;
		if((((tmp>>4)&0x0F) == 0x02) || (((tmp>>4)&0x0F) == 0x03))
			reg2 |= 0x80;
		else
			reg2 &= 0x0F;
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x90+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0x91+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xA0+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xA1+portsel*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xC2-portsel*2, 0x10|reg1);
		HDDVR_i2c_WriteByte(addr, 0xC3-portsel*2, 0x32|reg2);
		HDDVR_i2c_WriteByte(addr, 0xC8+portsel, 0x88);
		HDDVR_i2c_WriteByte(addr, 0xCD+(portsel<<1), 0x43);
		break;
	default:
		printf("portmode %d not supported yet\n", portmode);
		break;
  	}
	printf("nvp6124b_set_portmode portsel %d portmode %d setting\n", portsel, portmode);
}

/*
nvp6124 has 4 BT656 output ports.
nvp6114a only has 2, so ch_seq[2]&ch_seq[3] are invalid in nvp6114a.
*/

void nvp6124_outport_1mux(int addr, int Chnl)
{
	int tmpRealChip;
	int tmpRealChnl;
	int tmpRealAddr;

	unsigned char tmpRead;

	if(0 != HDAHD_ChipGetMap(Chnl, &tmpRealChip, &tmpRealChnl, &tmpRealAddr)) {
		return HDVLOSS_ERROR;
	}

	I2C_InLock();

	HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
	HDDVR_i2c_WriteByte(addr, 0xC0+tmpRealChnl*2, (tmpRealChnl << 4) | (tmpRealChnl & 0x0F));
	HDDVR_i2c_WriteByte(addr, 0xC1+tmpRealChnl*2, (tmpRealChnl << 4) | (tmpRealChnl & 0x0F));
	HDDVR_i2c_WriteByte(addr, 0xC8, 0x00);
	HDDVR_i2c_WriteByte(addr, 0xC9, 0x00);
	HDDVR_i2c_WriteByte(addr, 0xCA, 0xFF);

	I2C_UnLock();

	printf("nvp6124_outport_1mux\n");
}

/*
portx_mode:
4bitport[7:4]->0~3:port0~3;
4bitvi[3:0]-> (NVP6124_VI_SD,NVP6124_VI_720P_2530, NVP6124_VI_1080P_2530)
*/
void nvp6124_outport_2mux(int addr, int port_numb, int port_mode)
{
	int tmpValue = 0;

	I2C_InLock();

	HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
	if(port_numb < 2) {
		HDDVR_i2c_WriteByte(addr, 0xC0+port_numb*2, 0x10);
		HDDVR_i2c_WriteByte(addr, 0xC1+port_numb*2, 0x10);
	}
	else {
		HDDVR_i2c_WriteByte(addr, 0xC0+port_numb*2, 0x32);
		HDDVR_i2c_WriteByte(addr, 0xC1+port_numb*2, 0x32);
	}

	tmpValue = (port_mode==NVP6124_VI_1080P_2530?1:2)<<((port_numb%2)*4);
	if(port_numb < 2) {
		HDDVR_i2c_WriteByte(addr, 0xC8, tmpValue);
	}
	else {
		HDDVR_i2c_WriteByte(addr, 0xC9, tmpValue);
	}

	tmpValue  = HDDVR_i2c_ReadByte(addr, 0xCA);
	tmpValue |= ((1<<port_numb)<< 4) | (1<<port_numb);
	HDDVR_i2c_WriteByte(addr, 0xCA, tmpValue);    //[3:0][7:4],

	if(port_mode == NVP6124_VI_SD) {
		HDDVR_i2c_WriteByte(addr, 0xCC+port_numb, 0x46);    //
	}
	else {
		HDDVR_i2c_WriteByte(addr, 0xCC+port_numb, 0x66);
	}

	I2C_UnLock();

  	printf("nvp6124_outport_2mux setting\n");
}

/*
port1_mode:
4bitport[7:4]->0~3:port0~3;
4bitvi[3:0]-> (NVP6124_VI_SD,NVP6124_VI_720P_2530)
*/
void nvp6124_outport_4mux(int addr, unsigned char port1_mode)
{
	int tmp=0;
	unsigned char p1_num,port1_vimode;

	p1_num = port1_mode>>0x04;
	port1_vimode = port1_mode&0x0F;

	I2C_InLock();

	HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
	HDDVR_i2c_WriteByte(addr, 0x55, 0x10);
	HDDVR_i2c_WriteByte(addr, 0x56, 0x32);  //reset channel id
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
	HDDVR_i2c_WriteByte(addr, 0xC0+p1_num*2, 0x10);
	HDDVR_i2c_WriteByte(addr, 0xC1+p1_num*2, 0x32);
	tmp = ((NVP6124_VI_720P_2530?3:8)<<(p1_num*4));
	HDDVR_i2c_WriteByte(addr, 0xC8, tmp&0xFF);
	HDDVR_i2c_WriteByte(addr, 0xC9, (tmp>>8)&0xFF);

	tmp=(1<<p1_num);
	HDDVR_i2c_WriteByte(addr, 0xCA, (tmp<<4|tmp));    //[3:0][7:4],

	HDDVR_i2c_WriteByte(addr, 0xCC+p1_num, 0x66);    //

	I2C_UnLock();

	printf("nvp6124_outport_4mux\n");
}

void nvp6114a_outport_1mux(int addr)
{
	I2C_InLock();

	HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
	//HDDVR_i2c_WriteByte(addr, 0xC0, 0x00);
	//HDDVR_i2c_WriteByte(addr, 0xC1, 0x00);
	HDDVR_i2c_WriteByte(addr, 0xC2, 0x00);
	HDDVR_i2c_WriteByte(addr, 0xC3, 0x00);
	HDDVR_i2c_WriteByte(addr, 0xC4, 0x11);
	HDDVR_i2c_WriteByte(addr, 0xC5, 0x11);
	HDDVR_i2c_WriteByte(addr, 0xC6, 0x11);
	HDDVR_i2c_WriteByte(addr, 0xC7, 0x11);
	HDDVR_i2c_WriteByte(addr, 0xC8, 0x00);
	HDDVR_i2c_WriteByte(addr, 0xC9, 0x00);
	HDDVR_i2c_WriteByte(addr, 0xCA, 0xFF);

	I2C_UnLock();

	printf("nvp6114a_outport_1mux_chseq\n");
}

/*
portx_mode:
4bitport[7:4]->0~1:port0~1;
4bitvi[3:0]-> (NVP6124_VI_SD,NVP6124_VI_720P_2530, NVP6124_VI_1080P_2530)
*/
void nvp6114a_outport_2mux(int addr, int port_numb, int port_mode)
{
	int tmpValue = 0;

	I2C_InLock();

	HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
#if (MAX_CAM_CH == 4) && defined(GPIO_PLAT_TYPE7) //Special Channel Order
	if(port_numb > 0) {
		HDDVR_i2c_WriteByte(addr, 0xC2+port_numb*2, 0x12);
		HDDVR_i2c_WriteByte(addr, 0xC3+port_numb*2, 0x12);
	}
	else {
		HDDVR_i2c_WriteByte(addr, 0xC2+port_numb*2, 0x03);
		HDDVR_i2c_WriteByte(addr, 0xC3+port_numb*2, 0x03);
	}
#elif (MAX_CAM_CH == 8) && defined(GPIO_PLAT_TYPE6) //Special Channel Order
	if(addr == 0x60) {
		if(port_numb > 0) {
			HDDVR_i2c_WriteByte(addr, 0xC2+port_numb*2, 0x23);
			HDDVR_i2c_WriteByte(addr, 0xC3+port_numb*2, 0x23);
		}
		else {
			HDDVR_i2c_WriteByte(addr, 0xC2+port_numb*2, 0x01);
			HDDVR_i2c_WriteByte(addr, 0xC3+port_numb*2, 0x01);
		}
	}
	else {
		if(port_numb > 0) {
			HDDVR_i2c_WriteByte(addr, 0xC2+port_numb*2, 0x01);
			HDDVR_i2c_WriteByte(addr, 0xC3+port_numb*2, 0x01);
		}
		else {
			HDDVR_i2c_WriteByte(addr, 0xC2+port_numb*2, 0x23);
			HDDVR_i2c_WriteByte(addr, 0xC3+port_numb*2, 0x23);
		}
	}
#else
	if(port_numb > 0) {
		HDDVR_i2c_WriteByte(addr, 0xC2+port_numb*2, 0x23);
		HDDVR_i2c_WriteByte(addr, 0xC3+port_numb*2, 0x23);
	}
	else {
		HDDVR_i2c_WriteByte(addr, 0xC2+port_numb*2, 0x01);
		HDDVR_i2c_WriteByte(addr, 0xC3+port_numb*2, 0x01);
	}
#endif

	HDDVR_i2c_WriteByte(addr, 0xC6, HDDVR_i2c_ReadByte(addr, 0xC4));
	HDDVR_i2c_WriteByte(addr, 0xC7, HDDVR_i2c_ReadByte(addr, 0xC5));

	tmpValue = ((port_mode==NVP6124_VI_1080P_2530)?1:2);
	if(port_numb == 0) {
		HDDVR_i2c_WriteByte(addr, 0xC8, (tmpValue<<4));
	}
	else {
		HDDVR_i2c_WriteByte(addr, 0xC9, (tmpValue<<4) | tmpValue);
	}

	HDDVR_i2c_WriteByte(addr, 0xCA, 0xFF);    //[3:0][7:4],

	HDDVR_i2c_WriteByte(addr, 0xCD+port_numb*2,
		(port_mode == NVP6124_VI_SD) ? 0x46 : 0x66);    //

#if (MAX_CAM_CH == 4) && defined(GPIO_PLAT_TYPE7) //Special Channel Order
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x00); //Cross 01 & 23 Channel
	HDDVR_i2c_WriteByte(addr, 0x55, 0x00);
	HDDVR_i2c_WriteByte(addr, 0x56, 0x11);
#endif
#if (MAX_CAM_CH == 8) && defined(GPIO_PLAT_TYPE6) //Special Channel Order
	if(addr == 0x60) {
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x55, 0x10);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x10);
	}
	else {
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
		HDDVR_i2c_WriteByte(addr, 0x55, 0x10);
		HDDVR_i2c_WriteByte(addr, 0x56, 0x01);
	}
#endif

	I2C_UnLock();

  	printf("nvp6114a_outport_2mux setting\n");
}


/*
port1_mode:
4bitport[7:4]->0~1:port0~1;
4bitvi[3:0]-> (NVP6124_VI_SD,NVP6124_VI_720P_2530)
*/
void nvp6114a_outport_4mux(int addr, unsigned char port1_mode)
{
	unsigned char tmp=0;
	unsigned char p1_num,port1_vimode;

	p1_num = port1_mode>>0x04;
	port1_vimode = port1_mode&0x0F;

	I2C_InLock();

	HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
	HDDVR_i2c_WriteByte(addr, 0x55, 0x10);
	HDDVR_i2c_WriteByte(addr, 0x56, 0x32);
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
	HDDVR_i2c_WriteByte(addr, 0xC2+p1_num*2, 0x10);
	HDDVR_i2c_WriteByte(addr, 0xC3+p1_num*2, 0x32);
	
	HDDVR_i2c_WriteByte(addr, 0xC6, HDDVR_i2c_ReadByte(addr, 0xC4));
	HDDVR_i2c_WriteByte(addr, 0xC7, HDDVR_i2c_ReadByte(addr, 0xC5));
	tmp = ((port1_vimode==NVP6124_VI_720P_2530?3:8)<<4)|((port1_vimode==NVP6124_VI_720P_2530?3:8));

	if(p1_num == 0) {
		HDDVR_i2c_WriteByte(addr, 0xC8, tmp);
		HDDVR_i2c_WriteByte(addr, 0xCA, 0x22);
	}
	else {
		HDDVR_i2c_WriteByte(addr, 0xC9, tmp);
		HDDVR_i2c_WriteByte(addr, 0xCA, 0x8C);
	}		
	HDDVR_i2c_WriteByte(addr, 0xCD+p1_num*2, 0x66);    //

	I2C_UnLock();

	printf("nvp6114A_outport_4mux setting\n");
}

#define NVP6124_CHNL_NUM_MAX (16)

int nvp6124_videoformat[NVP6124_CHNL_NUM_MAX]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
int nvp6124_channelmode[NVP6124_CHNL_NUM_MAX]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
int current_videoformat[NVP6124_CHNL_NUM_MAX]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
int current_videomode = 0; //
//#define _EQ_ADJ_COLOR_
volatile unsigned char stage_update[NVP6124_CHNL_NUM_MAX];
//int current_videomode[4] = 0;


static unsigned char ANALOG_EQ_1080P[8]	 = {0x03,0x03,0x53,0x73,0x73,0x73,0x73,0x73};
unsigned char ANALOG_EQ_1080P_BYPASS[8]  = {0x13,0x03,0x53,0x73,0x73,0x73,0x73,0x73};
unsigned char ANALOG_EQ_1080P_LPF30M[8]  = {0x11,0x01,0x51,0x71,0x71,0x71,0x71,0x71};
unsigned char DIGITAL_EQ_1080P[8] = {0x00,0x00,0x00,0x00,0x8B,0x8F,0x8F,0x8F};
#ifdef _EQ_ADJ_COLOR_
unsigned char BRI_EQ_1080P[8]    = {0xF4,0xF4,0xF4,0xF4,0xF8,0xF8,0xF8,0xF8};
unsigned char CON_EQ_1080P[8]    = {0x90,0x90,0x90,0x90,0x90,0x90,0x80,0x80};
unsigned char SAT_EQ_1080P[8]    = {0x80,0x80,0x80,0x78,0x78,0x78,0x78,0x78};
unsigned char BRI_EQ_720P[9]    = {0xF4,0xF4,0xF4,0xF4,0xF8,0xF8,0xF8,0xF8,0xF8};
unsigned char CON_EQ_720P[9]    = {0x90,0x90,0x90,0x90,0x88,0x88,0x84,0x90,0x90};
unsigned char SAT_EQ_720P[9]    = {0x84,0x84,0x84,0x80,0x80,0x80,0x80,0x84,0x84};
#endif
unsigned char SHARP_EQ_1080P[8]  = {0x90,0x90,0x99,0x99,0x99,0x99,0x99,0x90};
unsigned char PEAK_EQ_1080P[8]   = {0x00,0x10,0x00,0x00,0x00,0x00,0x50,0x00};
unsigned char CTI_EQ_1080P[8]    = {0x0A,0x0A,0x0A,0x0A,0x0A,0x0A,0x0A,0x0A};
unsigned char C_LOCK_EQ_1080P[8] = {0x92,0x92,0x92,0x92,0x92,0xA2,0xA2,0xA2};
unsigned char UGAIN_EQ_1080P[8]  = {0x00,0x00,0x00,0x00,0x10,0x10,0x20,0x00};
unsigned char VGAIN_EQ_1080P[8]  = {0x00,0x00,0x00,0x00,0x10,0x10,0x20,0x00};

unsigned char SHARP_EQ_720P[9]   =  {0x90,0x90,0x99,0x99,0x99,0x99,0x99,0x90,0x90};
unsigned char PEAK_EQ_720P[9]    =  {0x00,0x20,0x10,0x10,0x00,0x00,0x40,0x20,0x20};
unsigned char CTI_EQ_720P[9]     =  {0x0A,0x0A,0x0A,0x0A,0x0A,0x0A,0x0A,0x0A,0x0A};
unsigned char C_LOCK_EQ_720P[9]  =  {0x92,0x92,0x92,0x92,0x92,0x92,0xA2,0x92,0xA2};
unsigned char UGAIN_EQ_720P[9]   =  {0x30,0x30,0x30,0x30,0x30,0x30,0x40,0x30,0x30};
unsigned char VGAIN_EQ_720P[9]   =  {0x30,0x30,0x30,0x30,0x30,0x30,0x40,0x30,0x30};
unsigned char ANALOG_EQ_720P[9]  =  {0x13,0x03,0x53,0x73,0x73,0x73,0x73,0x03,0x13};
unsigned char DIGITAL_EQ_720P[9] =  {0x00,0x00,0x00,0x00,0x88,0x8F,0x8F,0x00,0x00};

unsigned char eq_stage[NVP6124_CHNL_NUM_MAX]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
#ifdef _EQ_ADJ_COLOR_
void nvp6124_brightness_eq(int addr, unsigned int ch, int ch_mode_status, unsigned int stage)
{
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
    if(ch_mode_status == NVP6124_VI_720P_2530)
		HDDVR_i2c_WriteByte(addr, (0x0c+(ch%4)),BRI_EQ_720P[stage]);
	else if(ch_mode_status == NVP6124_VI_1080P_2530)
		HDDVR_i2c_WriteByte(addr, (0x0c+(ch%4)),BRI_EQ_1080P[stage]);
}

void nvp6124_contrast_eq(int addr, unsigned int ch, int ch_mode_status, unsigned int stage)
{
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
    if(ch_mode_status == NVP6124_VI_720P_2530)
		HDDVR_i2c_WriteByte(addr, (0x10+(ch%4)),CON_EQ_720P[stage]);
	else if(ch_mode_status == NVP6124_VI_1080P_2530)
		HDDVR_i2c_WriteByte(addr, (0x10+(ch%4)),CON_EQ_1080P[stage]);
}

void nvp6124_saturation_eq(int addr, unsigned int ch, int ch_mode_status, unsigned int stage)
{
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
    if(ch_mode_status == NVP6124_VI_720P_2530)
		HDDVR_i2c_WriteByte(addr, (0x3C+(ch%4)),SAT_EQ_720P[stage]);
	else if(ch_mode_status == NVP6124_VI_1080P_2530)
		HDDVR_i2c_WriteByte(addr, (0x3C+(ch%4)),SAT_EQ_1080P[stage]);
}
#endif
void nvp6124_c_filter_eq(int addr, unsigned int ch, int ch_mode_status, unsigned int stage)
{
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
    if(ch_mode_status == NVP6124_VI_720P_2530)
		HDDVR_i2c_WriteByte(addr, (0x21+4*(ch%4)),C_LOCK_EQ_720P[stage]);
	else if(ch_mode_status == NVP6124_VI_1080P_2530)
		HDDVR_i2c_WriteByte(addr, (0x21+4*(ch%4)),C_LOCK_EQ_1080P[stage]);
}

void nvp6124_sharpness_eq(int addr, unsigned int ch, int ch_mode_status, unsigned int stage)
{
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
    if(ch_mode_status == NVP6124_VI_720P_2530)
		HDDVR_i2c_WriteByte(addr, (0x14+(ch%4)),SHARP_EQ_720P[stage]);
	else if(ch_mode_status == NVP6124_VI_1080P_2530)
		HDDVR_i2c_WriteByte(addr, (0x14+(ch%4)),SHARP_EQ_1080P[stage]);
}

void nvp6124_peaking_eq(int addr, unsigned int ch, int ch_mode_status, unsigned int stage)
{
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
    if(ch_mode_status == NVP6124_VI_720P_2530)
		HDDVR_i2c_WriteByte(addr, (0x18+(ch%4)),PEAK_EQ_720P[stage]);
	else if(ch_mode_status == NVP6124_VI_1080P_2530)
		HDDVR_i2c_WriteByte(addr, (0x18+(ch%4)),PEAK_EQ_1080P[stage]);
}

void nvp6124_ctigain_eq(int addr, unsigned int ch, int ch_mode_status, unsigned int stage)
{
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
    if(ch_mode_status == NVP6124_VI_720P_2530)
		HDDVR_i2c_WriteByte(addr, (0x38+(ch%4)),CTI_EQ_720P[stage]);
	else if(ch_mode_status == NVP6124_VI_1080P_2530)
		HDDVR_i2c_WriteByte(addr, (0x38+(ch%4)),CTI_EQ_1080P[stage]);
}

void nvp6124_ugain_eq(int addr, unsigned int ch, int ch_mode_status, unsigned int stage)
{
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
    if(ch_mode_status == NVP6124_VI_720P_2530)
		HDDVR_i2c_WriteByte(addr, (0x44+(ch%4)),UGAIN_EQ_720P[stage]);
	else if(ch_mode_status == NVP6124_VI_1080P_2530)
		HDDVR_i2c_WriteByte(addr, (0x44+(ch%4)),UGAIN_EQ_1080P[stage]);
}

void nvp6124_vgain_eq(int addr, unsigned int ch, int ch_mode_status, unsigned int stage)
{
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
    if(ch_mode_status == NVP6124_VI_720P_2530)
		HDDVR_i2c_WriteByte(addr, (0x48+(ch%4)),VGAIN_EQ_720P[stage]);
	else if(ch_mode_status == NVP6124_VI_1080P_2530)
		HDDVR_i2c_WriteByte(addr, (0x48+(ch%4)),VGAIN_EQ_1080P[stage]);
}

unsigned int get_ceq_stage(unsigned char resol, unsigned int acc_gain)
{
	unsigned char c_eq = 0;

	if(resol == NVP6124_VI_1080P_2530)
	{
		if	   (acc_gain >= 0x000 && acc_gain < 0x052 )   c_eq = 1;
		else if(acc_gain >= 0x052 && acc_gain < 0x089 )   c_eq = 2;
		else if(acc_gain >= 0x089 && acc_gain < 0x113 )   c_eq = 3;
		else if(acc_gain >= 0x113 && acc_gain < 0x25F )   c_eq = 4;
		else if(acc_gain >= 0x25F && acc_gain < 0x700 )   c_eq = 5;
		else if(acc_gain >= 0x700 && acc_gain < 0x7FF )   c_eq = 6;
		else											  c_eq = 7;  
	}
	else if(resol == NVP6124_VI_720P_2530)
	{
		if	   (acc_gain >= 0x000 && acc_gain < 0x055 )  c_eq = 1;
		else if(acc_gain >= 0x055 && acc_gain < 0x082 )  c_eq = 2;
		else if(acc_gain >= 0x082 && acc_gain < 0x0D8 )  c_eq = 3;
		else if(acc_gain >= 0x0D8 && acc_gain < 0x18F )  c_eq = 4;
		else if(acc_gain >= 0x18F && acc_gain < 0x700 )  c_eq = 5;
		else if(acc_gain >= 0x700 && acc_gain < 0x7FF )  c_eq = 6;
		else											 c_eq = 7;  
	}

	return c_eq;
}

unsigned int get_yeq_stage(unsigned char resol, unsigned int y_minus_slp)
{
	unsigned char y_eq = 0;

	if(AD_AHD_NVP6124B == HDAHD_SYID[0]) {
		if(resol == NVP6124_VI_1080P_2530) {
			if     (y_minus_slp >= 0x1D9)    y_eq = 1;
			else if(y_minus_slp >= 0x1AD)    y_eq = 2;
			else if(y_minus_slp >= 0x18C)    y_eq = 3;
			else if(y_minus_slp >= 0x16F)    y_eq = 4;
			else if(y_minus_slp >= 0x155)    y_eq = 5;
			else							 y_eq = 6;
		}
		else if((resol == NVP6124_VI_720P_2530) || (resol == NVP6124_VI_HDEX)){
			if     (y_minus_slp >= 0x18B)    y_eq = 1;
			else if(y_minus_slp >= 0x176)    y_eq = 2;
			else if(y_minus_slp >= 0x164)    y_eq = 3;
			else if(y_minus_slp >= 0x151)    y_eq = 4;
			else if(y_minus_slp >= 0x142)    y_eq = 5;
			else							 y_eq = 6;
		}
	}
	else {
		if(resol == NVP6124_VI_1080P_2530) {
			if     (y_minus_slp == 0x000)						    y_eq = 0;
			else if(y_minus_slp >  0x000 && y_minus_slp < 0x0E7)    y_eq = 1;
			else if(y_minus_slp >= 0x0E7 && y_minus_slp < 0x11A)    y_eq = 2;
			else if(y_minus_slp >= 0x11A && y_minus_slp < 0x151)    y_eq = 3;
			else if(y_minus_slp >= 0x151 && y_minus_slp < 0x181)    y_eq = 4;
			else if(y_minus_slp >= 0x181 && y_minus_slp < 0x200)    y_eq = 5;
			else													y_eq = 6;
		}
		else if(resol == NVP6124_VI_720P_2530) {
			if     (y_minus_slp == 0x000)                           y_eq = 0;
			else if(y_minus_slp >  0x000 && y_minus_slp < 0x104)    y_eq = 1;
			else if(y_minus_slp >= 0x104 && y_minus_slp < 0x125)    y_eq = 2;
			else if(y_minus_slp >= 0x125 && y_minus_slp < 0x14C)    y_eq = 3;
			else if(y_minus_slp >= 0x14C && y_minus_slp < 0x16F)    y_eq = 4;
			else if(y_minus_slp >= 0x16F && y_minus_slp < 0x185)    y_eq = 5;
			else													y_eq = 6;
		}
	}

	return y_eq;

}

unsigned int is_bypass_mode(unsigned int agc_val, unsigned int y_ref2_status)
{
	if(((agc_val < 0x20)  && (y_ref2_status >= 0x176))			||
	   ((agc_val >= 0x20) && (y_ref2_status >= 0x1B0)))
			return 1;
	return 0;
}



#define ACP_CLR_CNT			1
#define ACP_SET_CNT			(ACP_CLR_CNT+1)
#define ACP_READ_START_CNT	(ACP_SET_CNT+3)
#define RETRY_CNT			5
#define COMPARE_NUM			3
#define COUNT_NUM			4
#define LOOP_BUF_SIZE		20

unsigned char check_c_stage[16][LOOP_BUF_SIZE];
unsigned char check_y_stage[16][LOOP_BUF_SIZE];
static unsigned char check_sarv0_stage[16][LOOP_BUF_SIZE];
static unsigned char check_sarv3_stage[16][LOOP_BUF_SIZE];
unsigned char acp_val[16][LOOP_BUF_SIZE];
unsigned char acp_ptn[16][LOOP_BUF_SIZE];
static unsigned char pre_vidmode[16];
volatile unsigned char vidmode_back[NVP6124_CHNL_NUM_MAX];
volatile unsigned char video_on[NVP6124_CHNL_NUM_MAX];
unsigned char eq_loop_cnt[16];
unsigned char loop_cnt[16];
unsigned char bypass_flag_retry[16];
unsigned char ystage_flag_retry[16];
unsigned char cstage_flag_retry[16];
unsigned char one_setting[16]={0,};
unsigned char bypass_flag[16]={0,};
unsigned char acp_isp_wr_en[16]={0,};

static volatile unsigned int min_sarv0[4]={0xFFFF,};
static volatile unsigned int max_sarv0[4]={0x0000,};
static volatile unsigned int min_sarv3[4]={0xFFFF,};
static volatile unsigned int max_sarv3[4]={0x0000,};
static volatile unsigned int min_ystage[4]={0xFFFF,};
static volatile unsigned int max_ystage[4]={0x0000,};

static void set_color_burst_threshold(int addr, int chnl, int ch_mode_status, unsigned char eq_stage, unsigned char flag)
{
	if(flag == 1) {
		if((ch_mode_status == NVP6124_VI_720P_2530)
		|| (ch_mode_status == NVP6124_VI_HDEX)) {
		}
		else {
			if((eq_stage == 6) || (eq_stage == 5)) {
				HDDVR_i2c_WriteByte(addr, 0xFF,0x00);
				HDDVR_i2c_WriteByte(addr, 0x22+4*(chnl%4), 0x0B);
				HDDVR_i2c_WriteByte(addr, 0xFF,0x05+1*(chnl%4));
				HDDVR_i2c_WriteByte(addr, 0x27, 0x30);
			}
		}
	}
	else {
		HDDVR_i2c_WriteByte(addr, 0xFF,0x00);
		HDDVR_i2c_WriteByte(addr, 0x22+4*(chnl%4), 0x0A);
		HDDVR_i2c_WriteByte(addr, 0xFF,0x05+1*(chnl%4));
		HDDVR_i2c_WriteByte(addr, 0x27, 0x57);
	}
}

static void set_analog_stage(int addr, int chnl, int ch_mode_status, unsigned char stage)
{
	HDDVR_i2c_WriteByte(addr, 0xFF,0x05+chnl%4);
	if(ch_mode_status == NVP6124_VI_1080P_2530) {
		printf("ANALOG EQ SETUP\n");
		HDDVR_i2c_WriteByte(addr, 0x01, 0x0C);
		HDDVR_i2c_WriteByte(addr, 0x58, ANALOG_EQ_1080P[stage]);
		HDDVR_i2c_WriteByte(addr, 0x59, 0x01);
	}
	else {
		HDDVR_i2c_WriteByte(addr, 0x01, 0x0E);
		HDDVR_i2c_WriteByte(addr, 0x58, ANALOG_EQ_720P[stage]);
		HDDVR_i2c_WriteByte(addr, 0x59, 0x00);
	}
}

static void set_iir_stage(int addr, int chnl, int ch_mode_status, unsigned char stage)
{
	if(chnl == 0)
		printf("stage = %x, mode = %x\n",stage, ch_mode_status);
	if(ch_mode_status == NVP6124_VI_1080P_2530) {
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x09);
		switch(stage) {
			case 0 :
				HDDVR_i2c_WriteByte(addr, 0x80+0x20*(chnl%4),0x00);
				HDDVR_i2c_WriteByte(addr, 0x81+0x20*(chnl%4),0x00);
				HDDVR_i2c_WriteByte(addr, 0x82+0x20*(chnl%4),0x00);
			break;
			case 1 :
				HDDVR_i2c_WriteByte(addr, 0x80+0x20*(chnl%4),0x00);
				HDDVR_i2c_WriteByte(addr, 0x81+0x20*(chnl%4),0x00);
				HDDVR_i2c_WriteByte(addr, 0x82+0x20*(chnl%4),0x00);
			break;
			case 2 :
				HDDVR_i2c_WriteByte(addr, 0x84+0x20*(chnl%4),0x01);
				HDDVR_i2c_WriteByte(addr, 0x85+0x20*(chnl%4),0x00);
				HDDVR_i2c_WriteByte(addr, 0x86+0x20*(chnl%4),0x23);
				HDDVR_i2c_WriteByte(addr, 0x87+0x20*(chnl%4),0xC3);
				HDDVR_i2c_WriteByte(addr, 0x88+0x20*(chnl%4),0xF6);
				HDDVR_i2c_WriteByte(addr, 0x89+0x20*(chnl%4),0x34);
				HDDVR_i2c_WriteByte(addr, 0x8A+0x20*(chnl%4),0xCD);
				HDDVR_i2c_WriteByte(addr, 0x80+0x20*(chnl%4),0xA0);
				HDDVR_i2c_WriteByte(addr, 0x81+0x20*(chnl%4),0x00);
				HDDVR_i2c_WriteByte(addr, 0x82+0x20*(chnl%4),0x00);
			break;
			case 3 :
				HDDVR_i2c_WriteByte(addr, 0x80+0x20*(chnl%4),0xA2);
				HDDVR_i2c_WriteByte(addr, 0x81+0x20*(chnl%4),0x00);
				HDDVR_i2c_WriteByte(addr, 0x82+0x20*(chnl%4),0x00);
			break;
			case 4 :
				HDDVR_i2c_WriteByte(addr, 0x80+0x20*(chnl%4),0xA3);
				HDDVR_i2c_WriteByte(addr, 0x81+0x20*(chnl%4),0x00);
				HDDVR_i2c_WriteByte(addr, 0x82+0x20*(chnl%4),0x00);
			break;
			case 5 :
				HDDVR_i2c_WriteByte(addr, 0x80+0x20*(chnl%4),0xA4);
				HDDVR_i2c_WriteByte(addr, 0x81+0x20*(chnl%4),0x00);
				HDDVR_i2c_WriteByte(addr, 0x82+0x20*(chnl%4),0x00);
			break;
			case 6 :
				HDDVR_i2c_WriteByte(addr, 0x80+0x20*(chnl%4),0xA5);
				HDDVR_i2c_WriteByte(addr, 0x8c+0x20*(chnl%4),0x01);
				HDDVR_i2c_WriteByte(addr, 0x8d+0x20*(chnl%4),0x28);
				HDDVR_i2c_WriteByte(addr, 0x8E + 0x20*(chnl%4),0x0A);
				HDDVR_i2c_WriteByte(addr, 0x8F+0x20*(chnl%4),0xCF);
				HDDVR_i2c_WriteByte(addr, 0x90+0x20*(chnl%4),0xF8);
				HDDVR_i2c_WriteByte(addr, 0x91+0x20*(chnl%4),0x0F);
				HDDVR_i2c_WriteByte(addr, 0x92+0x20*(chnl%4),0xD7);
				HDDVR_i2c_WriteByte(addr, 0x81+0x20*(chnl%4),0xA0);
				HDDVR_i2c_WriteByte(addr, 0x82+0x20*(chnl%4),0x00);
			break;
			case 7 :
				HDDVR_i2c_WriteByte(addr, 0x80+0x20*(chnl%4),0x00);
				HDDVR_i2c_WriteByte(addr, 0x81+0x20*(chnl%4),0x00);
				HDDVR_i2c_WriteByte(addr, 0x82+0x20*(chnl%4),0x00);
			break;
		}
	}
	else if(ch_mode_status == NVP6124_VI_720P_2530 || ch_mode_status == NVP6124_VI_HDEX) {
		HDDVR_i2c_WriteByte(addr, 0xFF, 0x09);
		switch(stage) {
			case 0 :
				HDDVR_i2c_WriteByte(addr, 0x80+0x20*(chnl%4),0x00);
				HDDVR_i2c_WriteByte(addr, 0x81+0x20*(chnl%4),0x00);
			break;
			case 1 :
				HDDVR_i2c_WriteByte(addr, 0x80+0x20*(chnl%4),0x00);
				HDDVR_i2c_WriteByte(addr, 0x81+0x20*(chnl%4),0x00);
			break;
			case 2 :
				HDDVR_i2c_WriteByte(addr, 0x80+0x20*(chnl%4),0xA1);
				HDDVR_i2c_WriteByte(addr, 0x81+0x20*(chnl%4),0x00);
			break;
			case 3 :
				HDDVR_i2c_WriteByte(addr, 0x80+0x20*(chnl%4),0xA2);
				HDDVR_i2c_WriteByte(addr, 0x81+0x20*(chnl%4),0x00);
			break;
			case 4 :
				HDDVR_i2c_WriteByte(addr, 0x80+0x20*(chnl%4),0xA2);
				HDDVR_i2c_WriteByte(addr, 0x81+0x20*(chnl%4),0xA2);
			break;
			case 5 :
				HDDVR_i2c_WriteByte(addr, 0x80+0x20*(chnl%4),0xA2);
				HDDVR_i2c_WriteByte(addr, 0x81+0x20*(chnl%4),0xA2);
			break;
			case 6 :
				HDDVR_i2c_WriteByte(addr, 0x80+0x20*(chnl%4),0xA3);
				HDDVR_i2c_WriteByte(addr, 0x81+0x20*(chnl%4),0xA1);
			break;
			case 7 :
				HDDVR_i2c_WriteByte(addr, 0x80+0x20*(chnl%4),0xA3);
				HDDVR_i2c_WriteByte(addr, 0x81+0x20*(chnl%4),0xA1);
			break;
		}
	}
	else {
	}
}


static unsigned char get_sarv0_stage(unsigned char resol, unsigned int sarv0)
{
	unsigned char sarv0_stg = 0;

	if(resol == NVP6124_VI_1080P_2530) {
		if	   (sarv0 <= 0x0F) sarv0_stg = 1;
		else if(sarv0 <= 0x15) sarv0_stg = 2;
		else if(sarv0 <= 0x1D) sarv0_stg = 3;
		else if(sarv0 <= 0x24) sarv0_stg = 4;
		else if(sarv0 <= 0x2B) sarv0_stg = 5;
		else				   sarv0_stg = 6;
	}
	else if((resol == NVP6124_VI_720P_2530) || (resol == NVP6124_VI_HDEX)) {
		if	   (sarv0 <= 0x0E) sarv0_stg = 1;
		else if(sarv0 <= 0x0F) sarv0_stg = 2;
		else if(sarv0 <= 0x11) sarv0_stg = 3;
		else if(sarv0 <= 0x14) sarv0_stg = 4;
		else if(sarv0 <= 0x18) sarv0_stg = 5;
		else				  sarv0_stg = 6;
	}

	return sarv0_stg;
}

static unsigned char get_sarv3_stage(unsigned int resol, unsigned int sarv3)
{
	unsigned char sarv3_stg = 0;

	if(resol == NVP6124_VI_1080P_2530) {
		if	   (sarv3 <= 0x3EC) sarv3_stg = 1;
		else if(sarv3 <= 0x55F) sarv3_stg = 2;
		else if(sarv3 <= 0x73F) sarv3_stg = 3;
		else if(sarv3 <= 0x92C) sarv3_stg = 4;
		else if(sarv3 <= 0xACD) sarv3_stg = 5;
		else					sarv3_stg = 6;
	}
	else if((resol == NVP6124_VI_720P_2530) || (resol == NVP6124_VI_HDEX)) {
		if	   (sarv3 <= 0x396) sarv3_stg = 1;
		else if(sarv3 <= 0x3EE) sarv3_stg = 2;
		else if(sarv3 <= 0x478) sarv3_stg = 3;
		else if(sarv3 <= 0x537) sarv3_stg = 4;
		else if(sarv3 <= 0x614) sarv3_stg = 5;
		else				    sarv3_stg = 6;
	}

	return sarv3_stg;
}

unsigned char read_acp_status(int addr, int chnl)
{
	unsigned char val;

	HDDVR_i2c_WriteByte(addr, 0xFF, 0x03+((chnl%4)/2));
	if(AD_AHD_NVP6124B == HDAHD_SYID[0])
		val = HDDVR_i2c_ReadByte( addr, 0x50+((chnl%2)*0x80));
	else
		val = HDDVR_i2c_ReadByte(addr, 0x78+((chnl%2)*0x80));

	return val;
}

unsigned char read_acp_pattern(int addr, int chnl)
{
	unsigned char val;

	HDDVR_i2c_WriteByte(addr, 0xFF, 0x03+((chnl%4)/2));
	if(AD_AHD_NVP6124B == HDAHD_SYID[0])
		val = HDDVR_i2c_ReadByte(addr,0x50+((chnl%2)*0x80)+1);
	else
		val = HDDVR_i2c_ReadByte(addr,0x78+((chnl%2)*0x80)+1);
	val = (val >> 2) & 0x03;

	return val;
}

static int check_stage(unsigned char chn, unsigned char ystage, unsigned char sarv0, unsigned char sarv3)
{
	if((ystage == 0xFF) || (sarv0 == 0xFF) || (sarv3== 0xFF))
		return -1;
	else {
		if(abs(ystage-sarv0) > 1)
			return -1;
		if(abs(ystage-sarv3) > 1)
			return -1;
	}

	return 1;
}

void nvp6124_sw_reset(int addr, int chnl)
{
	unsigned char tmp;

	HDDVR_i2c_WriteByte(addr, 0xFF, 0x01);
	tmp = HDDVR_i2c_ReadByte( addr, 0x97) & 0x0F;
	tmp = tmp & (~(1<<(chnl%4)));
	HDDVR_i2c_WriteByte(addr, 0x97, tmp);
	HDDVR_i2c_WriteByte(addr, 0x97, 0x0F);

	printf("software reset OK\n");
}

void lossfakechannel(int addr, int chnl, unsigned char bypassflag)
{
	unsigned char tmp;

	HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
	tmp = HDDVR_i2c_ReadByte(addr, 0x7A+((chnl%2)<2?0x00:0x01));
	if(chnl%2 == 0)
		tmp = tmp & 0xF0;
	else
		tmp = tmp & 0x0F;

	if(bypassflag)
		tmp = tmp | (0x0F << (chnl%2)*4);
	else
		tmp = tmp | (0x01 << (chnl%2)*4);

	HDDVR_i2c_WriteByte(addr, 0x7A+((chnl%2)<2?0x00:0x01),tmp);
}

void bubble_sort(unsigned char *buf ,unsigned char len)
{
	int i,j,tmp;

	for(i = 0; i < len; i++) {
		for(j = 0; j < len - 1 ; j++) {
			if(buf[j] > buf[j+1]) {
				tmp = buf[j];
				buf[j] = buf[j+1];
				buf[j+1] = tmp;
			}
		}
	}
}

unsigned char calc_stage_gap(unsigned char *buf)
{
	unsigned char cnt,zero_cnt=0;
	unsigned char tmpbuf[LOOP_BUF_SIZE];

	memcpy(tmpbuf,buf,LOOP_BUF_SIZE);

	bubble_sort(tmpbuf, LOOP_BUF_SIZE);

	for(cnt = 0; cnt < LOOP_BUF_SIZE; cnt++) {
		if(tmpbuf[cnt] == 0) zero_cnt++;
	}

	return(abs(tmpbuf[LOOP_BUF_SIZE-1] - tmpbuf[zero_cnt]));
}

unsigned char calc_arr_mean(unsigned char *buf)
{
	unsigned char cnt,tmp=0,zero_cnt=0;
	unsigned char tmpbuf[LOOP_BUF_SIZE];

	memcpy(tmpbuf,buf,LOOP_BUF_SIZE);

	bubble_sort(tmpbuf, LOOP_BUF_SIZE);


	for(cnt = 0; cnt < LOOP_BUF_SIZE; cnt++) {
		if(tmpbuf[cnt] == 0) zero_cnt++;

		tmp = tmp + tmpbuf[cnt];
	}
	tmp = abs( tmp / (LOOP_BUF_SIZE-zero_cnt));

	for(cnt = 0; cnt <LOOP_BUF_SIZE; cnt++)
		printf("cnt[%d]  origin = %x   sort= %x\n",cnt, buf[cnt], tmpbuf[cnt]);
	printf("mean value ========================== %d\n",tmp);

	return tmp;
}

unsigned char compare_arr(unsigned char cur_ptr, unsigned char *buf)
{
	unsigned char start_ptr;

	if(cur_ptr == 1)		start_ptr = LOOP_BUF_SIZE - 1;
	else if(cur_ptr == 0)	start_ptr = LOOP_BUF_SIZE - 2;
	else					start_ptr = cur_ptr - 2;

	if((buf[start_ptr] == buf[(start_ptr+1)%LOOP_BUF_SIZE])						&&
       (buf[(start_ptr+1)%LOOP_BUF_SIZE] == buf[(start_ptr+2)%LOOP_BUF_SIZE]))
		return buf[start_ptr];
	else
		return 0xFF;
}

unsigned char decide_noptn_stage(unsigned char agcval)
{
	unsigned char stage;

	if	   (agcval <= 0x18)	stage = 1;
	else if(agcval <= 0x1A)	stage = 2;
	else if(agcval <= 0x1C)	stage = 3;
	else if(agcval <= 0x1E)	stage = 4;
	else if(agcval <= 0x20)	stage = 5;
	else					stage = 6;

	return stage;
}

void init_eq_stage(int addr, int chnl, int ch_mode_status)
{
	unsigned char default_stage=0;

	int tmpRealChip = 0;

	if(0 != HDAHD_ChipGetByAddr(addr, &tmpRealChip)) {
		return;
	}

	if((ch_mode_status == NVP6124_VI_720P_2530)
	|| (ch_mode_status == NVP6124_VI_HDEX)) {
		HDDVR_i2c_WriteByte(addr, 0xFF,0x05+chnl%4);
		HDDVR_i2c_WriteByte(addr, 0x58, ANALOG_EQ_720P[default_stage]);
		HDDVR_i2c_WriteByte(addr, 0xFF,((chnl%4)<2)?0x0A:0x0B);
		HDDVR_i2c_WriteByte(addr, (chnl%2==0)?0x3B:0xBB, DIGITAL_EQ_720P[default_stage]);
	}
	else{
		HDDVR_i2c_WriteByte(addr, 0xFF,0x05+chnl%4);
		if(AD_AHD_NVP6124B == HDAHD_SYID[0])
			HDDVR_i2c_WriteByte(addr, 0x58, ANALOG_EQ_1080P[default_stage]);
		else{
			if(rev_id[tmpRealChip] == 0x20)
				HDDVR_i2c_WriteByte(addr, 0x58, ANALOG_EQ_1080P_BYPASS[default_stage]);
			else
				HDDVR_i2c_WriteByte(addr, 0x58, ANALOG_EQ_1080P_LPF30M[default_stage]);
		}
		HDDVR_i2c_WriteByte(addr, 0xFF,((chnl%4)<2)?0x0A:0x0B);
		HDDVR_i2c_WriteByte(addr, (chnl%2==0)?0x3B:0xBB, DIGITAL_EQ_1080P[default_stage]);
	}

	memset(check_y_stage[chnl],0x00,sizeof(check_y_stage[chnl]));
	memset(check_sarv0_stage[chnl],0x00,sizeof(check_sarv0_stage[chnl]));
	memset(check_sarv3_stage[chnl],0x00,sizeof(check_sarv3_stage[chnl]));
}

void nvp6124_set_equalizer(int addr, int chn, int ch_vloss, int ch_mode_status)
{
	unsigned char i,tmp_acp_val,tmp_acp_ptn,tmp_y_stage,tmp_c_stage;
	unsigned char vidmode[NVP6124_CHNL_NUM_MAX];
	unsigned char agc_lock;
	unsigned char  agc_val[NVP6124_CHNL_NUM_MAX];
	unsigned int  acc_gain_sts[NVP6124_CHNL_NUM_MAX];
	unsigned int  y_ref_status[NVP6124_CHNL_NUM_MAX];
	unsigned int  y_ref2_status[NVP6124_CHNL_NUM_MAX];
	unsigned char stage_gap;

	int ch = chn;

	int tmpRealChip = 0;
	if(0 != HDAHD_ChipGetByAddr(addr, &tmpRealChip)) {
		return;
	}

	I2C_InLock();

	HDDVR_i2c_WriteByte(addr, 0xFF, 0x09);
	HDDVR_i2c_WriteByte(addr, 0x61, chn);
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
	agc_val[ch] = HDDVR_i2c_ReadByte(addr, 0xF7);
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
	vidmode[ch] = HDDVR_i2c_ReadByte(addr, 0xD0+chn);

	agc_lock = HDDVR_i2c_ReadByte(addr, 0xEC);

	I2C_UnLock();

	I2C_InLock();

	HDDVR_i2c_WriteByte(addr, 0xFF, 0x05 + chn);
	acc_gain_sts[ch] = HDDVR_i2c_ReadByte(addr, 0xE2)&0x07;
	acc_gain_sts[ch] <<= 8;
	acc_gain_sts[ch] |= HDDVR_i2c_ReadByte(addr, 0xE3);

	y_ref_status[ch] = HDDVR_i2c_ReadByte(addr, 0xEA)&0x07;
	y_ref_status[ch] <<= 8;
	y_ref_status[ch] |= HDDVR_i2c_ReadByte(addr, 0xEB);

	y_ref2_status[ch] = HDDVR_i2c_ReadByte(addr, 0xE8)&0x07;
	y_ref2_status[ch] <<= 8;
	y_ref2_status[ch] |= HDDVR_i2c_ReadByte(addr, 0xE9);

	I2C_UnLock();

	if(vidmode[ch] >= 4) {
		if((!ch_vloss) && (((agc_lock>>chn)&0x01) == 0x01))
			video_on[ch] = 1;
		else
			video_on[ch] = 0;
	}
	else {
		video_on[ch] = 0;
	}

	if((ch_mode_status == NVP6124_VI_1080P_2530)
		|| (ch_mode_status == NVP6124_VI_720P_2530)) {

		I2C_InLock();

		if(video_on[ch]) {
			if(loop_cnt[ch] != 0xFF) {
				loop_cnt[ch]++;
				if(loop_cnt[ch] > 200) loop_cnt[ch] = ACP_READ_START_CNT;

				if(loop_cnt[ch] == ACP_CLR_CNT)	nvp6124_acp_reg_rx_clear(addr, ch);
				else							nvp6124_acp_each_setting(addr, chn, gHDAHD_WorkStandard, ch_mode_status);

				eq_loop_cnt[ch]++;
				eq_loop_cnt[ch] %= LOOP_BUF_SIZE;

				check_c_stage[ch][eq_loop_cnt[ch]] = get_ceq_stage(ch_mode_status, acc_gain_sts[ch]);
				check_y_stage[ch][eq_loop_cnt[ch]] = get_yeq_stage(ch_mode_status, y_ref_status[ch]);
				acp_val[ch][eq_loop_cnt[ch]] = read_acp_status(addr, ch);
				acp_ptn[ch][eq_loop_cnt[ch]] = read_acp_pattern(addr, ch);
			}

			if(ch_mode_status == NVP6124_VI_720P_2530) {
				if((loop_cnt[ch] != 0xFF) && (loop_cnt[ch] >= ACP_READ_START_CNT)){
					if(one_setting[ch] == 0) {
						bypass_flag[ch] = 0xFF;
						tmp_acp_val = compare_arr(eq_loop_cnt[ch],acp_val[ch]);
						tmp_acp_ptn = compare_arr(eq_loop_cnt[ch],acp_ptn[ch]);
						if(ch == 0) {
							printf("acp_val = %x   acp_ptn = %x\n", acp_val[ch][eq_loop_cnt[ch]], acp_ptn[ch][eq_loop_cnt[ch]]);
							printf("tmp_acp_val = %x   tmp_acp_ptn = %x\n", tmp_acp_val, tmp_acp_ptn);
						}

						if((tmp_acp_val == 0x55) && (tmp_acp_ptn == 0x01)) {
							bypass_flag[ch] = 0;
							one_setting[ch] = 1;
						}
						else {
							bypass_flag_retry[ch]++;
							bypass_flag_retry[ch] %= 200;
							if(bypass_flag_retry[ch] == RETRY_CNT) {
								bypass_flag[ch] = 1;
								one_setting[ch] = 1;
							}
						}
					}

					if(bypass_flag[ch] == 1) {
						stage_update[ch] = 1;
					}
					else if(bypass_flag[ch] == 0) {
						if(ch == 0) {
							printf("loop_cnt = %d\n",loop_cnt[ch]);
							printf("check_y_stage = %d \n",check_y_stage[ch][eq_loop_cnt[ch]]);
							printf("check_c_stage = %d \n",check_c_stage[ch][eq_loop_cnt[ch]]);
						}

						if( loop_cnt[ch] == (ACP_READ_START_CNT+bypass_flag_retry[ch])) {
							init_eq_stage(addr, chn, ch_mode_status);
							if(ch == 0) {
								printf("720p init_eq_stage\n");
							}
						}
						else if(loop_cnt[ch] >= (ACP_READ_START_CNT+bypass_flag_retry[ch]+3)) {
							tmp_y_stage = compare_arr(eq_loop_cnt[ch],check_y_stage[ch]);
							tmp_c_stage = compare_arr(eq_loop_cnt[ch],check_c_stage[ch]);
							if(ch == 0) {
								printf("tmp_y_stage = %d\n",tmp_y_stage);
								printf("tmp_c_stage = %d\n",tmp_c_stage);
							}

							if((tmp_c_stage != 0xFF) && (tmp_y_stage != 0xFF))
								stage_update[ch] = 1;
							else {
								if(tmp_y_stage == 0xFF) {
									ystage_flag_retry[ch]++;
									ystage_flag_retry[ch] %= 200;
								}
								if(tmp_c_stage == 0xFF) {
									cstage_flag_retry[ch]++;
									cstage_flag_retry[ch] %= 200;
								}

								if((ystage_flag_retry[ch]==RETRY_CNT)||(cstage_flag_retry[ch]==RETRY_CNT)) {
									stage_update[ch] = 1;
									check_y_stage[ch][eq_loop_cnt[ch]] = calc_arr_mean(check_y_stage[ch]);
								}
								else {
									stage_gap = abs(decide_noptn_stage(agc_val[ch]) - check_y_stage[ch][eq_loop_cnt[ch]]);
									printf("agc_val = %d y_stage = %d\n",decide_noptn_stage(agc_val[ch]),check_y_stage[ch][eq_loop_cnt[ch]]);
									if(stage_gap >= 3)
										printf("GAP IS TOO BIG\n");

									if((calc_stage_gap(check_y_stage[ch]) >= 2) || (stage_gap >= 3)) {
										init_eq_stage(addr, chn, ch_mode_status);
										nvp6124_sw_reset(addr, ch);
									}
								}
							}
						}
					}
					else {
						stage_update[ch] = 0;
					}

					if(bypass_flag[ch] == 1) {
						check_y_stage[ch][eq_loop_cnt[ch]] = 7;
						if(((check_c_stage[ch][eq_loop_cnt[ch]] == 5) && y_ref2_status[ch] >= 0x1A0) ||
			   				(acc_gain_sts[ch] == 0x7FF && y_ref2_status[ch] >= 0x1B0))
			   				check_y_stage[ch][eq_loop_cnt[ch]] = 8;
					}
				}
			}
			else {
				printf("1080P CH%d  acp_val=%x  acp_ptn=%x\n",ch, acp_val[ch][eq_loop_cnt[ch]],acp_ptn[ch][eq_loop_cnt[ch]]);
				if((loop_cnt[ch] != 0xFF) && (loop_cnt[ch] >= ACP_READ_START_CNT)) {
					if(one_setting[ch] == 0) {
						bypass_flag[ch] = 0xFF;
						tmp_acp_val = compare_arr(eq_loop_cnt[ch],acp_val[ch]);
						tmp_acp_ptn = compare_arr(eq_loop_cnt[ch],acp_ptn[ch]);

						if((tmp_acp_val == 0x55) && (tmp_acp_ptn == 0x01)) {
							bypass_flag[ch] = 0;
							one_setting[ch] = 1;
						}
						else {
							bypass_flag_retry[ch]++;
							bypass_flag_retry[ch] %= 200;
							if(bypass_flag_retry[ch] == RETRY_CNT) {
								bypass_flag[ch] = 1;
								one_setting[ch] = 1;
								lossfakechannel(addr, chn, bypass_flag[ch]);
							}
						}
					}

					if(bypass_flag[ch] == 1) {
						stage_update[ch] = 1;
					}
					else if(bypass_flag[ch] == 0) {
                        if(ch == 0) {
	                        printf("1080p loop_cnt = %d\n",loop_cnt[ch]);
	                        printf("1080p check_y_stage = %d \n",check_y_stage[ch][eq_loop_cnt[ch]]);
	                        printf("1080p check_c_stage = %d \n",check_c_stage[ch][eq_loop_cnt[ch]]);
                        }

						if( loop_cnt[ch] == (ACP_READ_START_CNT+bypass_flag_retry[ch])) {
							init_eq_stage(addr, chn, ch_mode_status);
							if(ch == 0) {
								printf("1080p init_eq_stage\n");
							}
						}
						else if(loop_cnt[ch] >= (ACP_READ_START_CNT+bypass_flag_retry[ch]+3)) {
							tmp_y_stage = compare_arr(eq_loop_cnt[ch],check_y_stage[ch]);
							if(tmp_y_stage != 0xFF) {
								stage_update[ch] = 1;
							}
							else {
								if(tmp_y_stage == 0xFF) {
									ystage_flag_retry[ch]++;
									ystage_flag_retry[ch] %= 200;
								}

								if(ystage_flag_retry[ch]==RETRY_CNT) {
									stage_update[ch] = 1;
									check_y_stage[ch][eq_loop_cnt[ch]] = calc_arr_mean(check_y_stage[ch]);
								}
								else {
									stage_gap = abs(decide_noptn_stage(agc_val[ch]) - check_y_stage[ch][eq_loop_cnt[ch]]);
									printf("1080p agc_val=%d y_stage=%d\n",decide_noptn_stage(agc_val[ch]),check_y_stage[ch][eq_loop_cnt[ch]]);
									if(stage_gap >= 3)
										printf("GAP IS TOO BIG\n");

									if((calc_stage_gap(check_y_stage[ch]) >= 2) || (stage_gap >= 3)) {
										init_eq_stage(addr, chn, ch_mode_status);
										nvp6124_sw_reset(addr, ch);
									}
								}
							}
						}
					}
				}
			}
		}
		else {
			if(vidmode_back[ch] >= 0x04)
				stage_update[ch] = 1;
			else
				stage_update[ch] = 0;

			for(i=0;i<LOOP_BUF_SIZE;i++) {
				check_c_stage[ch][i]=0;
				check_y_stage[ch][i]=0;
				acp_val[ch][i] = 0;
				acp_ptn[ch][i] = 0;
			}
			eq_loop_cnt[ch]=0;
			check_y_stage[ch][eq_loop_cnt[ch]] = 1;
			loop_cnt[ch] =0;
			bypass_flag_retry[ch]=0;
			ystage_flag_retry[ch]=0;
			cstage_flag_retry[ch]=0;
			one_setting[ch] = 0;
			acp_isp_wr_en[ch] = 0;
			lossfakechannel(addr, chn, 0);
		}

		I2C_UnLock();

		I2C_InLock();

		if(stage_update[ch]) {
			stage_update[ch] = 0;
			acp_isp_wr_en[ch] = 1;
			eq_stage[ch] = check_y_stage[ch][eq_loop_cnt[ch]];

			if(video_on[ch]) loop_cnt[ch] = 0xFF;

			if(ch_mode_status == NVP6124_VI_720P_2530) {
				if(video_on[ch] == 0)
					init_eq_stage(addr, chn, ch_mode_status);
				else{
					HDDVR_i2c_WriteByte(addr, 0xFF,0x05+chn);
					HDDVR_i2c_WriteByte(addr, 0x58, ANALOG_EQ_720P[eq_stage[ch]]);
					HDDVR_i2c_WriteByte(addr, 0xFF,(chn<2)?0x0A:0x0B);
					HDDVR_i2c_WriteByte(addr, (ch%2==0)?0x3B:0xBB, DIGITAL_EQ_720P[eq_stage[ch]]);
				}
			}
			else {
				HDDVR_i2c_WriteByte(addr, 0xFF,0x05+chn);
				if(rev_id[tmpRealChip] == 0x20)
					HDDVR_i2c_WriteByte(addr, 0x58, ANALOG_EQ_1080P_BYPASS[eq_stage[ch]]);
				else
					HDDVR_i2c_WriteByte(addr, 0x58, ANALOG_EQ_1080P_LPF30M[eq_stage[ch]]);
				HDDVR_i2c_WriteByte(addr, 0xFF,(chn<2)?0x0A:0x0B);
				HDDVR_i2c_WriteByte(addr, (ch%2==0)?0x3B:0xBB, DIGITAL_EQ_1080P[eq_stage[ch]]);
			}
			printf("CH[%d]-Stage update : eq_stage = %d\n",ch,eq_stage[ch]);
			if(eq_stage[ch] != 7) {
				#ifdef _EQ_ADJ_COLOR_
				nvp6124_brightness_eq(addr, chn, ch_mode_status, eq_stage[ch]);
				nvp6124_contrast_eq(addr, chn, ch_mode_status, eq_stage[ch]);
				nvp6124_saturation_eq(addr, chn, ch_mode_status, eq_stage[ch]);
				#endif
				nvp6124_sharpness_eq(addr, chn, ch_mode_status, eq_stage[ch]);
				nvp6124_peaking_eq(addr, chn, ch_mode_status, eq_stage[ch]);
				nvp6124_ctigain_eq(addr, chn, ch_mode_status, eq_stage[ch]);
				nvp6124_c_filter_eq(addr, chn, ch_mode_status, eq_stage[ch]);
				nvp6124_ugain_eq(addr, chn, ch_mode_status, eq_stage[ch]);
				nvp6124_vgain_eq(addr, chn, ch_mode_status, eq_stage[ch]);
			}
		}
		vidmode_back[ch] = vidmode[ch];

		I2C_UnLock();
	}
}

void nvp6124b_set_equalizer(int addr, int chnl, int ch_vloss, int ch_mode_status)
{
	unsigned char i,tmp_acp_val,tmp_acp_ptn;
	unsigned char last_ystage, last_sarv0, last_sarv3;
	//unsigned char ch;
	unsigned char vidmode[16];
	unsigned char agc_lock;
	unsigned int  y_ref_status[16];
	unsigned int  sarv_0[16];
	unsigned int  sarv_3[16];

	HDDVR_i2c_WriteByte(addr, 0xFF, 0x05+chnl%4);
	vidmode[chnl] = HDDVR_i2c_ReadByte(addr, 0xF0);
	y_ref_status[chnl] = HDDVR_i2c_ReadByte(addr, 0xEA)&0x1F;
	y_ref_status[chnl] <<= 8;
	y_ref_status[chnl] |= HDDVR_i2c_ReadByte(addr ,0xEB);

	sarv_0[chnl] = HDDVR_i2c_ReadByte(addr ,0xF8);
	sarv_3[chnl] = HDDVR_i2c_ReadByte(addr ,0xFC);
	sarv_3[chnl] <<= 8;
	sarv_3[chnl] |= HDDVR_i2c_ReadByte(addr ,0xFB);

	sarv_3[chnl] = (sarv_3[chnl]>sarv_0[chnl]*65) ? sarv_0[chnl]*65 :
		         (sarv_3[chnl]<sarv_0[chnl]*63) ? sarv_0[chnl]*63 : sarv_3[chnl]; // 16 bit i2c read error compensation

	HDDVR_i2c_WriteByte(addr , 0xFF, 0x00);
	agc_lock = HDDVR_i2c_ReadByte(addr ,0xEC);

	if(((((ch_vloss>>(chnl)))&0x01) == 0x00) && (((agc_lock>>(chnl%4))&0x01) == 0x01)) {
		if(vidmode[chnl] <= 0x34)
			video_on[chnl] = 1;
		else {
			vidmode[chnl]  = 0xFF;
			video_on[chnl] = 0;
		}
	}
	else {
		vidmode[chnl]  = 0xFF;
		video_on[chnl] = 0;
	}

	if(1) {
		if(video_on[chnl])
		{
			if(loop_cnt[chnl] != 0xFF)
			{
				loop_cnt[chnl]++;
				if(loop_cnt[chnl] > 200) loop_cnt[chnl] = ACP_READ_START_CNT;

				if(loop_cnt[chnl] == ACP_CLR_CNT)	nvp6124_acp_reg_rx_clear(addr, chnl);
				else							nvp6124_acp_each_setting(addr, chnl, gHDAHD_WorkStandard, ch_mode_status);

				eq_loop_cnt[chnl]++;
				eq_loop_cnt[chnl] %= LOOP_BUF_SIZE;

			}

			check_y_stage[chnl][eq_loop_cnt[chnl]]		= get_yeq_stage(ch_mode_status, y_ref_status[chnl]);
			check_sarv0_stage[chnl][eq_loop_cnt[chnl]] 	= get_sarv0_stage(ch_mode_status,sarv_0[chnl]);
			check_sarv3_stage[chnl][eq_loop_cnt[chnl]]  = get_sarv3_stage(ch_mode_status,sarv_3[chnl]);
			acp_val[chnl][eq_loop_cnt[chnl]]			= read_acp_status(addr, chnl);
			acp_ptn[chnl][eq_loop_cnt[chnl]]			= read_acp_pattern(addr,chnl);
			if(chnl == 0)
			{
				if(sarv_0[chnl] < min_sarv0[chnl])				min_sarv0[chnl] = sarv_0[chnl];
				else if(sarv_0[chnl] > max_sarv0[chnl])			max_sarv0[chnl] = sarv_0[chnl];

				if(sarv_3[chnl] < min_sarv3[chnl])				min_sarv3[chnl] = sarv_3[chnl];
				else if(sarv_3[chnl] > max_sarv3[chnl])			max_sarv3[chnl] = sarv_3[chnl];

				if(y_ref_status[chnl] < min_ystage[chnl]) 		min_ystage[chnl] = y_ref_status[chnl];
				else if(y_ref_status[chnl] > max_ystage[chnl])	max_ystage[chnl] = y_ref_status[chnl];

				printf("--------------------------------------\n");
				printf("ystage=%x cur=%03x min=%03x max=%03x\n",check_y_stage[chnl][eq_loop_cnt[chnl]], y_ref_status[chnl], min_ystage[chnl], max_ystage[chnl]);
				printf("sarv0 =%x cur=%03x min=%03x max=%03x\n",check_sarv0_stage[chnl][eq_loop_cnt[chnl]], sarv_0[chnl],min_sarv0[chnl], max_sarv0[chnl]);
				printf("sarv3 =%x cur=%03x min=%03x max=%03x\n",check_sarv3_stage[chnl][eq_loop_cnt[chnl]], sarv_3[chnl],min_sarv3[chnl], max_sarv3[chnl]);
			}

			if((loop_cnt[chnl] != 0xFF) && (loop_cnt[chnl] >= ACP_READ_START_CNT))
			{
				if(one_setting[chnl] == 0)
				{
					bypass_flag[chnl] = 0xFF;
					tmp_acp_val = compare_arr(eq_loop_cnt[chnl],acp_val[chnl]);
					tmp_acp_ptn = compare_arr(eq_loop_cnt[chnl],acp_ptn[chnl]);

					tmp_acp_val = 0x55;
					tmp_acp_ptn = 0x01;
					if(chnl == 0)
					{
						printf("acp_val = %x   acp_ptn = %x\n", acp_val[chnl][eq_loop_cnt[chnl]], acp_ptn[chnl][eq_loop_cnt[chnl]]);
						printf("tmp_acp_val = %x   tmp_acp_ptn = %x\n", tmp_acp_val, tmp_acp_ptn);
					}

					if((tmp_acp_val == 0x55) && (tmp_acp_ptn == 0x01))
					{
						bypass_flag[chnl] = 0;
						one_setting[chnl] = 1;
					}
					else
					{
						bypass_flag_retry[chnl]++;
						bypass_flag_retry[chnl] %= 200;
						if(bypass_flag_retry[chnl] == RETRY_CNT)
						{
							bypass_flag[chnl] = 1;
							one_setting[chnl] = 1;
						}
					}
				}

				if(bypass_flag[chnl] == 1)
				{
					stage_update[chnl] = 1;
					check_y_stage[chnl][eq_loop_cnt[chnl]] = 7;
				}
				else if(bypass_flag[chnl] == 0)
				{
					if( loop_cnt[chnl] == (ACP_READ_START_CNT+bypass_flag_retry[chnl]))
					{
						init_eq_stage(addr, chnl, ch_mode_status);
						if(chnl == 0)
						{
							if(ch_mode_status == NVP6124_VI_1080P_2530)
								printf("1080p init_eq_stage~~~~~~~~~~~~~~~\n");
							else
								printf("720p init_eq_stage~~~~~~~~~~~~~~~\n");
						}
					}
					else if(loop_cnt[chnl] >= (ACP_READ_START_CNT+bypass_flag_retry[chnl]+3))
					{
						last_ystage = compare_arr(eq_loop_cnt[chnl],check_y_stage[chnl]);
						last_sarv0  = compare_arr(eq_loop_cnt[chnl],check_sarv0_stage[chnl]);
						last_sarv3  = compare_arr(eq_loop_cnt[chnl],check_sarv3_stage[chnl]);

						if(chnl == 0)
						{
							printf("tmp_y_stage = %d\n",last_ystage);
							printf("tmp_sarv0_stage = %d\n",last_sarv0);
							printf("tmp_sarv3_stage = %d\n",last_sarv3);
						}

						if(check_stage(chnl, last_ystage,last_sarv0,last_sarv3) != -1)
						{
							stage_update[chnl] = 1;
						}
						else
						{
							ystage_flag_retry[chnl]++;
							ystage_flag_retry[chnl] %= 200;

							if(ystage_flag_retry[chnl]==RETRY_CNT)
							{
								stage_update[chnl] = 1;
								check_y_stage[chnl][eq_loop_cnt[chnl]]  = calc_arr_mean(check_y_stage[chnl]);
							}
						}

					}
				}
				else //bypass_flag == 0xff
				{
					stage_update[chnl] = 0;
				}
			}
		}
		else
		{
			if(pre_vidmode[chnl] != vidmode[chnl])
			{
				stage_update[chnl] = 1;

				for(i=0;i<LOOP_BUF_SIZE;i++)
				{
					check_y_stage[chnl][i]=0;
					check_sarv0_stage[chnl][i]=0;
					check_sarv3_stage[chnl][i]=0;
					acp_val[chnl][i] = 0;
					acp_ptn[chnl][i] = 0;
				}
				eq_loop_cnt[chnl]=0;
				check_y_stage[chnl][eq_loop_cnt[chnl]] = 0;
				loop_cnt[chnl] =0;
				bypass_flag_retry[chnl]=0;
				ystage_flag_retry[chnl]=0;
				one_setting[chnl] = 0;
				acp_isp_wr_en[chnl]=0;
				lossfakechannel(addr, chnl, 0);

				min_sarv0[chnl] = 0xFFFF;
				max_sarv0[chnl] = 0x0000;
				min_sarv3[chnl] = 0xFFFF;
				max_sarv3[chnl] = 0x0000;
				min_ystage[chnl] = 0xFFFF;
				max_ystage[chnl] = 0x0000;
			}
			else
				stage_update[chnl] = 0;
		}
		pre_vidmode[chnl] = vidmode[chnl];

		if(stage_update[chnl])
		{
			stage_update[chnl] = 0;
			acp_isp_wr_en[chnl]=1;
			eq_stage[chnl] = check_y_stage[chnl][eq_loop_cnt[chnl]];

			if(video_on[chnl])
				loop_cnt[chnl] = 0xFF;
			else
			{
				set_color_burst_threshold(addr, chnl, ch_mode_status, eq_stage[chnl],0x00);
			}

			printf("$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$\n");
			if(acp_val[chnl][eq_loop_cnt[chnl]] == 0x55)	printf("acp ok\n");
			else										printf("acp nok\n");
			if(acp_ptn[chnl][eq_loop_cnt[chnl]] == 0x01)	printf("pattern ok \n");
			else										printf("pattern nok\n");
			printf("CH[%d]-Stage update : eq_stage = %d\n",chnl,eq_stage[chnl]);
			printf("$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$\n");

			set_analog_stage(addr, chnl, ch_mode_status, eq_stage[chnl]);
			set_iir_stage(addr, chnl, ch_mode_status, eq_stage[chnl]);
			set_color_burst_threshold(addr, chnl, ch_mode_status, eq_stage[chnl], 0x01);
		}
	}
}

static void nvp6124_video_mode_init(int addr)
{
	unsigned char tmpAddr = addr;

	{
		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x00);
		nvp61xx_write_table(tmpAddr, 0x00, NVP6124_Buf[0], 254);
		I2C_UnLock();

		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x01);
		nvp61xx_write_table(tmpAddr, 0x00, NVP6124_Buf[1], 254);
		I2C_UnLock();

		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x02);
		nvp61xx_write_table(tmpAddr, 0x00, NVP6124_Buf[2], 254);
		I2C_UnLock();

		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x03);
		nvp61xx_write_table(tmpAddr, 0x00, NVP6124_Buf[3], 254);
		I2C_UnLock();

		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x04);
		nvp61xx_write_table(tmpAddr, 0x00, NVP6124_Buf[4], 254);
		I2C_UnLock();

		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x09);
		nvp61xx_write_table(tmpAddr, 0x00, NVP6124_Buf[9], 254);
		I2C_UnLock();

		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x0A);
		nvp61xx_write_table(tmpAddr, 0x00, NVP6124_Buf[10], 254);
		I2C_UnLock();

		I2C_InLock();
		HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x0B);
		nvp61xx_write_table(tmpAddr, 0x00, NVP6124_Buf[11], 254);
		I2C_UnLock();
	}

	I2C_InLock();
	HDDVR_i2c_WriteByte(tmpAddr, 0xFF, 0x01);
	if(AD_AHD_NVP6124B == HDAHD_SYID[0])
		HDDVR_i2c_WriteByte(tmpAddr, 0x82, 0x12);
	else
		HDDVR_i2c_WriteByte(tmpAddr, 0x82, 0x14);
	HDDVR_i2c_WriteByte(tmpAddr, 0x83, 0x2C);
	HDDVR_i2c_WriteByte(tmpAddr, 0x3e, 0x10);
	HDDVR_i2c_WriteByte(tmpAddr, 0x80, 0x60);
	HDDVR_i2c_WriteByte(tmpAddr, 0x80, 0x61);
	I2C_UnLock();
	usleep(100*1000);

	I2C_InLock();
	HDDVR_i2c_WriteByte(tmpAddr, 0x80, 0x40);
	HDDVR_i2c_WriteByte(tmpAddr, 0x81, 0x02);
	HDDVR_i2c_WriteByte(tmpAddr, 0x97, 0x00);
	I2C_UnLock();
	usleep(10*1000);

	I2C_InLock();
	HDDVR_i2c_WriteByte(tmpAddr, 0x80, 0x60);
	HDDVR_i2c_WriteByte(tmpAddr, 0x81, 0x00);
	I2C_UnLock();
	usleep(10*1000);

	I2C_InLock();
	HDDVR_i2c_WriteByte(tmpAddr, 0x97, 0x0F);
	HDDVR_i2c_WriteByte(tmpAddr, 0x38, 0x18);
	HDDVR_i2c_WriteByte(tmpAddr, 0x38, 0x08);
	I2C_UnLock();
	printf("~~~~~~~~~~~~~~~~20150227-2 nvp6124_system_init~~~~~~~~~~~~~~~~\n");
	usleep(100*1000);

	I2C_InLock();
	if(AD_AHD_NVP6124B == HDAHD_SYID[0])
		HDDVR_i2c_WriteByte(tmpAddr, 0xCA, 0xAE);
	else
		HDDVR_i2c_WriteByte(tmpAddr, 0xCA, 0xFF);
	I2C_UnLock();
}

static void nvp6114_audio_config(int ICAddr)
{
	I2C_InLock();

	HDDVR_i2c_WriteByte(ICAddr, 0xFF, 0x01);

	if(ICAddr == HDAHD_ADDR0) {
		HDDVR_i2c_WriteByte(ICAddr, 0x07, 0x80); //8K/16bit Rec Master
#if   (defined(GPIO_PLAT_TYPE7) || defined(GPIO_PLAT_TYPE12))
		HDDVR_i2c_WriteByte(ICAddr, 0x13, 0x80); //8K/16bit PB  Master
		HDDVR_i2c_WriteByte(ICAddr, 0xd5, 0x00);
#else
		HDDVR_i2c_WriteByte(ICAddr, 0x13, 0x00); //8K/16bit PB  Slave
		HDDVR_i2c_WriteByte(ICAddr, 0xd5, 0x01);
#endif
		HDDVR_i2c_WriteByte(ICAddr, 0x23, 0x00); //Mix Out Select PB Input
		HDDVR_i2c_WriteByte(ICAddr, 0x06, 0x1a);
	}
	else {
		HDDVR_i2c_WriteByte(ICAddr, 0x07, 0x00); //8K/16bit Rec Slave
		HDDVR_i2c_WriteByte(ICAddr, 0x13, 0x00); //8K/16bit PB  Slave
		HDDVR_i2c_WriteByte(ICAddr, 0x23, 0x00); //Mix Out Select PB Input
		HDDVR_i2c_WriteByte(ICAddr, 0xd5, 0x01);

		HDDVR_i2c_WriteByte(ICAddr, 0x06, 0x59);
		HDDVR_i2c_WriteByte(ICAddr, 0x13, 0x00);
	}

	HDDVR_i2c_WriteByte(ICAddr, 0xFF, 0x01);
	HDDVR_i2c_WriteByte(ICAddr, 0x22, 0x08);
	HDDVR_i2c_WriteByte(ICAddr, 0x00, 0x02);

	I2C_UnLock();
}

static void nvp6114_audio_samplerate(int ICAddr, int AudioSampleRate)
{
	unsigned char tmpReg = 0;

	I2C_InLock();

	HDDVR_i2c_WriteByte(ICAddr, 0xff, 0x01); // to 1st. bank
	tmpReg = HDDVR_i2c_ReadByte(ICAddr, 0x07);
	if(AudioSampleRate <= 8000){ // 8k
		tmpReg &= ~(1<<3);
	}
	else {// 16k
		tmpReg |= (1<<3);
	}
	HDDVR_i2c_WriteByte(ICAddr, 0x07, tmpReg);

	I2C_UnLock();
}

static void nvp6114_audio_bitwidth(int ICAddr, int AudioBitWidth)
{
	unsigned char tmpReg = 0;

	I2C_InLock();

	HDDVR_i2c_WriteByte(ICAddr, 0xff, 0x01); // to 1st. bank
	tmpReg = HDDVR_i2c_ReadByte(ICAddr, 0x07);
	if(AudioBitWidth <= 8000){ // 8bits
		tmpReg &= ~(1<<2);
	}
	else {// 16bits
		tmpReg |= (1<<2);
	}
	HDDVR_i2c_WriteByte(ICAddr, 0x07, tmpReg);

	I2C_UnLock();
}

static void nvp6114_audio_channel_mode(int ICAddr, int ChnlNumb)
{
	I2C_InLock();

	HDDVR_i2c_WriteByte(ICAddr, 0xff, 0x01);

	if(ChnlNumb <= 2){
		HDDVR_i2c_WriteByte(ICAddr, 0x09, 0x00);
		HDDVR_i2c_WriteByte(ICAddr, 0x0a, 0x10);
	}
	else if((ChnlNumb <= 4)){
		HDDVR_i2c_WriteByte(ICAddr, 0x09, 0x00);
		HDDVR_i2c_WriteByte(ICAddr, 0x0a, 0x10);
		HDDVR_i2c_WriteByte(ICAddr, 0x0b, 0x32);
		HDDVR_i2c_WriteByte(ICAddr, 0x0c, 0x00);  //Clear Unused Input Channels
		HDDVR_i2c_WriteByte(ICAddr, 0x0d, 0x00);
	}
	else if((ChnlNumb <= 8)){
		HDDVR_i2c_WriteByte(ICAddr, 0x09, 0x00);
		HDDVR_i2c_WriteByte(ICAddr, 0x0a, 0x10);
		HDDVR_i2c_WriteByte(ICAddr, 0x0b, 0x32);

		HDDVR_i2c_WriteByte(ICAddr, 0x0e, 0x00);
		HDDVR_i2c_WriteByte(ICAddr, 0x0f, 0x54);
		HDDVR_i2c_WriteByte(ICAddr, 0x10, 0x76);
	}else{
		HDDVR_i2c_WriteByte(ICAddr, 0x09, 0x00);
		HDDVR_i2c_WriteByte(ICAddr, 0x0a, 0x10);
		HDDVR_i2c_WriteByte(ICAddr, 0x0b, 0x32);
		HDDVR_i2c_WriteByte(ICAddr, 0x0c, 0x54);
		HDDVR_i2c_WriteByte(ICAddr, 0x0d, 0x76);

		HDDVR_i2c_WriteByte(ICAddr, 0x0e, 0x00);
		HDDVR_i2c_WriteByte(ICAddr, 0x0f, 0x98);
		HDDVR_i2c_WriteByte(ICAddr, 0x10, 0xba);
		HDDVR_i2c_WriteByte(ICAddr, 0x11, 0xdc);
		HDDVR_i2c_WriteByte(ICAddr, 0x12, 0xfe);
	}

	I2C_UnLock();
}

static void nvp6114_audio_liveloop(int MasterIC, int AudioChnl)
{
	if(AudioChnl >= 16) {
		AudioChnl = 0x1f;  //set value for no audio output.
	}

	I2C_InLock();

	HDDVR_i2c_WriteByte(MasterIC, 0xff, 0x01);
	HDDVR_i2c_WriteByte(MasterIC, 0x23, AudioChnl);

	I2C_UnLock();
}

static void nvp6114_audio_volume(int MasterIC, unsigned int AudioVol)
{
	if(!(AudioVol < 16)) {
		AudioVol = 15;
	}

	I2C_InLock();

	HDDVR_i2c_WriteByte(MasterIC, 0xff, 0x01);
	HDDVR_i2c_WriteByte(MasterIC, 0x22, (AudioVol<<0));

	I2C_UnLock();
}

static void nvp6114_audio_playback(int MasterIC, int AudioChnl)
{
	if(AudioChnl >= 16) {
		AudioChnl = 0x1f;  //set value for no audio output.
	}

	I2C_InLock();

	HDDVR_i2c_WriteByte(MasterIC, 0xff, 0x01);
	if(AudioChnl >= 0 && AudioChnl < 16) {
		HDDVR_i2c_WriteByte(MasterIC, 0x14, AudioChnl);
		AudioChnl = 0x10; //enable playback mixer output
	}
	HDDVR_i2c_WriteByte(MasterIC, 0x23, AudioChnl);

	I2C_UnLock();
}

static void nvp6114_audio_init()
{
	int jj;
	for(jj = 0; jj < ARRAY_SIZE(HDAHD_ADDR); jj ++) {
		nvp6114_audio_config(HDAHD_ADDR[jj]);
		nvp6114_audio_samplerate(HDAHD_ADDR[jj], 8000); // default 8k sample rate
		nvp6114_audio_bitwidth(HDAHD_ADDR[jj], 16); // default 16bits data width
		nvp6114_audio_channel_mode(HDAHD_ADDR[jj], 16); // default 16 channel mode
	}
	nvp6114_audio_playback(HDAHD_ADDR[0], 0);
	nvp6114_audio_liveloop(HDAHD_ADDR[0], 0);
}

int HDAHD_Probe(void)
{
	int ii;
	int Result = -1;

	for(ii = 0; ii < ARRAY_SIZE(HDAHD_ADDR); ii ++) {
		I2C_InLock();
		HDDVR_i2c_WriteByte(HDAHD_ADDR[ii], 0xFF, 0x01);
		if(AD_AHD_NVP6114 == (HDDVR_i2c_ReadByte(HDAHD_ADDR[ii], 0xF4) << 0)) {
			HDAHD_SYID[ii] = AD_AHD_NVP6114;
			Result = 0;
		}
		HDDVR_i2c_WriteByte(HDAHD_ADDR[ii], 0xFF, 0x00);
		if(AD_AHD_NVP6124 == (HDDVR_i2c_ReadByte(HDAHD_ADDR[ii], 0xF4) << 0)) {
			HDAHD_SYID[ii] = AD_AHD_NVP6124;
			rev_id[ii] = HDDVR_i2c_ReadByte(HDAHD_ADDR[ii], 0xF5);
			Result = 0;
		}
		if(AD_AHD_NVP6114A == (HDDVR_i2c_ReadByte(HDAHD_ADDR[ii], 0xF4) << 0)) {
#if ((MAX_CAM_CH == 4) && defined(GPIO_PLAT_TYPE7)) \
	|| ((MAX_CAM_CH == 8) && defined(GPIO_PLAT_TYPE6)) //Special Channel Order
			memcpy(HDAHD_CHN_TBL, NVP6114A_REMAPPING_TBL, sizeof(HDAHD_CHN_TBL));
#endif
			HDAHD_SYID[ii] = AD_AHD_NVP6114A;
			rev_id[ii] = HDDVR_i2c_ReadByte(HDAHD_ADDR[ii], 0xF5);
			Result = 0;
		}
		if(AD_AHD_NVP6124B == (HDDVR_i2c_ReadByte(HDAHD_ADDR[ii], 0xF4) << 0)) {
			HDAHD_SYID[ii] = AD_AHD_NVP6124B;
			rev_id[ii] = HDDVR_i2c_ReadByte(HDAHD_ADDR[ii], 0xF5);
			Result = 0;
		}
		I2C_UnLock();
	}

	return Result;
}


int HDAHD_VSupportCheck(void)
{
	if(AD_AHD_NVP6114 == HDAHD_SYID[0]) {
		return HDDVR_VSUPPORT_HD720P;
	}
	
	if(AD_AHD_NVP6124 == HDAHD_SYID[0]) {
		return HDDVR_VSUPPORT_HD1080P;
	}

	if(AD_AHD_NVP6114A == HDAHD_SYID[0]) {
		return HDDVR_VSUPPORT_HD1080P;
	}

	if(AD_AHD_NVP6124B == HDAHD_SYID[0]) {
		return HDDVR_VSUPPORT_HD1080P;
	}

	return HDDVR_VSUPPORT_HD720P;
}

int HDAHD_Init(int Fmt)
{
	pthread_mutex_init(&gI2C_Locker, NULL);

	int ii;
	int tmpAddr;

	gHDAHD_WorkStandard = (Fmt== 0) ?NVP1108_PAL :NVP1108_NTSC;
	for(ii = 0; ii < ARRAY_SIZE(HDAHD_ADDR); ii ++) {
		tmpAddr = HDAHD_ADDR[ii];

		if(AD_AHD_NVP6114 == HDAHD_SYID[0]) {
			nvp6114_video_mode_init(tmpAddr, gHDAHD_WorkStandard);
		}
		if((AD_AHD_NVP6124 == HDAHD_SYID[0])
		|| (AD_AHD_NVP6114A == HDAHD_SYID[0])
		|| (AD_AHD_NVP6124B == HDAHD_SYID[0])) {
			nvp6124_video_mode_init(tmpAddr);
		}
	}

	for(ii = 0; ii < MAX_CAM_CH; ii ++) { //FIXME:
		HDAHD_InputFormatSetting(ii, (NVP1108_PAL == gHDAHD_WorkStandard) ? HDVIDEO_HD1080P25FPS : HDVIDEO_HD1080P30FPS);
	}

	nvp6114_audio_init();

	return 0;
}

int HDAHD_Exit(void)
{
	pthread_mutex_destroy(&gI2C_Locker);

	return 0;
}

int HDAHD_VideoVLossCheck(int Chnl)
{
	int tmpRealChip;
	int tmpRealChnl;
	int tmpRealAddr;

	unsigned char tmpRead;

	if(0 != HDAHD_ChipGetMap(Chnl, &tmpRealChip, &tmpRealChnl, &tmpRealAddr)) {
		return HDVLOSS_ERROR;
	}

	I2C_InLock();
	if(AD_AHD_NVP6114 == HDAHD_SYID[0]) {
		HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x01);
		tmpRead  = HDDVR_i2c_ReadByte(tmpRealAddr, 0xD8);
	}

	if((AD_AHD_NVP6124 == HDAHD_SYID[0])
	|| (AD_AHD_NVP6114A == HDAHD_SYID[0])
	|| (AD_AHD_NVP6124B == HDAHD_SYID[0])) {
		HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x00);
		tmpRead  = HDDVR_i2c_ReadByte(tmpRealAddr, 0xB8);
	}

	I2C_UnLock();

	return (tmpRead & (1 << tmpRealChnl))
			? HDVLOSS_NOVIDEO
			: HDVLOSS_INVIDEO;
}

int HDAHD_VideoVLockCheck(int Chnl)
{
	int tmpRealChip;
	int tmpRealChnl;
	int tmpRealAddr;

	unsigned char tmpEC, tmpED, tmpEE;

	if(0 != HDAHD_ChipGetMap(Chnl, &tmpRealChip, &tmpRealChnl, &tmpRealAddr)) {
		return HDVLOSS_ERROR;
	}

	I2C_InLock();
	HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x01);

	tmpEC  = HDDVR_i2c_ReadByte(tmpRealAddr, 0xEC);
	tmpED  = HDDVR_i2c_ReadByte(tmpRealAddr, 0xED);
	tmpEE  = HDDVR_i2c_ReadByte(tmpRealAddr, 0xEE);

	I2C_UnLock();

	return (tmpEC & tmpED & tmpEE & (1 << tmpRealChnl)) //Check All HLOCK bits
			? HDVLOSS_INVIDEO
			: HDVLOSS_NOVIDEO;
}

static int SleepWithVideoCheck(int Chnl, int Unit, int Numb)
{
	while(Numb --) {
		if(HDAHD_VideoVLossCheck(Chnl)) {
			return -1;
		}
		usleep(Unit);
	}

	return 0;
}

int HDAHD_VideoNoVideoFix(int Chnl)
{

	return 0;
}

int HDAHD_VideoStVideoFix(int Chnl)
{
	int tmpRealChip;
	int tmpRealChnl;
	int tmpRealAddr;

	if(0 != HDAHD_ChipGetMap(Chnl, &tmpRealChip, &tmpRealChnl, &tmpRealAddr)) {
		return HDVIDEO_UNKNOWN;
	}

	if((AD_AHD_NVP6124 == HDAHD_SYID[0])
	|| (AD_AHD_NVP6114A == HDAHD_SYID[0])) {
		nvp6124_set_equalizer(tmpRealAddr, tmpRealChnl,
			(HDVLOSS_INVIDEO != HDAHD_VideoVLossCheck(Chnl)), nvp6124_videoformat[Chnl]);
	}

	if(AD_AHD_NVP6124B == HDAHD_SYID[0]){
		nvp6124b_set_equalizer(tmpRealAddr,tmpRealChnl,
			(HDVLOSS_INVIDEO != HDAHD_VideoVLossCheck(Chnl)), nvp6124_videoformat[Chnl]);
	}

	return 0;
}

int HDAHD_VideoInVideoFix(int Chnl)
{

	return 0;
}

/*nvp6124b*/
static unsigned int nvp6124b_vdsts2_nvp6124(unsigned int vdsts)
{
	unsigned int ret;
	switch(vdsts){
		case 0x00:			//nvp6124b NTSC SD
			ret = 0x01;		//nvp6124  NTSC SD
		break;
		case 0x10:          //nvp6124b PAL SD
			ret = 0x02;
		break;
		case 0x20:			//nvp6124b NT 720P/30
			ret = 0x04;
		break;
		case 0x21:
			ret = 0x08;
		break;
		case 0x22:
			ret = 0x10;
		break;
		case 0x23:
			ret = 0x20;
		break;
		case 0x30:
			ret = 0x40;
		break;
		case 0x31:
			ret = 0x80;
		break;
		default:
			ret = vdsts;
		break;
	}
	return ret;
}

#define FMT_DEBOUNCE_CNT (5)
unsigned int video_fmt_debounce(int addr, int chn)
{
	unsigned int idx = FMT_DEBOUNCE_CNT - 1;
	int i, j;

	unsigned int Debounce_Buf[FMT_DEBOUNCE_CNT];

	memset(Debounce_Buf, 0, sizeof(Debounce_Buf));
	for(i=0; i<FMT_DEBOUNCE_CNT; i ++) {
		if(AD_AHD_NVP6124B == HDAHD_SYID[0]) {
			unsigned int tmpRead;

			HDDVR_i2c_WriteByte(addr, 0xFF, 0x05+(chn%4));
			tmpRead = HDDVR_i2c_ReadByte(addr, 0xF0);
			Debounce_Buf[i] = nvp6124b_vdsts2_nvp6124(tmpRead);
		}
		else {
			HDDVR_i2c_WriteByte(addr, 0xFF, 0x00);
			Debounce_Buf[i] = HDDVR_i2c_ReadByte(addr, 0xD0+(chn%4));
		}
	}

	for(i = 0; i < FMT_DEBOUNCE_CNT; i ++) {
		int Debounce_Cnt[FMT_DEBOUNCE_CNT];

		memset(Debounce_Cnt, 0, sizeof(Debounce_Cnt));
        for(j = 0; j < FMT_DEBOUNCE_CNT; j ++) {
            if(Debounce_Buf[i] == Debounce_Buf[j]) {
            	Debounce_Cnt[i] ++;
            }
        }
        if((i > 0) && (Debounce_Cnt[i-1] >= Debounce_Cnt[i])) {
	        idx = i-1;
		}
    }

	printf("video_fmt_debounce ch[%d] buf[%d] = %x\n", chn, idx, Debounce_Buf[idx]);

	return Debounce_Buf[idx];
}

static unsigned char videofmt[16]; //FIXME:
int HDAHD_InputFormatCheck(int Chnl)
{
	int tmpRealChip;
	int tmpRealChnl;
	int tmpRealAddr;

	int tmpFormatVal = HDVIDEO_UNKNOWN;
	int tmpTryTimes  = 10;

	if(0 != HDAHD_ChipGetMap(Chnl, &tmpRealChip, &tmpRealChnl, &tmpRealAddr)) {
		return HDVIDEO_UNKNOWN;
	}

	tmpTryTimes = 1;

	if(AD_AHD_NVP6114 != HDAHD_SYID[0]) { //For NVP6124/NVP6114A/NVP6124B Only
		unsigned char tmpRead = 0;
		int tmpVLoss = HDAHD_VideoVLossCheck(Chnl);

		I2C_InLock();

		if(AD_AHD_NVP6124B != HDAHD_SYID[0]) {
			HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x00);
			tmpRead = HDDVR_i2c_ReadByte(tmpRealAddr, 0xD0 + (tmpRealChnl%4));
		}
		else {
			HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x05 + (tmpRealChnl%4));
			tmpRead = HDDVR_i2c_ReadByte(tmpRealAddr, 0xF0);
			tmpRead = nvp6124b_vdsts2_nvp6124(tmpRead);
		}

		if(tmpRead != videofmt[Chnl]) { //FIXME:
			tmpRead = video_fmt_debounce(tmpRealAddr, tmpRealChnl);
			videofmt[Chnl] = tmpRead;
		}

		if(AD_AHD_NVP6124B != HDAHD_SYID[0]) {
			if(((tmpRead == 0x40) && (HDVLOSS_INVIDEO == tmpVLoss))
			|| ((tmpRead == 0x10) && (HDVLOSS_INVIDEO == tmpVLoss))) {
				HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x00);
				HDDVR_i2c_WriteByte(tmpRealAddr, 0x23 + 4*(tmpRealChnl%4), 0x41);
				HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x05+(tmpRealChnl%4));
				HDDVR_i2c_WriteByte(tmpRealAddr, 0x47, 0xee);
			}
			else {
				HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x00);
				HDDVR_i2c_WriteByte(tmpRealAddr, 0x23 + 4*(tmpRealChnl%4), 0x43);
				HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x05+(tmpRealChnl%4));
				HDDVR_i2c_WriteByte(tmpRealAddr, 0x47, 0x04);
			}

			if(((tmpRead == 0x01) && (HDVLOSS_INVIDEO == tmpVLoss))
			|| ((tmpRead == 0x02) && (HDVLOSS_INVIDEO == tmpVLoss))) {
				unsigned char tmp = 0x00;

				HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x00);
				tmp = HDDVR_i2c_ReadByte(tmpRealAddr, 0xE8+(tmpRealChnl%4));
				if((0x6A == tmp) || (0x6E == tmp)) {
					HDDVR_i2c_WriteByte(tmpRealAddr, 0x21+4*(tmpRealChnl%4), (NVP1108_PAL == gHDAHD_WorkStandard)?0x22:0xA2);
					printf("CH[%d]nextchip comet input\n\n", tmpRealChnl);
				}
				else {
					HDDVR_i2c_WriteByte(tmpRealAddr, 0x21+4*(tmpRealChnl%4), (NVP1108_PAL == gHDAHD_WorkStandard)?0x02:0x82);
				}
			}
		}
		I2C_UnLock();

		{
			if(0x80 == tmpRead) {
				tmpFormatVal = HDVIDEO_HD1080P25FPS;
			}
			if(0x20 == tmpRead) {
				tmpFormatVal = HDVIDEO_HD720P50FPS;
			}
			if(0x08 == tmpRead) {
				tmpFormatVal = HDVIDEO_HD720P25FPS;
			}
			if(0x02 == tmpRead) {
				tmpFormatVal = HDVIDEO_SD960H25FPS;
			}
			if(0x40 == tmpRead) {
				tmpFormatVal = HDVIDEO_HD1080P30FPS;
			}
			if(0x10 == tmpRead) {
				tmpFormatVal = HDVIDEO_HD720P60FPS;
			}
			if(0x04 == tmpRead) {
				tmpFormatVal = HDVIDEO_HD720P30FPS;
			}
			if(0x01 == tmpRead) {
				tmpFormatVal = HDVIDEO_SD960H30FPS;
			}
		}

		return tmpFormatVal;
	}

	while(tmpTryTimes --) {
//		if(HDVLOSS_INVIDEO == HDAHD_VideoVLockCheck(Chnl))
		{
			unsigned char tmpEC, tmpEF, tmpF0, tmpED, tmpEE;
			unsigned char tmpD4, tmpD5;

			I2C_InLock();
			HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x03);
			tmpD4  = HDDVR_i2c_ReadByte(tmpRealAddr, 0xD4); //Check D4
			tmpD5  = HDDVR_i2c_ReadByte(tmpRealAddr, 0xD5); //Check D5

			HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x01);
			tmpEC  = HDDVR_i2c_ReadByte(tmpRealAddr, 0xEC); //Detect SD Input
			tmpEF  = HDDVR_i2c_ReadByte(tmpRealAddr, 0xEF); //Detect SD Format

			tmpF0  = HDDVR_i2c_ReadByte(tmpRealAddr, 0xF0); //Detect Stable AHD
			tmpED  = HDDVR_i2c_ReadByte(tmpRealAddr, 0xED); //Detect AHD 30FPS
			tmpEE  = HDDVR_i2c_ReadByte(tmpRealAddr, 0xEE); //Detect AHD 25FPS
			I2C_UnLock();

			if((tmpD4 == 0x80) && (tmpD5 == 0x80)) {
				if(((tmpEC >> 4) & (0x01 << tmpRealChnl)) == 0x00) { //AHD MODE
					if(((tmpEE >> 4) & (0x01 << tmpRealChnl)) != 0x00) {
						tmpFormatVal = HDVIDEO_HD720P25FPS;
					}
					if(((tmpED >> 4) & (0x01 << tmpRealChnl)) != 0x00) {
						tmpFormatVal = HDVIDEO_HD720P30FPS;
					}
				}
				else {
					return HDVIDEO_SD960H;
				}
			}

			if((tmpD4 == 0x00) && (tmpD5 == 0x80)) {
				if(((tmpEC >> 4) & (0x01 << tmpRealChnl)) != 0x00) { //CVBS MODE
					if(((tmpEF >> (tmpRealChnl*2)) & 0x03) == 0x03) {
						tmpFormatVal = HDVIDEO_SD960H30FPS;
					}
					if(((tmpEF >> (tmpRealChnl*2)) & 0x03) == 0x02) {
						tmpFormatVal = HDVIDEO_SD960H25FPS;
					}
				}
				else {
					tmpFormatVal = HDVIDEO_HD720P;
				}
			}

			if(0) {
				tmpFormatVal = HDVIDEO_HD1080P30FPS;
				tmpFormatVal = HDVIDEO_HD1080P25FPS;
			}

			if(tmpFormatVal != HDVIDEO_UNKNOWN) {
				break;
			}
		}
		usleep(1000);
	}

	return tmpFormatVal;
}

int HDAHD_InputFormatSetting(int Chnl, HD_INPUT_FORMAT Frmt)
{
	int tmpRealChip;
	int tmpRealChnl;
	int tmpRealAddr;

	if(0 != HDAHD_ChipGetMap(Chnl, &tmpRealChip, &tmpRealChnl, &tmpRealAddr)) {
		return -1;
	}
	
	if((Frmt >= HDVIDEO_CNT) || (Frmt < HDVIDEO_UNKNOWN)) {
		return -1;
	}

	if(AD_AHD_NVP6114 == HDAHD_SYID[0]) {
		int tmpVT;
		unsigned char tmpVC;

		switch(Frmt) {
		default:
		case HDVIDEO_HD1080P30FPS:
		case HDVIDEO_HD720P60FPS:
		case HDVIDEO_HD720P30FPS:
			tmpVT = NVP1108_NTSC;
			tmpVC = 0x00;
			break;
		case HDVIDEO_HD1080P25FPS:
		case HDVIDEO_HD720P50FPS:
		case HDVIDEO_HD720P25FPS:
			tmpVT = NVP1108_PAL;
			tmpVC = 0x00;
			break;
		case HDVIDEO_SD960H30FPS:
		case HDVIDEO_SD720H30FPS:
			tmpVT = NVP1108_NTSC;
			tmpVC = 0x03;
			break;
		case HDVIDEO_SD960H25FPS:
		case HDVIDEO_SD720H25FPS:
			tmpVT = NVP1108_PAL;
			tmpVC = 0x03;
			break;
		}

		{
			unsigned char tmpV = HDAHD_VIDEOMODE[tmpRealChip];
			if(tmpRealChnl < 2) {
				tmpV &= 0x0C;
				tmpV |= tmpVC;
			}
			else {
				tmpV &= 0x03;
				tmpV |= (tmpVC << 2);
			}
			HDAHD_VIDEOMODE[tmpRealChip] = tmpV;

			nvp6114_video_960H_setting(tmpRealAddr,	tmpVT, HDAHD_VIDEOMODE[tmpRealChip]);
		}
	}

	if((AD_AHD_NVP6124 == HDAHD_SYID[0])
	|| (AD_AHD_NVP6114A == HDAHD_SYID[0])
	|| (AD_AHD_NVP6124B == HDAHD_SYID[0])) {
		int ViMode = 0;
	
		switch(Frmt) {
		case HDVIDEO_SD720H25FPS:
		case HDVIDEO_SD720H30FPS:
		case HDVIDEO_SD960H25FPS:
		case HDVIDEO_SD960H30FPS:
			ViMode = NVP6124_VI_SD;
			break;
		case HDVIDEO_HD720P25FPS:
		case HDVIDEO_HD720P30FPS:
			ViMode = NVP6124_VI_720P_2530;
			break;
		case HDVIDEO_HD720P50FPS:
		case HDVIDEO_HD720P60FPS:
			ViMode = NVP6124_VI_720P_5060;
			break;
		default:
		case HDVIDEO_HD1080P25FPS:
		case HDVIDEO_HD1080P30FPS:
			ViMode = NVP6124_VI_1080P_2530;
			break;
		}

		nvp6124_videoformat[tmpRealChnl] = ViMode;
		nvp6124_channelmode[tmpRealChnl] = gHDAHD_WorkStandard;
	
		nvp6124_each_mode_setting(tmpRealAddr, tmpRealChnl, nvp6124_channelmode[tmpRealChnl], nvp6124_videoformat[tmpRealChnl]);

#if defined _EXT_HDDVR_LITE
		if(AD_AHD_NVP6124 == HDAHD_SYID[0]) {
			int ViPort[] = {1, 3};
			nvp6124_outport_2mux(tmpRealAddr, ViPort[(tmpRealChnl%4)/2], ViMode);
		}
		if(AD_AHD_NVP6114A == HDAHD_SYID[0]) {
#if (MAX_CAM_CH == 4) && defined(GPIO_PLAT_TYPE7) //Special Channel Order
			int ViPort[] = {0, 1, 1, 0};
#else
			int ViPort[] = {0, 0, 1, 1};
#endif
			nvp6114a_outport_2mux(tmpRealAddr, ViPort[(tmpRealChnl%4)], ViMode);
		}
		if(AD_AHD_NVP6124B == HDAHD_SYID[0]) {
			int ViPort[] = {0, 0, 1, 1};
			nvp6124b_set_portmode(tmpRealAddr, ViPort[(tmpRealChnl%4)], NVP6124_OUTMODE_2MUX_FHD, ViPort[(tmpRealChnl%4)]);
		}
#else 
		nvp6124_outport_1mux(tmpRealAddr, tmpRealChnl);
#endif
	}

	return 0;
}

int HDAHD_VideoLossFix(int Chnl, int Fix)
{
	static int ttt[MAX_CAM_CH] =  //Force Enable HDAHD_VideoInVideoFix
#if (MAX_CAM_CH == 4)
	{ 1, 1, 1, 1, };
#endif
#if (MAX_CAM_CH == 8)
	{ 1, 1, 1, 1, 1, 1, 1, 1, };
#endif
#if (MAX_CAM_CH == 16)
	{ 1, 1, 1, 1, 1, 1, 1, 1,
	  1, 1, 1, 1, 1, 1, 1, 1, };
#endif

	if(!CHECK_SIZE(Chnl, ttt)) {
		return -1;
	}

	Fix = (HDVLOSS_INVIDEO != HDAHD_VideoVLossCheck(Chnl));
	if(Fix) {  //When Video Lost
		ttt[Chnl] = 1;

		HDAHD_VideoNoVideoFix(Chnl);
	}
	if(!Fix) {
		if((HDVLOSS_INVIDEO == HDAHD_VideoVLockCheck(Chnl)) && ttt[Chnl]) { //Once Video Input
			ttt[Chnl] = 0;

			HDAHD_VideoInVideoFix(Chnl);
		}
	}

	return 0;
}
#if 1
#define BANK0		0x00
#define BANK1		0x01
#define BANK2		0x02
#define BANK3		0x03
#define BANK4		0x04
#define BANK5		0x05
#define BANK6		0x06
#define BANK7		0x07
#define BANK8		0x08
#define BANK9		0x09

#define PACKET_MODE	0x0B

const unsigned char NVP6124_1080P_2530_tab[HDDVR_UTC_CMD_COUNT][4] = {						
						0x00, 0x08, 0x00, 0x32,
						0x00, 0x10, 0x00, 0x32,
						0x00, 0x04, 0x32, 0x00,
						0x00, 0x02, 0x32, 0x00,					
						0x02, 0x00, 0x00, 0x00,
						0x04, 0x00, 0x00, 0x00,
						0x01, 0x00, 0x00, 0x00,
						0x00, 0x80, 0x00, 0x00,
						0x00, 0x40, 0x00, 0x00,
						0x00, 0x20, 0x00, 0x00,
						0x00, 0x03, 0x00, 0x3F,
						0x00, 0x00, 0x00, 0x00,
						0x02, 0x00, 0x00, 0x00
};

const unsigned char NVP6124_720P_2530_tab[HDDVR_UTC_CMD_COUNT][4] = {				
						0x00, 0x10, 0x10, 0x4C,
						0x00, 0x08, 0x08, 0x4C,
						0x00, 0x20, 0x20, 0x00,
						0x00, 0x40, 0x40, 0x00,					
						0x40, 0x00, 0x00, 0x00,
						0x20, 0x00, 0x00, 0x00,
						0x80, 0x00, 0x00, 0x00,
						0x00, 0x01, 0x01, 0x00,
						0x00, 0x02, 0x02, 0x00,
						0x00, 0x04, 0x04, 0x00,
						0x00, 0xC0, 0xC0, 0xFA,
						0x00, 0x00, 0x00, 0x00,
						0x40, 0x00, 0x00, 0x00
};

const unsigned char NVP6124_VI_SD_tab[HDDVR_UTC_CMD_COUNT][4] = {				
						0x00, 0x10, 0x00, 0x4C,
						0x00, 0x08, 0x00, 0x4C,
						0x00, 0x20, 0x4C, 0x00,
						0x00, 0x40, 0x4C, 0x00,			
						0x40, 0x00, 0x00, 0x00,
						0x20, 0x00, 0x00, 0x00,
						0x80, 0x00, 0x00, 0x00,
						0x00, 0x01, 0x00, 0x00,
						0x00, 0x02, 0x00, 0x00,
						0x00, 0x04, 0x00, 0x00,
						0x00, 0xC0, 0x00, 0xFA,
						0x00, 0x00, 0x00, 0x00,
						0x40, 0x00, 0x00, 0x00
};

const unsigned char NVP6124_HM_CMD_tab[HDDVR_HM_CMD_COUNT - HDDVR_UTC_CMD_COUNT - 1][4] = {
						0x00, 0x00, 0x00, 0x00,
						0x00, 0x10, 0x08, 0x3F,
						0x00, 0x08, 0x08, 0x3F,
						0x00, 0x04, 0x3F, 0x08,
						0x00, 0x02, 0x3F, 0x08,
						0x00, 0x20, 0x08, 0x08,
						0x00, 0x40, 0x08, 0x08,
						0x04, 0x00, 0x00, 0x00,
						0x02, 0x00, 0x00, 0x00,

						0x01, 0x00, 0x00, 0x00,
						0x00, 0x80, 0x00, 0x00,

						0x00, 0x07, 0x00, 0x01,
						0x00, 0x07, 0x00, 0x10,
						0x00, 0x07, 0x00, 0x80,
						0x00, 0x07, 0x00, 0xff,
						0x00, 0x07, 0x00, 0xaa,

						0x00, 0x03, 0x00, 0x01,
						0x00, 0x03, 0x00, 0x10,
						0x00, 0x03, 0x00, 0x80,
						0x00, 0x03, 0x00, 0xFF,
						0x00, 0x03, 0x00, 0xaa,
						0x00, 0x05, 0x00, 0xaa
};

void nvp6124_PelcoShout(int Chnl, int addr){
	I2C_InLock();
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x03+((Chnl/2)%2));
	if(		(nvp6124_videoformat[Chnl] == NVP6124_VI_SD) 		|| 
			(nvp6124_videoformat[Chnl] == NVP6124_VI_720H)		||
			(nvp6124_videoformat[Chnl] == NVP6124_VI_1280H)	||
			(nvp6124_videoformat[Chnl] == NVP6124_VI_1440H)	||
			(nvp6124_videoformat[Chnl] == NVP6124_VI_1920H)	||
			(nvp6124_videoformat[Chnl] == NVP6124_VI_960H2EX)	){
		HDDVR_i2c_WriteByte(addr, AHD2_PEL_OUT+(((Chnl)%2)*0x80), 0x01);
		usleep( 30*1000 );
		HDDVR_i2c_WriteByte(addr, AHD2_PEL_OUT+(((Chnl)%2)*0x80), 0x00);
		usleep( 60*1000 );
	}	
	else if(nvp6124_videoformat[Chnl] == NVP6124_VI_720P_2530 || 
		nvp6124_videoformat[Chnl] == NVP6124_VI_HDEX || 
		nvp6124_videoformat[Chnl] == NVP6124_VI_720P_5060){
		HDDVR_i2c_WriteByte(addr, AHD2_PEL_OUT+(((Chnl)%2)*0x80), 0x01);
		usleep( 30*1000 );
		HDDVR_i2c_WriteByte(addr, AHD2_PEL_OUT+(((Chnl)%2)*0x80), 0x00);
		usleep( 60*1000 );
	}
	else 
	{
		HDDVR_i2c_WriteByte(addr, AHD2_FHD_OUT+(((Chnl)%2)*0x80), 0x08);
		usleep( 25*1000 );
		HDDVR_i2c_WriteByte(addr, AHD2_FHD_OUT+(((Chnl)%2)*0x80), 0x00);
		usleep( 25*1000 );
	}
	I2C_UnLock();
}

void nvp6124_PelcoPreshout(int Chnl, int addr)
{
	I2C_InLock();
	HDDVR_i2c_WriteByte(addr, 0xFF, 0x03+((Chnl/2)%2));
	if(		(nvp6124_videoformat[Chnl] == NVP6124_VI_SD) 		|| 
			(nvp6124_videoformat[Chnl] == NVP6124_VI_720H)		||
			(nvp6124_videoformat[Chnl] == NVP6124_VI_1280H)	||
			(nvp6124_videoformat[Chnl] == NVP6124_VI_1440H)	||
			(nvp6124_videoformat[Chnl] == NVP6124_VI_1920H)	||
			(nvp6124_videoformat[Chnl] == NVP6124_VI_960H2EX)	)
	{
		HDDVR_i2c_WriteByte(addr, AHD2_PEL_OUT+(((Chnl)%2)*0x80), 0x01);
		usleep( 30*1000 );
		HDDVR_i2c_WriteByte(addr, AHD2_PEL_OUT+(((Chnl)%2)*0x80), 0x00);
	}	
	else if(nvp6124_videoformat[Chnl] == NVP6124_VI_720P_2530 || 
			nvp6124_videoformat[Chnl] == NVP6124_VI_HDEX	  || 
			nvp6124_videoformat[Chnl] == NVP6124_VI_720P_5060){
		HDDVR_i2c_WriteByte(addr, AHD2_PEL_OUT+(((Chnl)%2)*0x80), 0x01);
		usleep( 30*1000 );
		HDDVR_i2c_WriteByte(addr, AHD2_PEL_OUT+(((Chnl)%2)*0x80), 0x00);
	}
	else 
	{
		HDDVR_i2c_WriteByte(addr, AHD2_FHD_OUT+(((Chnl)%2)*0x80), 0x08);
		usleep( 25*1000 );
		HDDVR_i2c_WriteByte(addr, AHD2_FHD_OUT+(((Chnl)%2)*0x80), 0x00);
	}
	I2C_UnLock();
}

unsigned char nvp6124_PelcoCommand(int Chnl, int Cmd, unsigned char value)
{
	int i;
	int tmpRealChip;
	int tmpRealChnl;
	int tmpRealAddr;
	
	if(0 != HDAHD_ChipGetMap(Chnl, &tmpRealChip, &tmpRealChnl, &tmpRealAddr)) {
		return HDVIDEO_UNKNOWN;
	}
	printf("funanfeng nvp6124_videoformat=%d,HDAHD_SYID[0]=%x,nvp6124_channelmode[%d]=%d\n",nvp6124_videoformat[tmpRealChnl], HDAHD_SYID[0], tmpRealChnl, nvp6124_channelmode[tmpRealChnl]);
	I2C_InLock();
	HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x03+((tmpRealChnl/2)%2));
	I2C_UnLock();
	if((nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_SD) 		|| 
		(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_1280H)	||
		(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_720H)	||
		(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_1440H)	||
		(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_1920H)	||
		(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_960H2EX)	){
			I2C_InLock();
			for(i=0; i<4 && Cmd<HDDVR_UTC_CMD_COUNT; i++){
				HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_D0+i+(((tmpRealChnl)%2)*0x80), 0x00);
			}
			I2C_UnLock();
			nvp6124_PelcoPreshout(tmpRealChnl, tmpRealAddr);
			I2C_InLock();
			for(i=0;i<4 && Cmd<HDDVR_UTC_CMD_COUNT;i++){
				HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_D0+i+(((tmpRealChnl)%2)*0x80), NVP6124_VI_SD_tab[Cmd][i]);
			}
			I2C_UnLock();
			nvp6124_PelcoShout(tmpRealChnl, tmpRealAddr);
			printf("\r\nPelco protocl shout!");				
	}
	else if(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_720P_2530 || 
			nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_HDEX      || 
			nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_720P_5060){
			I2C_InLock();
			for(i=0;i<4 && Cmd<HDDVR_UTC_CMD_COUNT;i++){
				HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_D0+i+(((tmpRealChnl)%2)*0x80), 0x00);
			}
			I2C_UnLock();
			nvp6124_PelcoPreshout(tmpRealChnl, tmpRealAddr);
			I2C_InLock();
			for(i=0;i<4 && Cmd<HDDVR_UTC_CMD_COUNT;i++){
				HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_D0+i+(((tmpRealChnl)%2)*0x80), NVP6124_720P_2530_tab[Cmd][i]);	
			}
			I2C_UnLock();
			nvp6124_PelcoShout(tmpRealChnl, tmpRealAddr);
			printf("\r\n720p Coaxial protocl shout!");				
	}
	else if(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_1080P_2530){
			I2C_InLock();
			for(i=0; i<4 && Cmd<HDDVR_UTC_CMD_COUNT; i++){
				HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_FHD_D0+i+(((tmpRealChnl)%2)*0x80), 0x00);	
				printf("nanfeng=%x\n", AHD2_FHD_D0+i+(((tmpRealChnl)%2)*0x80));
			}
			I2C_UnLock();
			nvp6124_PelcoPreshout(tmpRealChnl, tmpRealAddr);
			I2C_InLock();
			for(i=0; i<4 && Cmd<HDDVR_UTC_CMD_COUNT; i++){
				HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_FHD_D0+i+(((tmpRealChnl)%2)*0x80), NVP6124_1080P_2530_tab[Cmd][i]);
				printf("NVP6124_1080P_2530_tab[%d][%d]=%x\n", Cmd, i, NVP6124_1080P_2530_tab[Cmd][i]);
			}
			I2C_UnLock();
			nvp6124_PelcoShout(tmpRealChnl, tmpRealAddr);
			printf("\r\n1080p Coaxial protocl shout!");		
	}

	
}

void nvp6124_utc_InitByChnlVFmt(int chnl)
{
	int tmpRealChip;
	int tmpRealChnl;
	int tmpRealAddr;

	if(0 != HDAHD_ChipGetMap(chnl, &tmpRealChip, &tmpRealChnl, &tmpRealAddr)) {
		return -1;
	}
	
	printf("2222222222222222222222222tmpRealChnl=%d\n", tmpRealChnl);
	printf("funanfeng nvp6124_videoformat=%d,HDAHD_SYID[0]=%x,nvp6124_channelmode[%d]=%d\n",nvp6124_videoformat[tmpRealChnl], HDAHD_SYID[0], tmpRealChnl, nvp6124_channelmode[tmpRealChnl]);
	I2C_InLock();
	HDDVR_i2c_WriteByte( tmpRealAddr, 0xFF, 0x01 );
	if(HDAHD_SYID[0] == AD_AHD_NVP6124)
	{
		HDDVR_i2c_WriteByte( tmpRealAddr, 0xBD, 0xD0 );
		HDDVR_i2c_WriteByte( tmpRealAddr, 0xBE, 0xDD );
		HDDVR_i2c_WriteByte( tmpRealAddr, 0xBF, 0x0D );
		ACP_RX_D0 = 0x78;
	}
	else if(HDAHD_SYID[0] == AD_AHD_NVP6114A)
	{
		HDDVR_i2c_WriteByte( tmpRealAddr, 0xBC, 0xDD );
		HDDVR_i2c_WriteByte( tmpRealAddr, 0xBD, 0xED );
		ACP_RX_D0 = 0x78;
	}
	else if(HDAHD_SYID[0] == AD_AHD_NVP6124B)
	{
		HDDVR_i2c_WriteByte(tmpRealAddr, 0xBC, 0xF7);
		HDDVR_i2c_WriteByte(tmpRealAddr, 0xBD, 0xF7);
		HDDVR_i2c_WriteByte(tmpRealAddr, 0xA8, 0xA5);
		ACP_RX_D0 = 0x50;
	}
	HDDVR_i2c_WriteByte( tmpRealAddr, 0xFF, BANK5+tmpRealChnl%4 );
	
	if(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_720P_2530 || 
		nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_HDEX || 
		nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_720P_5060){
			HDDVR_i2c_WriteByte(tmpRealAddr, 0x7C, 0x11);
	}
	else if(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_1080P_2530){
			HDDVR_i2c_WriteByte(tmpRealAddr, 0x7C, 0x11);
	}
	else if((nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_SD) 		||
				(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_720H) 	||
				(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_1280H)	||
				(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_1440H)	||
				(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_1920H)	||
				(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_960H2EX)	){
			HDDVR_i2c_WriteByte(tmpRealAddr, 0x7C, 0x11);
	}
	else
		printf("nvp6124_pelco_coax_mode ch[%d] error\n", tmpRealChnl);
	
	if(	(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_SD) 	|| 
		(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_720H) 	||
		(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_1280H)	||
		(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_1440H)	||
		(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_1920H)	||
		(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_960H2EX)){
		HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x03+((tmpRealChnl%4)/2));
		HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_BAUD+((tmpRealChnl%2)*0x80), nvp6124_channelmode[tmpRealChnl]==NVP1108_PAL? 0x1B:0x1B);
		HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_LINE+((tmpRealChnl%2)*0x80), nvp6124_channelmode[tmpRealChnl]==NVP1108_PAL? 0x0E:0x0E);
		HDDVR_i2c_WriteByte(tmpRealAddr, PACKET_MODE+((tmpRealChnl%2)*0x80), 0x06);
		HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_SYNC+((tmpRealChnl%2)*0x80), nvp6124_channelmode[tmpRealChnl]==NVP1108_PAL? 0xa0:0xd4);
		HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_SYNC+1+((tmpRealChnl%2)*0x80), nvp6124_channelmode[tmpRealChnl]==NVP1108_PAL?0x05:0x05);
		HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_EVEN+((tmpRealChnl%2)*0x80), 0x01);
			
		printf("\r\n960H COAXIAL PROTOCOL IS SETTING....");
	}
	else if(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_720P_2530 || 
			nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_HDEX      || 
			nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_720P_5060){
			if(HDAHD_SYID[0] == AD_AHD_NVP6124B){
				HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x03+((tmpRealChnl%4)/2));
				HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_BAUD+((tmpRealChnl%2)*0x80),0x15);
				HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_LINE+((tmpRealChnl%2)*0x80), nvp6124_channelmode[tmpRealChnl]==NVP1108_PAL? 0x0D:0x0E);
				HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_SYNC+((tmpRealChnl%2)*0x80), nvp6124_channelmode[tmpRealChnl]==NVP1108_PAL? 0x20:0xD0);
				HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_SYNC+((tmpRealChnl%2)*0x80)+1, nvp6124_channelmode[tmpRealChnl]==NVP1108_PAL? 0x07:0x05);
				//HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_FHD_LINES+((tmpRealChnl%2)*0x80), 0x03);
				//HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_FHD_BYTE+((tmpRealChnl%2)*0x80), 0x03);
				HDDVR_i2c_WriteByte(tmpRealAddr, PACKET_MODE+((tmpRealChnl%2)*0x80), 0x06);
				HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_EVEN+((tmpRealChnl%2)*0x80), 0x00);
				printf("\r\nNVP6124B 720P COAXIAL PROTOCOL IS SETTING....");
			}
			else
			{
				HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x03+((tmpRealChnl%4)/2));
				HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_BAUD+((tmpRealChnl%2)*0x80), 0x0D);
				HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_LINE+((tmpRealChnl%2)*0x80), nvp6124_channelmode[tmpRealChnl]==NVP1108_PAL? 0x0d:0x0e);
				HDDVR_i2c_WriteByte(tmpRealAddr, PACKET_MODE+((tmpRealChnl%2)*0x80), 0x06);
				HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_SYNC+((tmpRealChnl%2)*0x80), nvp6124_channelmode[tmpRealChnl]==NVP1108_PAL? 0x40:0x80);
				HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_SYNC+1+((tmpRealChnl%2)*0x80), nvp6124_channelmode[tmpRealChnl]==NVP1108_PAL?0x05:0x00);
				HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_EVEN+((tmpRealChnl%2)*0x80), 0x00);
				printf("\r\n720P COAXIAL PROTOCOL IS SETTING....");	
		    }
	}
	else if(nvp6124_videoformat[tmpRealChnl] == NVP6124_VI_1080P_2530)
	{
		if(HDAHD_SYID[0] == AD_AHD_NVP6124B){
			HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x03+((tmpRealChnl%4)/2));
			HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_FHD_BAUD+((tmpRealChnl%2)*0x80),0x2D);
			HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_FHD_LINE+((tmpRealChnl%2)*0x80),0x0E);
			HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_SYNC+((tmpRealChnl%2)*0x80), nvp6124_channelmode[tmpRealChnl]==NVP1108_PAL? 0x14:0xa0);
			HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_SYNC+((tmpRealChnl%2)*0x80)+1, 0xa0);
			HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_FHD_LINES+((tmpRealChnl%2)*0x80), 0x03);
			HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_FHD_BYTE+((tmpRealChnl%2)*0x80), 0x03);
			HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_FHD_MODE+((tmpRealChnl%2)*0x80), 0x10);
			HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_EVEN+((tmpRealChnl%2)*0x80), 0x00);
			printf("\r\nNVP6124B 1080P COAXIAL PROTOCOL IS SETTING....");
		}
		else
		{		
			HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x03+((tmpRealChnl%4)/2));
			HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_FHD_BAUD+((tmpRealChnl%2)*0x80),0x0E);
			HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_FHD_LINE+((tmpRealChnl%2)*0x80),nvp6124_channelmode[tmpRealChnl]==NVP1108_PAL? 0x0E:0x0E);
			HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_SYNC+((tmpRealChnl%2)*0x80),nvp6124_channelmode[tmpRealChnl]==NVP1108_PAL? 0x14:0x14);
			HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_FHD_LINES+((tmpRealChnl%2)*0x80), 0x03);
			HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_FHD_BYTE+((tmpRealChnl%2)*0x80), 0x03);
			HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_FHD_MODE+((tmpRealChnl%2)*0x80), 0x10);
			HDDVR_i2c_WriteByte(tmpRealAddr, ((tmpRealChnl%2)*0x80)+0x0E, 0x00);  //10.25
			HDDVR_i2c_WriteByte(tmpRealAddr, AHD2_PEL_EVEN+((tmpRealChnl%2)*0x80), 0x00);
			printf("\r\n1080P COAXIAL PROTOCOL IS SETTING....");
		}
	}
	else
	{
		printf("\r\nCOAXIAL MODE NOT RIGHT...\n");
	}
	I2C_UnLock();
}

int HDAHD_UTC_Init(int chnl)
{
	int i, ch;
	int addr = HDAHD_ADDR[0];
	nvp6124_utc_InitByChnlVFmt(chnl);
	//I2C_InLock();
	
	//for(i=0;i<4;i++) {		
		//nvp6124_acp_init(addr, i);
	//}
	//I2C_UnLock();		

	return 0;
}

int HDAHD_UTC_Send(int Chnl, int Cmd, unsigned char value)
{
	int Revalue = 0;	
	
	nvp6124_utc_InitByChnlVFmt(Chnl);	
	
	usleep(20*1000);
	
	switch(Cmd)	{
		case HDDVR_UTC_CMD_UP:
		case HDDVR_UTC_CMD_DOWN:
		case HDDVR_UTC_CMD_LEFT:
		case HDDVR_UTC_CMD_RIGHT:
		case HDDVR_UTC_CMD_IRIS_OPEN:
		case HDDVR_UTC_CMD_IRIS_CLOSE:
		case HDDVR_UTC_CMD_FOCUS_NEAR:
		case HDDVR_UTC_CMD_FOCUS_FAR:
		case HDDVR_UTC_CMD_ZOOM_WIDE:
		case HDDVR_UTC_CMD_ZOOM_TELE:
		case HDDVR_UTC_CMD_OSD:
		case HDDVR_UTC_CMD_RESET:
		case HDDVR_UTC_CMD_SET:
			printf("Cmd=%d\n", Cmd);			
			nvp6124_PelcoCommand(Chnl, Cmd, value);			
			break;
		default : 
			break;
	}
	return 0;
}

int HDAHD_UTC_Exit()
{
	return 0;
}
#endif
#if 0
#define AHD2_PEL_D0		0x20
#define AHD2_FHD_D0		0x10
#define AHD2_PEL_OUT	0x0C
#define AHD2_FHD_OUT	0x09

#define BANK0		0
#define BANK1		1
#define BANK2		2
#define BANK3		3
#define BANK4		4
#define BANK5		5
#define BANK6		6
#define BANK7		7
#define BANK8		8
#define BANK9		9

#define PACKET_MODE	0x0B

const unsigned char NVP6124_1080P_2530_tab[HDDVR_UTC_CMD_COUNT][4] = {
						0x00, 0x08, 0x00, 0x32,
						0x00, 0x10, 0x00, 0x32,
						0x00, 0x04, 0x32, 0x00,
						0x00, 0x02, 0x32, 0x00,					
						0x02, 0x00, 0x00, 0x00,
						0x04, 0x00, 0x00, 0x00,
						0x01, 0x00, 0x00, 0x00,
						0x00, 0x80, 0x00, 0x00,
						0x00, 0x40, 0x00, 0x00,
						0x00, 0x20, 0x00, 0x00,
						0x00, 0x03, 0x00, 0x3F,
						0x00, 0x00, 0x00, 0x00,
						0x02, 0x00, 0x00, 0x00
};

const unsigned char NVP6124_720P_2530_tab[HDDVR_UTC_CMD_COUNT][4] = {
						0x00, 0x10, 0x10, 0x4C,
						0x00, 0x08, 0x08, 0x4C,
						0x00, 0x20, 0x20, 0x00,
						0x00, 0x40, 0x40, 0x00,					
						0x40, 0x00, 0x00, 0x00,
						0x20, 0x00, 0x00, 0x00,
						0x80, 0x00, 0x00, 0x00,
						0x00, 0x01, 0x01, 0x00,
						0x00, 0x02, 0x02, 0x00,
						0x00, 0x04, 0x04, 0x00,
						0x00, 0xC0, 0xC0, 0xFA,
						0x00, 0x00, 0x00, 0x00,
						0x40, 0x00, 0x00, 0x00
};

const unsigned char NVP6124_VI_SD_tab[HDDVR_UTC_CMD_COUNT][4] = {
						0x00, 0x10, 0x00, 0x4C,
						0x00, 0x08, 0x00, 0x4C,
						0x00, 0x20, 0x4C, 0x00,
						0x00, 0x40, 0x4C, 0x00,
						0x40, 0x00, 0x00, 0x00,
						0x20, 0x00, 0x00, 0x00,
						0x80, 0x00, 0x00, 0x00,
						0x00, 0x01, 0x00, 0x00,
						0x00, 0x02, 0x00, 0x00,
						0x00, 0x04, 0x00, 0x00,
						0x00, 0xC0, 0x00, 0xFA,
						0x00, 0x00, 0x00, 0x00,
						0x40, 0x00, 0x00, 0x00
};

const unsigned char NVP6124_HM_CMD_tab[HDDVR_HM_CMD_COUNT - HDDVR_UTC_CMD_COUNT - 1][4] = {
						0x00, 0x00, 0x00, 0x00,
						0x00, 0x10, 0x08, 0x3F,
						0x00, 0x08, 0x08, 0x3F,
						0x00, 0x04, 0x3F, 0x08,
						0x00, 0x02, 0x3F, 0x08,
						0x00, 0x20, 0x08, 0x08,
						0x00, 0x40, 0x08, 0x08,
						0x04, 0x00, 0x00, 0x00,
						0x02, 0x00, 0x00, 0x00,

						0x01, 0x00, 0x00, 0x00,
						0x00, 0x80, 0x00, 0x00,

						0x00, 0x07, 0x00, 0x01,
						0x00, 0x07, 0x00, 0x10,
						0x00, 0x07, 0x00, 0x80,
						0x00, 0x07, 0x00, 0xff,
						0x00, 0x07, 0x00, 0xaa,

						0x00, 0x03, 0x00, 0x01,
						0x00, 0x03, 0x00, 0x10,
						0x00, 0x03, 0x00, 0x80,
						0x00, 0x03, 0x00, 0xFF,
						0x00, 0x03, 0x00, 0xaa,
						0x00, 0x05, 0x00, 0xaa
};

static unsigned int nvp6124_HM_PelcoCommand(unsigned char addr
									, unsigned char regAddr
									, unsigned char command
									, unsigned char value)
{
	int i;
	unsigned char  tmpCmd[4] = {0x00, 0x00, 0x00, 0x00};

	for(i=0; i<4; i++)
	{
		tmpCmd[i] = NVP6124_HM_CMD_tab[command - HDDVR_UTC_CMD_COUNT - 1][i];
	}

	switch(command){

		case HDDVR_HM_CMDD_DOWN:
		case HDDVR_HM_CMD_UP:
			if(value < 0x08)
			{
				value = 0x08;
			}
		case HDDVR_HM_CMD_PRE:
		case HDDVR_HM_CMD_SETPRE:
		case HDDVR_HM_CMD_CLRPRE:
			tmpCmd[3] = value;
			break;

		case HDDVR_HM_CMD_LEFT:
		case HDDVR_HM_CMD_RIGHT:
			if(value < 0x08)
			{
				value = 0x08;
			}
			tmpCmd[2] = value;
			break;

		default:
			break;
	}

	for(i=0; i<4; i++)
	{
		HDDVR_i2c_WriteByte( addr, regAddr+i, tmpCmd[i] );
	}
}

unsigned char nvp6124_PelcoCommand(int addr
						,int chnl
						,unsigned char command
						,unsigned char value
						)
{
	int i;
	//usleep( 20*1000 );
	if(nvp6124_videoformat[chnl] == NVP6124_VI_SD) {
		I2C_InLock();
		HDDVR_i2c_WriteByte( addr, 0xFF, BANK3+(chnl/2) );
		for(i=0;i<4;i++) {
			HDDVR_i2c_WriteByte( addr, AHD2_PEL_D0+i+(((chnl)%2)*0x80), 0x00 );
		}
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_OUT+(((chnl)%2)*0x80), 0x01 );
		I2C_UnLock();

		usleep( 30*1000 );

		I2C_InLock();
		HDDVR_i2c_WriteByte( addr, 0xFF, BANK3+(chnl/2) );
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_OUT+(((chnl)%2)*0x80), 0x00 );
		I2C_UnLock();

		usleep( 60*1000 );

		I2C_InLock();
		HDDVR_i2c_WriteByte( addr, 0xFF, BANK3+(chnl/2) );
		if(command < HDDVR_UTC_CMD_COUNT)
		{
			for(i=0;i<4;i++) {
				HDDVR_i2c_WriteByte( addr,
					AHD2_PEL_D0+i+(((chnl)%2)*0x80),
					NVP6124_VI_SD_tab[command][i] );
			}
		}
		else
		{
			nvp6124_HM_PelcoCommand(addr, AHD2_PEL_D0+(((chnl)%2)*0x80), command, value);
		}
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_OUT+(((chnl)%2)*0x80), 0x01 );
		I2C_UnLock();

		usleep( 30*1000 );

		I2C_InLock();
		HDDVR_i2c_WriteByte( addr, 0xFF, BANK3+(chnl/2) );
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_OUT+(((chnl)%2)*0x80), 0x00 );
		I2C_UnLock();

		usleep( 60*1000 );
	}
	else if(nvp6124_videoformat[chnl] == NVP6124_VI_720P_2530
			|| nvp6124_videoformat[chnl] == NVP6124_VI_720P_5060)
	{
		I2C_InLock();
		HDDVR_i2c_WriteByte( addr, 0xFF, BANK3+(chnl/2) );
		for(i=0;i<4;i++) {
			HDDVR_i2c_WriteByte( addr, AHD2_PEL_D0+i+(((chnl)%2)*0x80), 0x00 );
		}
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_OUT+(((chnl)%2)*0x80), 0x01 );
		I2C_UnLock();

		usleep( 30*1000 );

		I2C_InLock();
		HDDVR_i2c_WriteByte( addr, 0xFF, BANK3+(chnl/2) );
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_OUT+(((chnl)%2)*0x80), 0x00 );
		I2C_UnLock();

		usleep( 60*1000 );

		I2C_InLock();
		HDDVR_i2c_WriteByte( addr, 0xFF, BANK3+(chnl/2) );

		if(command < HDDVR_UTC_CMD_COUNT)
		{
			for(i=0;i<4;i++) {
				HDDVR_i2c_WriteByte( addr,
					AHD2_PEL_D0+i+(((chnl)%2)*0x80),
					NVP6124_720P_2530_tab[command][i] );
			}
		}
		else
		{
			nvp6124_HM_PelcoCommand(addr, AHD2_PEL_D0+(((chnl)%2)*0x80), command, value);
		}

		HDDVR_i2c_WriteByte( addr, AHD2_PEL_OUT+(((chnl)%2)*0x80), 0x01 );
		I2C_UnLock();

		usleep( 30*1000 );

		I2C_InLock();
		HDDVR_i2c_WriteByte( addr, 0xFF, BANK3+(chnl/2) );
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_OUT+(((chnl)%2)*0x80), 0x00 );
		I2C_UnLock();

		usleep( 60*1000 );
	}
	else if(nvp6124_videoformat[chnl] == NVP6124_VI_1080P_2530)
	{
		I2C_InLock();
		HDDVR_i2c_WriteByte( addr, 0xFF, BANK3+(chnl/2) );
		for(i=0;i<4;i++) {
			HDDVR_i2c_WriteByte( addr, AHD2_FHD_D0+i+(((chnl)%2)*0x80), 0x00 );
		}
		HDDVR_i2c_WriteByte( addr, AHD2_FHD_OUT+(((chnl)%2)*0x80), 0x08 );
		I2C_UnLock();

		usleep( 25*1000 );

		I2C_InLock();
		HDDVR_i2c_WriteByte( addr, 0xFF, BANK3+(chnl/2) );
		HDDVR_i2c_WriteByte( addr, AHD2_FHD_OUT+(((chnl)%2)*0x80), 0x00 );
		I2C_UnLock();

		usleep( 25*1000 );

		I2C_InLock();
		HDDVR_i2c_WriteByte( addr, 0xFF, BANK3+(chnl/2) );

		if(command < HDDVR_UTC_CMD_COUNT)
		{
			for(i=0;i<4;i++) {
				HDDVR_i2c_WriteByte( addr,
					AHD2_FHD_D0+i+(((chnl)%2)*0x80),
					NVP6124_1080P_2530_tab[command][i] );
			}
		}
		else
		{
			nvp6124_HM_PelcoCommand(addr, AHD2_FHD_D0+(((chnl)%2)*0x80), command, value);
		}
		HDDVR_i2c_WriteByte( addr, AHD2_FHD_OUT+(((chnl)%2)*0x80), 0x08 );
		I2C_UnLock();

		usleep( 25*1000 );

		I2C_InLock();
		HDDVR_i2c_WriteByte( addr, 0xFF, BANK3+(chnl/2) );
		HDDVR_i2c_WriteByte( addr, AHD2_FHD_OUT+(((chnl)%2)*0x80), 0x00 );
		I2C_UnLock();

		usleep( 25*1000 );
	}

	return 0;
}
void nvp6124_utc_InitByChnlVFmt(int addr, int chnl, int ChnlVideoformat, int video_mode)
{
	if(ChnlVideoformat == NVP6124_VI_SD)
	{
		I2C_InLock();
		HDDVR_i2c_WriteByte( addr, 0xFF, BANK3+(chnl/2) );
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_BAUD+((chnl%2)*0x80), video_mode==NVP1108_PAL? 0x1B:0x1B );
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_LINE+((chnl%2)*0x80), video_mode==NVP1108_PAL? 0x0E:0x0E );
		HDDVR_i2c_WriteByte( addr, PACKET_MODE+((chnl%2)*0x80), 0x06 );
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_SYNC+((chnl%2)*0x80), video_mode==NVP1108_PAL? 0xa0:0xd4 );
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_SYNC+1+((chnl%2)*0x80), video_mode==NVP1108_PAL?0x05:0x05 );
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_EVEN+((chnl%2)*0x80), 0x01 );
		I2C_UnLock();
	}
	else if(ChnlVideoformat == NVP6124_VI_720P_2530 || ChnlVideoformat == NVP6124_VI_720P_5060)
	{
		I2C_InLock();
		HDDVR_i2c_WriteByte( addr, 0xFF, BANK3+(chnl/2) );
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_BAUD+((chnl%2)*0x80), 0x0D );
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_LINE+((chnl%2)*0x80), video_mode==NVP1108_PAL? 0x0D:0x0E );
		HDDVR_i2c_WriteByte( addr, PACKET_MODE+((chnl%2)*0x80), 0x06 );
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_SYNC+((chnl%2)*0x80), video_mode==NVP1108_PAL? 0x40:0x80 );
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_SYNC+1+((chnl%2)*0x80), video_mode==NVP1108_PAL?0x05:0x00 );
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_EVEN+((chnl%2)*0x80), 0x00 );
		I2C_UnLock();
	}
	else if(ChnlVideoformat == NVP6124_VI_1080P_2530)
	{
		I2C_InLock();
		HDDVR_i2c_WriteByte( addr, 0xFF, BANK3+(chnl/2) );
		HDDVR_i2c_WriteByte( addr, AHD2_FHD_BAUD+((chnl%2)*0x80), 0x0E );
		HDDVR_i2c_WriteByte( addr, AHD2_FHD_LINE+((chnl%2)*0x80), video_mode==NVP1108_PAL? 0x0E:0x0E );
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_SYNC+((chnl%2)*0x80), video_mode==NVP1108_PAL? 0x14:0x14 );
		HDDVR_i2c_WriteByte( addr, AHD2_FHD_LINES+((chnl%2)*0x80), 0x03 );
		HDDVR_i2c_WriteByte( addr, AHD2_FHD_BYTE+((chnl%2)*0x80), 0x03 );
		HDDVR_i2c_WriteByte( addr, AHD2_FHD_MODE+((chnl%2)*0x80), 0x10 );
		HDDVR_i2c_WriteByte( addr, ((chnl%2)*0x80)+0x0E, 0x00 );
		HDDVR_i2c_WriteByte( addr, AHD2_PEL_EVEN+((chnl%2)*0x80), 0x00 );
		I2C_UnLock();
	}
	else
	{
		printf("HDDVR UTC Init Error, ch_mode Error\n");
	}

}

int HDAHD_UTC_Init(int video_mode)
{
	int i, ch;
	int tmpRealChip;
	int tmpRealChnl;
	int tmpRealAddr;
	int addr = HDAHD_ADDR[0];

	current_videomode = video_mode;

	I2C_InLock();

	HDDVR_i2c_WriteByte( addr, 0xFF, BANK1 );
	if(HDAHD_SYID[0] == AD_AHD_NVP6124)
	{
		HDDVR_i2c_WriteByte( addr, 0xBD, 0xD0 );
		HDDVR_i2c_WriteByte( addr, 0xBE, 0xDD );
		HDDVR_i2c_WriteByte( addr, 0xBF, 0x0D );
	}
	else if(HDAHD_SYID[0] == AD_AHD_NVP6114A)
	{
		HDDVR_i2c_WriteByte( addr, 0xBC, 0xDD );
		HDDVR_i2c_WriteByte( addr, 0xBD, 0xED );
	}

	for(i=0;i<4;i++) {
		HDDVR_i2c_WriteByte( addr, 0xFF, BANK5+i );

		if(nvp6124_videoformat[i] == NVP6124_VI_720P_2530
			|| nvp6124_videoformat[i] == NVP6124_VI_720P_5060
			|| nvp6124_videoformat[i] == NVP6124_VI_1080P_2530
			||nvp6124_videoformat[i] == NVP6124_VI_SD)
		{
			HDDVR_i2c_WriteByte( addr, 0x7C, 0x11 );
		}
		else
			printf("nvp6124_pelco_coax_mode ch[%d] error\n", i);

	}

	I2C_UnLock();

	for(i=0; i<4; i++) {
		current_videoformat[i] = nvp6124_videoformat[i];

		if(0 != HDAHD_ChipGetMap(i, &tmpRealChip, &tmpRealChnl, &tmpRealAddr)) {
			return HDVIDEO_UNKNOWN;
		}

		nvp6124_utc_InitByChnlVFmt(tmpRealAddr, tmpRealChnl,
								nvp6124_videoformat[i], video_mode);
	}

	return 0;
}

int HDAHD_UTC_Send(int Chnl, int Cmd, unsigned char value)
{
	int Revalue = 0;
	int tmpRealChip;
	int tmpRealChnl;
	int tmpRealAddr;

	if(0 != HDAHD_ChipGetMap(Chnl, &tmpRealChip, &tmpRealChnl, &tmpRealAddr)) {
		return HDVIDEO_UNKNOWN;
	}

	switch(Cmd)	{
		case HDDVR_HM_CMD_STOP:
		case HDDVR_HM_CMDD_DOWN:
		case HDDVR_HM_CMD_UP:
		case HDDVR_HM_CMD_LEFT:
		case HDDVR_HM_CMD_RIGHT:
		case HDDVR_HM_CMD_ZOOM_TELE:
		case HDDVR_HM_CMD_ZOOM_WIDE:
		case HDDVR_HM_CMD_IRIS_SUM:
		case HDDVR_HM_CMD_IRIS_ADD:
		case HDDVR_HM_CMD_FOCUS_NEAR:
		case HDDVR_HM_CMD_FOCUS_FAR:
		case HDDVR_HM_CMD_PRE1:
		case HDDVR_HM_CMD_PRE16:
		case HDDVR_HM_CMD_PRE128:
		case HDDVR_HM_CMD_PRE255:
		case HDDVR_HM_CMD_PRE:
		case HDDVR_HM_CMD_SETPRE1:
		case HDDVR_HM_CMD_SETPRE16:
		case HDDVR_HM_CMD_SETPRE128:
		case HDDVR_HM_CMD_SETPRE255:
		case HDDVR_HM_CMD_SETPRE:
		case HDDVR_HM_CMD_CLRPRE:

		case HDDVR_UTC_CMD_RESET:
		case HDDVR_UTC_CMD_ENTER:
		case HDDVR_UTC_CMD_UP:
		case HDDVR_UTC_CMD_DOWN:
		case HDDVR_UTC_CMD_LEFT:
		case HDDVR_UTC_CMD_RIGHT:
		case HDDVR_UTC_CMD_OSD:
		case HDDVR_UTC_CMD_IRIS_OPEN:
		case HDDVR_UTC_CMD_IRIS_CLOSE:
		case HDDVR_UTC_CMD_FOCUS_NEAR:
		case HDDVR_UTC_CMD_FOCUS_FAR:
		case HDDVR_UTC_CMD_ZOOM_WIDE:
		case HDDVR_UTC_CMD_ZOOM_TELE:

			if(current_videoformat[Chnl] != nvp6124_videoformat[Chnl])
			{
				current_videoformat[Chnl] = nvp6124_videoformat[Chnl];
				nvp6124_utc_InitByChnlVFmt(tmpRealAddr, tmpRealChnl,
										nvp6124_videoformat[Chnl], current_videomode);
			}
			HDAHD_UTC_Init(current_videomode);
			nvp6124_PelcoCommand(tmpRealAddr, tmpRealChnl, Cmd, value);
			break;

		default:
	        printf("invalid UTC cmd[%x]\n", Cmd);
			Revalue = -1;
			break;
	}

	return Revalue;
}

int HDAHD_UTC_Exit()
{
	return 0;
}
#endif
int HDAHD_VideoSetColor(int Chnl, int nHue, int nBrightness, int nContrast, int nSaturation, int nSharpness)
{
	int tmpRealChip;
	int tmpRealChnl;
	int tmpRealAddr;

	enum {
		HDAHD_COLOR_HUE = 0,
		HDAHD_COLOR_BRI,
		HDAHD_COLOR_CON,
		HDAHD_COLOR_SAT,
		HDAHD_COLOR_LST
	};
	const unsigned char COLOR_MAP[HDAHD_COLOR_LST][VIDEO_MAX_COLOR_GAIN+1] = {
		VIDEO_COLOR_ADJTBL0, //HUE
		VIDEO_COLOR_ADJTBL0, //BRI
		VIDEO_COLOR_ADJTBL1, //CON
		VIDEO_COLOR_ADJTBL1, //SAT
	};
	const unsigned char COLOR_TBL[HDAHD_COLOR_LST] = {0x40, 0x0C, 0x10, 0x3C};

	if(0 != HDAHD_ChipGetMap(Chnl, &tmpRealChip, &tmpRealChnl, &tmpRealAddr)) {
		return -1;
	}

	I2C_InLock();
	HDDVR_i2c_WriteByte(tmpRealAddr, 0xFF, 0x00);
	if(nHue >= 0 && nHue <= VIDEO_MAX_COLOR_GAIN){
		HDDVR_i2c_WriteByte(tmpRealAddr,
					COLOR_TBL[HDAHD_COLOR_HUE] + tmpRealChnl,
					COLOR_MAP[HDAHD_COLOR_HUE][nHue]);
	}
	if(nBrightness >= 0 && nBrightness <= VIDEO_MAX_COLOR_GAIN){
		HDDVR_i2c_WriteByte(tmpRealAddr,
					COLOR_TBL[HDAHD_COLOR_BRI] + tmpRealChnl,
					COLOR_MAP[HDAHD_COLOR_BRI][nBrightness]);
	}
	if(nContrast >= 0 && nContrast <= VIDEO_MAX_COLOR_GAIN){
		HDDVR_i2c_WriteByte(tmpRealAddr,
					COLOR_TBL[HDAHD_COLOR_CON] + tmpRealChnl,
					COLOR_MAP[HDAHD_COLOR_CON][nContrast]);
	}
	if(nSaturation >= 0 && nSaturation <= VIDEO_MAX_COLOR_GAIN){
		HDDVR_i2c_WriteByte(tmpRealAddr,
					COLOR_TBL[HDAHD_COLOR_SAT] + tmpRealChnl,
					COLOR_MAP[HDAHD_COLOR_SAT][nSaturation]);
	}
	I2C_UnLock();

	return 0;
}

char * HDAHD_GetCHNLType(int Chnl)
{
	switch(HDAHD_InputFormatCheck(Chnl)) {
	default:
	case HDVIDEO_UNKNOWN:
	return "UNKNOWN";

	case HDVIDEO_SD720H25FPS:
	case HDVIDEO_SD960H25FPS:
	return "SD-PAL";
	case HDVIDEO_SD720H30FPS:
	case HDVIDEO_SD960H30FPS:
	return "SD-NTSC";

	case HDVIDEO_HD720P25FPS:
	return "AHD-720P@25FPS";
	case HDVIDEO_HD720P30FPS:
	return "AHD-720P@30FPS";

	case HDVIDEO_HD720P50FPS:
	return "AHD-720P@50FPS";
	case HDVIDEO_HD720P60FPS:
	return "AHD-720P@60FPS";

	case HDVIDEO_HD1080P25FPS:
	return "AHD-1080P@25FPS";
	case HDVIDEO_HD1080P30FPS:
	return "AHD-1080P@30FPS";
	
	case HDVIDEO_SD960H:
	return "CVBS";
	case HDVIDEO_HD720P:
	return "AHD-720P";
	case HDVIDEO_HD1080P:
	return "AHD-1080P";
	}

	return "UNKNOWN";
}

int HDAHD_AudioLiveLoop(int Chnl)
{
	nvp6114_audio_liveloop(HDAHD_ADDR[0], Chnl);

	return 0;
}

int HDAHD_AudioVolume(int Chnl, int Vol)
{
	nvp6114_audio_volume(HDAHD_ADDR[0], Vol);

	return 0;
}

int HDAHD_AudioPlayBack(int Chnl)
{
	nvp6114_audio_playback(HDAHD_ADDR[0], Chnl);

	return 0;
}
